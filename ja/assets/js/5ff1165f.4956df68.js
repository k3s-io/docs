"use strict";(self.webpackChunkk_3_s_docs=self.webpackChunkk_3_s_docs||[]).push([[6533],{62184:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"security/self-assessment-1.23","title":"self-assessment-1.23","description":"set -eE","source":"@site/i18n/ja/docusaurus-plugin-content-docs/current/security/self-assessment-1.23.md","sourceDirName":"security","slug":"/security/self-assessment-1.23","permalink":"/ja/security/self-assessment-1.23","draft":false,"unlisted":false,"editUrl":"https://github.com/k3s-io/docs/edit/main/docs/security/self-assessment-1.23.md","tags":[],"version":"current","lastUpdatedAt":1761077341000,"frontMatter":{}}');var t=s(74848),c=s(28453);const a={},i=void 0,l={},o=[{value:"1.1.12 etcd\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6240\u6709\u8005\u304cetcd\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"1112-etcd\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6240\u6709\u8005\u304cetcd\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.1.13 admin.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c600\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"1113-adminconf\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c600\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.1.14 admin.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"1114-adminconf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.1.15 scheduler.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c644\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"1115-schedulerconf\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c644\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.1.16 scheduler.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"1116-schedulerconf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.1.17 \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc.conf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"1117-\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fcconf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.1.18 \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"1118-\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fcconf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.1.19 Kubernetes PKI\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304a\u3088\u3073\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"1119-kubernetes-pki\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304a\u3088\u3073\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.1.20 Kubernetes PKI\u8a3c\u660e\u66f8\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"1120-kubernetes-pki\u8a3c\u660e\u66f8\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"1.1.21 Kubernetes PKI\u30ad\u30fc\u306e\u30d5\u30a1\u30a4\u30eb\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c600\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"1121-kubernetes-pki\u30ad\u30fc\u306e\u30d5\u30a1\u30a4\u30eb\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c600\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"1.2 API\u30b5\u30fc\u30d0\u30fc",id:"12-api\u30b5\u30fc\u30d0\u30fc",level:2},{value:"1.2.1 --anonymous-auth\u5f15\u6570\u304cfalse\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"121---anonymous-auth\u5f15\u6570\u304cfalse\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"1.2.2 --token-auth-file\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"122---token-auth-file\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.2.3 --DenyServiceExternalIPs\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"123---denyserviceexternalips\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.2.4 --kubelet-https\u5f15\u6570\u304ctrue\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"124---kubelet-https\u5f15\u6570\u304ctrue\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.2.5 --kubelet-client-certificate\u304a\u3088\u3073--kubelet-client-key\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"125---kubelet-client-certificate\u304a\u3088\u3073--kubelet-client-key\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"1.2.6 Ensure that the --kubelet-certificate-authority argument is set as appropriate (Automated)",id:"126-ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-automated",level:3},{value:"1.2.7 Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)",id:"127-ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-automated",level:3},{value:"1.2.8 Ensure that the --authorization-mode argument includes Node (Automated)",id:"128-ensure-that-the---authorization-mode-argument-includes-node-automated",level:3},{value:"1.2.6 Ensure that the --kubelet-certificate-authority argument is set as appropriate (Automated)",id:"126-ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-automated-1",level:3},{value:"1.2.7 Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)",id:"127-ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-automated-1",level:3},{value:"1.2.9 Ensure that the --authorization-mode argument includes RBAC (Automated)",id:"129-ensure-that-the---authorization-mode-argument-includes-rbac-automated",level:3},{value:"1.2.10 Ensure that the admission control plugin EventRateLimit is set (Manual)",id:"1210-ensure-that-the-admission-control-plugin-eventratelimit-is-set-manual",level:3},{value:"1.2.11 Ensure that the admission control plugin AlwaysAdmit is not set (Automated)",id:"1211-ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set-automated",level:3},{value:"1.2.12 Ensure that the admission control plugin AlwaysPullImages is set (Manual)",id:"1212-ensure-that-the-admission-control-plugin-alwayspullimages-is-set-manual",level:3},{value:"1.2.13 Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used (Manual)",id:"1213-ensure-that-the-admission-control-plugin-securitycontextdeny-is-set-if-podsecuritypolicy-is-not-used-manual",level:3},{value:"1.2.14 Ensure that the admission control plugin ServiceAccount is set (Automated)",id:"1214-ensure-that-the-admission-control-plugin-serviceaccount-is-set-automated",level:3},{value:"1.2.15 NamespaceLifecycle \u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1215-namespacelifecycle-\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.16 NodeRestriction \u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1216-noderestriction-\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.17 --secure-port \u5f15\u6570\u304c 0 \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1217---secure-port-\u5f15\u6570\u304c-0-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.18 --profiling \u5f15\u6570\u304c false \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1218---profiling-\u5f15\u6570\u304c-false-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.19 --audit-log-path \u5f15\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1219---audit-log-path-\u5f15\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.20 --audit-log-maxage \u5f15\u6570\u304c 30 \u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1220---audit-log-maxage-\u5f15\u6570\u304c-30-\u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.21 --audit-log-maxbackup \u5f15\u6570\u304c 10 \u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1221---audit-log-maxbackup-\u5f15\u6570\u304c-10-\u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.22 --audit-log-maxsize \u5f15\u6570\u304c 100 \u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1222---audit-log-maxsize-\u5f15\u6570\u304c-100-\u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.24 --service-account-lookup \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1224---service-account-lookup-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.25 --request-timeout \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1225---request-timeout-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.26 --etcd-certfile \u304a\u3088\u3073 --etcd-keyfile \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1226---etcd-certfile-\u304a\u3088\u3073---etcd-keyfile-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.27 <code>--tls-cert-file</code> \u304a\u3088\u3073 <code>--tls-private-key-file</code> \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1227---tls-cert-file-\u304a\u3088\u3073---tls-private-key-file-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.28 <code>--client-ca-file</code> \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1228---client-ca-file-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.29 <code>--etcd-cafile</code> \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"1229---etcd-cafile-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"1.2.30 Ensure that the --encryption-provider-config argument is set as appropriate (Manual)",id:"1230-ensure-that-the---encryption-provider-config-argument-is-set-as-appropriate-manual",level:3},{value:"1.2.31 Ensure that encryption providers are appropriately configured (Manual)",id:"1231-ensure-that-encryption-providers-are-appropriately-configured-manual",level:3},{value:"1.2.32 Ensure that the API Server only makes use of Strong Cryptographic Ciphers (Manual)",id:"1232-ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers-manual",level:3},{value:"1.3 Controller Manager",id:"13-controller-manager",level:2},{value:"1.3.1 Ensure that the --terminated-pod-gc-threshold argument is set as appropriate (Manual)",id:"131-ensure-that-the---terminated-pod-gc-threshold-argument-is-set-as-appropriate-manual",level:3},{value:"1.3.2 Ensure that the --profiling argument is set to false (Automated)",id:"132-ensure-that-the---profiling-argument-is-set-to-false-automated",level:3},{value:"1.3.3 Ensure that the --use-service-account-credentials argument is set to true (Automated)",id:"133-ensure-that-the---use-service-account-credentials-argument-is-set-to-true-automated",level:3},{value:"1.3.4 Ensure that the --service-account-private-key-file argument is set as appropriate (Automated)",id:"134-ensure-that-the---service-account-private-key-file-argument-is-set-as-appropriate-automated",level:3},{value:"1.2.31 \u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u305f\u6697\u53f7\u5316\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)",id:"1231-\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u305f\u6697\u53f7\u5316\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",level:3},{value:"1.2.32 API\u30b5\u30fc\u30d0\u30fc\u304c\u5f37\u529b\u306a\u6697\u53f7\u5316\u30b9\u30a4\u30fc\u30c8\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)",id:"1232-api\u30b5\u30fc\u30d0\u30fc\u304c\u5f37\u529b\u306a\u6697\u53f7\u5316\u30b9\u30a4\u30fc\u30c8\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",level:3},{value:"1.3 \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc",id:"13-\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc",level:2},{value:"1.3.1 \u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u305f --terminated-pod-gc-threshold \u5f15\u6570\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)",id:"131-\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u305f---terminated-pod-gc-threshold-\u5f15\u6570\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",level:3},{value:"1.3.2 --profiling \u5f15\u6570\u304c false \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5)",id:"132---profiling-\u5f15\u6570\u304c-false-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5",level:3},{value:"1.3.5 Ensure that the --root-ca-file argument is set as appropriate (Automated)",id:"135-ensure-that-the---root-ca-file-argument-is-set-as-appropriate-automated",level:3},{value:"1.3.6 Ensure that the RotateKubeletServerCertificate argument is set to true (Automated)",id:"136-ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-automated",level:3},{value:"1.3.7 Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)",id:"137-ensure-that-the---bind-address-argument-is-set-to-127001-automated",level:3},{value:"1.4 Scheduler",id:"14-scheduler",level:2},{value:"1.4.1 Ensure that the --profiling argument is set to false (Automated)",id:"141-ensure-that-the---profiling-argument-is-set-to-false-automated",level:3},{value:"1.4.2 Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)",id:"142-ensure-that-the---bind-address-argument-is-set-to-127001-automated",level:3},{value:"2 Etcd Node Configuration",id:"2-etcd-node-configuration",level:2},{value:"2.1 Ensure that the --cert-file and --key-file arguments are set as appropriate (Automated)",id:"21-ensure-that-the---cert-file-and---key-file-arguments-are-set-as-appropriate-automated",level:3},{value:"2.2 --client-cert-auth \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"22---client-cert-auth-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"2.3 --auto-tls \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"23---auto-tls-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"2.4 --peer-cert-file \u304a\u3088\u3073 --peer-key-file \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"24---peer-cert-file-\u304a\u3088\u3073---peer-key-file-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"2.5 --peer-client-cert-auth \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"25---peer-client-cert-auth-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"2.6 --peer-auto-tls \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)",id:"26---peer-auto-tls-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",level:3},{value:"2.7 etcd \u306b\u5bfe\u3057\u3066\u4e00\u610f\u306e\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u304c\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)",id:"27-etcd-\u306b\u5bfe\u3057\u3066\u4e00\u610f\u306e\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u304c\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",level:3},{value:"3.1 \u8a8d\u8a3c\u3068\u8a8d\u53ef",id:"31-\u8a8d\u8a3c\u3068\u8a8d\u53ef",level:2},{value:"3.1.1 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u8a8d\u8a3c\u306f\u30e6\u30fc\u30b6\u30fc\u306b\u5bfe\u3057\u3066\u4f7f\u7528\u3055\u308c\u308b\u3079\u304d\u3067\u306f\u306a\u3044 (\u624b\u52d5)",id:"311-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u8a8d\u8a3c\u306f\u30e6\u30fc\u30b6\u30fc\u306b\u5bfe\u3057\u3066\u4f7f\u7528\u3055\u308c\u308b\u3079\u304d\u3067\u306f\u306a\u3044-\u624b\u52d5",level:3},{value:"3.2 \u30ed\u30ae\u30f3\u30b0",id:"32-\u30ed\u30ae\u30f3\u30b0",level:2},{value:"3.2.1 \u6700\u5c0f\u9650\u306e\u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)",id:"321-\u6700\u5c0f\u9650\u306e\u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",level:3},{value:"3.2.2 \u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u304c\u4e3b\u8981\u306a\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u554f\u984c\u3092\u30ab\u30d0\u30fc\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)",id:"322-\u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u304c\u4e3b\u8981\u306a\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u554f\u984c\u3092\u30ab\u30d0\u30fc\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",level:3},{value:"4.1.4 \u30d7\u30ed\u30ad\u30b7kubeconfig\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3001\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"414-\u30d7\u30ed\u30ad\u30b7kubeconfig\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"4.1.5 --kubeconfig kubelet.conf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"415---kubeconfig-kubeletconf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"4.1.6 --kubeconfig kubelet.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"416---kubeconfig-kubeletconf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"4.1.7 \u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"417-\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"4.1.8 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"418-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"4.1.9 kubelet --config\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"419-kubelet---config\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"4.1.10 kubelet --config\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"4110-kubelet---config\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"4.2 Kubelet",id:"42-kubelet",level:2},{value:"4.2.1 --anonymous-auth\u5f15\u6570\u304cfalse\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"421---anonymous-auth\u5f15\u6570\u304cfalse\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"4.2.2 --authorization-mode\u5f15\u6570\u304cAlwaysAllow\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09",id:"422---authorization-mode\u5f15\u6570\u304calwaysallow\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",level:3},{value:"4.2.3 Ensure that the --client-ca-file argument is set as appropriate (Automated)",id:"423-ensure-that-the---client-ca-file-argument-is-set-as-appropriate-automated",level:3},{value:"4.2.4 Ensure that the --read-only-port argument is set to 0 (Manual)",id:"424-ensure-that-the---read-only-port-argument-is-set-to-0-manual",level:3},{value:"4.2.5 Ensure that the --streaming-connection-idle-timeout argument is not set to 0 (Manual)",id:"425-ensure-that-the---streaming-connection-idle-timeout-argument-is-not-set-to-0-manual",level:3},{value:"4.2.6 Ensure that the --protect-kernel-defaults argument is set to true (Automated)",id:"426-ensure-that-the---protect-kernel-defaults-argument-is-set-to-true-automated",level:3},{value:"4.2.7 Ensure that the --make-iptables-util-chains argument is set to true (Automated)",id:"427-ensure-that-the---make-iptables-util-chains-argument-is-set-to-true-automated",level:3},{value:"4.2.8 <code>--hostname-override</code> \u5f15\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"428---hostname-override-\u5f15\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"4.2.9 <code>--event-qps</code> \u5f15\u6570\u304c 0 \u307e\u305f\u306f\u9069\u5207\u306a\u30a4\u30d9\u30f3\u30c8\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u78ba\u4fdd\u3059\u308b\u30ec\u30d9\u30eb\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"429---event-qps-\u5f15\u6570\u304c-0-\u307e\u305f\u306f\u9069\u5207\u306a\u30a4\u30d9\u30f3\u30c8\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u78ba\u4fdd\u3059\u308b\u30ec\u30d9\u30eb\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"4.2.10 <code>--tls-cert-file</code> \u304a\u3088\u3073 <code>--tls-private-key-file</code> \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"4210---tls-cert-file-\u304a\u3088\u3073---tls-private-key-file-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"4.2.11 <code>--rotate-certificates</code> \u5f15\u6570\u304c <code>false</code> \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\uff09",id:"4211---rotate-certificates-\u5f15\u6570\u304c-false-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5",level:3},{value:"4.2.12 <code>RotateKubeletServerCertificate</code> \u5f15\u6570\u304c <code>true</code> \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"4212-rotatekubeletservercertificate-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"4.2.13 Kubelet \u304c\u5f37\u529b\u306a\u6697\u53f7\u5316\u30b9\u30a4\u30fc\u30c8\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"4213-kubelet-\u304c\u5f37\u529b\u306a\u6697\u53f7\u5316\u30b9\u30a4\u30fc\u30c8\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"5.1 RBAC \u3068\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8",id:"51-rbac-\u3068\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8",level:2},{value:"5.1.1 <code>cluster-admin</code> \u30ed\u30fc\u30eb\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u306e\u307f\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"511-cluster-admin-\u30ed\u30fc\u30eb\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u306e\u307f\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"5.1.2 \u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u624b\u52d5\uff09",id:"512-\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u624b\u52d5",level:3},{value:"5.1.3 \u30ed\u30fc\u30eb\u304a\u3088\u3073\u30af\u30e9\u30b9\u30bf\u30fc\u30ed\u30fc\u30eb\u3067\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306e\u4f7f\u7528\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u624b\u52d5\uff09",id:"513-\u30ed\u30fc\u30eb\u304a\u3088\u3073\u30af\u30e9\u30b9\u30bf\u30fc\u30ed\u30fc\u30eb\u3067\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306e\u4f7f\u7528\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u624b\u52d5",level:3},{value:"5.1.4 \u30dd\u30c3\u30c9\u306e\u4f5c\u6210\u30a2\u30af\u30bb\u30b9\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u624b\u52d5\uff09",id:"514-\u30dd\u30c3\u30c9\u306e\u4f5c\u6210\u30a2\u30af\u30bb\u30b9\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u624b\u52d5",level:3},{value:"5.1.5 \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u7a4d\u6975\u7684\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"515-\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u7a4d\u6975\u7684\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"5.1.6 \u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u30c8\u30fc\u30af\u30f3\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u306e\u307f\u30de\u30a6\u30f3\u30c8\u3055\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"516-\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u30c8\u30fc\u30af\u30f3\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u306e\u307f\u30de\u30a6\u30f3\u30c8\u3055\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"5.1.7 <code>system:masters</code> \u30b0\u30eb\u30fc\u30d7\u306e\u4f7f\u7528\u3092\u907f\u3051\u308b\uff08\u624b\u52d5\uff09",id:"517-systemmasters-\u30b0\u30eb\u30fc\u30d7\u306e\u4f7f\u7528\u3092\u907f\u3051\u308b\u624b\u52d5",level:3},{value:"5.1.8 Kubernetes \u30af\u30e9\u30b9\u30bf\u30fc\u5185\u3067\u306e <code>Bind</code>\u3001<code>Impersonate</code>\u3001\u304a\u3088\u3073 <code>Escalate</code> \u6a29\u9650\u306e\u4f7f\u7528\u3092\u5236\u9650\u3059\u308b\uff08\u624b\u52d5\uff09",id:"518-kubernetes-\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u3067\u306e-bindimpersonate\u304a\u3088\u3073-escalate-\u6a29\u9650\u306e\u4f7f\u7528\u3092\u5236\u9650\u3059\u308b\u624b\u52d5",level:3},{value:"5.2 \u30dd\u30c3\u30c9\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u57fa\u6e96",id:"52-\u30dd\u30c3\u30c9\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u57fa\u6e96",level:2},{value:"5.2.1 \u30af\u30e9\u30b9\u30bf\u30fc\u306b\u5c11\u306a\u304f\u3068\u30821\u3064\u306e\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u30dd\u30ea\u30b7\u30fc\u5236\u5fa1\u30e1\u30ab\u30cb\u30ba\u30e0\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09",id:"521-\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u5c11\u306a\u304f\u3068\u30821\u3064\u306e\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u30dd\u30ea\u30b7\u30fc\u5236\u5fa1\u30e1\u30ab\u30cb\u30ba\u30e0\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",level:3},{value:"5.2.2 \u7279\u6a29\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u81ea\u52d5\uff09",id:"522-\u7279\u6a29\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u81ea\u52d5",level:3},{value:"5.2.3 \u30db\u30b9\u30c8\u30d7\u30ed\u30bb\u30b9ID\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u81ea\u52d5\uff09",id:"523-\u30db\u30b9\u30c8\u30d7\u30ed\u30bb\u30b9id\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u81ea\u52d5",level:3},{value:"5.2.4 \u30db\u30b9\u30c8IPC\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u81ea\u52d5\uff09",id:"524-\u30db\u30b9\u30c8ipc\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u81ea\u52d5",level:3},{value:"5.2.5 \u30db\u30b9\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)",id:"525-\u30db\u30b9\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",level:3},{value:"5.2.6 allowPrivilegeEscalation\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)",id:"526-allowprivilegeescalation\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",level:3},{value:"5.2.7 \u30eb\u30fc\u30c8\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)",id:"527-\u30eb\u30fc\u30c8\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",level:3},{value:"5.2.8 NET_RAW\u6a5f\u80fd\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)",id:"528-net_raw\u6a5f\u80fd\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",level:3},{value:"5.2.9 \u8ffd\u52a0\u3055\u308c\u305f\u6a5f\u80fd\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)",id:"529-\u8ffd\u52a0\u3055\u308c\u305f\u6a5f\u80fd\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",level:3},{value:"5.2.10 \u6a5f\u80fd\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u624b\u52d5)",id:"5210-\u6a5f\u80fd\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u624b\u52d5",level:3},{value:"5.2.11 Windows HostProcess\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u624b\u52d5)",id:"5211-windows-hostprocess\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u624b\u52d5",level:3},{value:"5.2.12 HostPath\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u624b\u52d5)",id:"5212-hostpath\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u624b\u52d5",level:3},{value:"5.2.13 HostPorts\u3092\u4f7f\u7528\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u624b\u52d5)",id:"5213-hostports\u3092\u4f7f\u7528\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u624b\u52d5",level:3},{value:"5.3 \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u3068CNI",id:"53-\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u3068cni",level:2},{value:"5.3.1 \u4f7f\u7528\u4e2d\u306eCNI\u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)",id:"531-\u4f7f\u7528\u4e2d\u306ecni\u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",level:3},{value:"5.3.2 \u3059\u3079\u3066\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)",id:"532-\u3059\u3079\u3066\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",level:3},{value:"5.4 \u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u7ba1\u7406",id:"54-\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u7ba1\u7406",level:2},{value:"5.4.1 \u74b0\u5883\u5909\u6570\u3068\u3057\u3066\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3088\u308a\u3082\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u63a8\u5968\u3059\u308b (\u624b\u52d5)",id:"541-\u74b0\u5883\u5909\u6570\u3068\u3057\u3066\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3088\u308a\u3082\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u63a8\u5968\u3059\u308b-\u624b\u52d5",level:3},{value:"5.4.2 \u5916\u90e8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u691c\u8a0e\u3059\u308b (\u624b\u52d5)",id:"542-\u5916\u90e8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u691c\u8a0e\u3059\u308b-\u624b\u52d5",level:3},{value:"5.5 \u62e1\u5f35\u53ef\u80fd\u306a\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb",id:"55-\u62e1\u5f35\u53ef\u80fd\u306a\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb",level:2},{value:"5.5.1 ImagePolicyWebhook\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u3092\u4f7f\u7528\u3057\u3066\u30a4\u30e1\u30fc\u30b8\u306e\u51fa\u6240\u3092\u8a2d\u5b9a\u3059\u308b (\u624b\u52d5)",id:"551-imagepolicywebhook\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u3092\u4f7f\u7528\u3057\u3066\u30a4\u30e1\u30fc\u30b8\u306e\u51fa\u6240\u3092\u8a2d\u5b9a\u3059\u308b-\u624b\u52d5",level:3},{value:"5.7 \u4e00\u822c\u7684\u306a\u30dd\u30ea\u30b7\u30fc",id:"57-\u4e00\u822c\u7684\u306a\u30dd\u30ea\u30b7\u30fc",level:2},{value:"5.7.1 \u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u9593\u306b\u7ba1\u7406\u5883\u754c\u3092\u4f5c\u6210\u3059\u308b (\u624b\u52d5)",id:"571-\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u9593\u306b\u7ba1\u7406\u5883\u754c\u3092\u4f5c\u6210\u3059\u308b-\u624b\u52d5",level:3},{value:"5.7.2 Pod\u5b9a\u7fa9\u3067seccomp\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304cdocker/default\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)",id:"572-pod\u5b9a\u7fa9\u3067seccomp\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304cdockerdefault\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",level:3},{value:"5.7.3 Pod\u304a\u3088\u3073\u30b3\u30f3\u30c6\u30ca\u306bSecurityContext\u3092\u9069\u7528\u3059\u308b (\u624b\u52d5)",id:"573-pod\u304a\u3088\u3073\u30b3\u30f3\u30c6\u30ca\u306bsecuritycontext\u3092\u9069\u7528\u3059\u308b-\u624b\u52d5",level:3},{value:"5.7.4 \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306f\u4f7f\u7528\u3057\u306a\u3044 (\u624b\u52d5)",id:"574-\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306f\u4f7f\u7528\u3057\u306a\u3044-\u624b\u52d5",level:3}];function d(e){const r={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-markdown",children:'---\ntitle: CIS 1.23 \u81ea\u5df1\u8a55\u4fa1\u30ac\u30a4\u30c9\n---\n\n## \u6982\u8981\n\n\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f[K3s\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30ac\u30a4\u30c9](hardening-guide.md)\u306e\u88dc\u8db3\u8cc7\u6599\u3067\u3059\u3002\u5f37\u5316\u30ac\u30a4\u30c9\u306fK3s\u306e\u672c\u756a\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u5f37\u5316\u3059\u308b\u305f\u3081\u306e\u5177\u4f53\u7684\u306a\u6307\u91dd\u3092\u63d0\u4f9b\u3057\u3001\u3053\u306e\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u30ac\u30a4\u30c9\u306fCIS Kubernetes\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u306e\u5404\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u306b\u5bfe\u3057\u3066\u5f37\u5316\u3055\u308c\u305f\u30af\u30e9\u30b9\u30bf\u30fc\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30ec\u30d9\u30eb\u3092\u8a55\u4fa1\u3059\u308b\u306e\u306b\u5f79\u7acb\u3061\u307e\u3059\u3002K3s\u306e\u30aa\u30da\u30ec\u30fc\u30bf\u30fc\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30c1\u30fc\u30e0\u3001\u76e3\u67fb\u4eba\u3001\u610f\u601d\u6c7a\u5b9a\u8005\u304c\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u306e\u30ac\u30a4\u30c9\u306fK3s\u306e**v1.22-v1.23**\u30ea\u30ea\u30fc\u30b9\u30e9\u30a4\u30f3\u304a\u3088\u3073CIS Kubernetes\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u306e**v1.23**\u30ea\u30ea\u30fc\u30b9\u306b\u7279\u5316\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u5404\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u306b\u95a2\u3059\u308b\u8a73\u7d30\u306a\u8aac\u660e\u3084\u30c6\u30b9\u30c8\u5931\u6557\u6642\u306e\u4fee\u6b63\u65b9\u6cd5\u306b\u3064\u3044\u3066\u306f\u3001CIS Kubernetes\u30d9\u30f3\u30c1\u30de\u30fc\u30afv1.6\u306e\u8a72\u5f53\u30bb\u30af\u30b7\u30e7\u30f3\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u306f[Center for Internet Security (CIS)](https://www.cisecurity.org/benchmark/kubernetes)\u3067\u7121\u6599\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u5f8c\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\n\n### \u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30c6\u30b9\u30c8\u306e\u65b9\u6cd5\u8ad6\n\nCIS Kubernetes\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u306e\u5404\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u306f\u3001\u4ed8\u968f\u3059\u308b\u5f37\u5316\u30ac\u30a4\u30c9\u306b\u5f93\u3063\u3066\u8a2d\u5b9a\u3055\u308c\u305fK3s\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u5bfe\u3057\u3066\u8a55\u4fa1\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u76e3\u67fb\u304c\u5143\u306eCIS\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3068\u7570\u306a\u308b\u5834\u5408\u3001K3s\u306b\u7279\u5316\u3057\u305f\u76e3\u67fb\u30b3\u30de\u30f3\u30c9\u304c\u30c6\u30b9\u30c8\u7528\u306b\u63d0\u4f9b\u3055\u308c\u307e\u3059\u3002\n\n\u5404\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u306e\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\uff1a\n\n- **\u5408\u683c** - \u30c6\u30b9\u30c8\u5bfe\u8c61\u306eK3s\u30af\u30e9\u30b9\u30bf\u30fc\u304c\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u306b\u8a18\u8f09\u3055\u308c\u305f\u76e3\u67fb\u306b\u5408\u683c\u3057\u307e\u3057\u305f\u3002\n- **\u8a72\u5f53\u306a\u3057** - \u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u306fK3s\u306e\u8a2d\u8a08\u4e0a\u9069\u7528\u3055\u308c\u307e\u305b\u3093\u3002\u4fee\u6b63\u30bb\u30af\u30b7\u30e7\u30f3\u3067\u305d\u306e\u7406\u7531\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n- **\u8b66\u544a** - \u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u306fCIS\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3067\u624b\u52d5\u3068\u3055\u308c\u3066\u304a\u308a\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u306e\u4f7f\u7528\u30b1\u30fc\u30b9\u3084\u305d\u306e\u4ed6\u306e\u8981\u56e0\u306b\u4f9d\u5b58\u3057\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u306fK3s\u304c\u305d\u306e\u5b9f\u88c5\u3092\u59a8\u3052\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u8a55\u4fa1\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u30c6\u30b9\u30c8\u5bfe\u8c61\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u306e\u3055\u3089\u306a\u308b\u8a2d\u5b9a\u3084\u76e3\u67fb\u306f\u884c\u308f\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\n\u3053\u306e\u30ac\u30a4\u30c9\u306f\u3001K3s\u304cSystemd\u30e6\u30cb\u30c3\u30c8\u3068\u3057\u3066\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u524d\u63d0\u3068\u3057\u3066\u3044\u307e\u3059\u3002\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u304c\u7570\u306a\u308b\u5834\u5408\u306f\u3001\u300c\u76e3\u67fb\u300d\u30b3\u30de\u30f3\u30c9\u3092\u30b7\u30ca\u30ea\u30aa\u306b\u5408\u308f\u305b\u3066\u8abf\u6574\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n> \u6ce8\u610f: \u3053\u306e\u30ac\u30a4\u30c9\u3067\u306f`\u81ea\u52d5\u5316\u3055\u308c\u305f`\u30c6\u30b9\u30c8\uff08\u4ee5\u524d\u306f`\u30b9\u30b3\u30a2\u4ed8\u304d`\u3068\u547c\u3070\u308c\u3066\u3044\u305f\u3082\u306e\uff09\u306e\u307f\u3092\u5bfe\u8c61\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n## 1.1 \u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n### 1.1.1 API\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c644\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chmod 644 /etc/kubernetes/manifests/kube-apiserver.yaml`\n\n### 1.1.2 API\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot:root\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chown root:root /etc/kubernetes/manifests/kube-apiserver.yaml`\n\n### 1.1.3 \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c644\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chmod 644 /etc/kubernetes/manifests/kube-controller-manager.yaml`\n\n### 1.1.4 \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot:root\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chown root:root /etc/kubernetes/manifests/kube-controller-manager.yaml`\n\n### 1.1.5 \u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c644\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chmod 644 /etc/kubernetes/manifests/kube-scheduler.yaml`\n\n### 1.1.6 \u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot:root\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chown root:root /etc/kubernetes/manifests/kube-scheduler.yaml`\n\n### 1.1.7 etcd\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c644\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chmod 644 /etc/kubernetes/manifests/etcd.yaml`\n\n### 1.1.8 etcd\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot:root\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chown root:root /etc/kubernetes/manifests/etcd.yaml`\n\n### 1.1.9 \u30b3\u30f3\u30c6\u30ca\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c644\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chmod 644 <path/to/cni/files>`\n\n### 1.1.10 \u30b3\u30f3\u30c6\u30ca\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot:root\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1a`chown root:root <path/to/cni/files>`\n\n### 1.1.11 etcd\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6a29\u9650\u304c700\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n**\u7d50\u679c:** \u5408\u683c\n\n**\u4fee\u6b63\u65b9\u6cd5:**\netcd\u30b5\u30fc\u30d0\u30fc\u30ce\u30fc\u30c9\u3067\u3001\u30b3\u30de\u30f3\u30c9\'ps -ef | grep etcd\'\u304b\u3089\u5f15\u6570--data-dir\u3068\u3057\u3066\u6e21\u3055\u308c\u308betcd\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u4e0a\u8a18\u3067\u898b\u3064\u304b\u3063\u305fetcd\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u57fa\u3065\u304f\uff09\u3002\u4f8b\uff1achmod 700 /var/lib/etcd\n\n**\u76e3\u67fb\u30b9\u30af\u30ea\u30d7\u30c8:** `check_for_k3s_etcd.sh`\n\n```bash\n#!/bin/bash\n\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001k3s\u304c\u5b9f\u969b\u306betcd\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3053\u3068\uff08sqlite3\u306a\u3069\u306e\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u306f\u306a\u3044\u3053\u3068\uff09\u3092\u78ba\u8a8d\u3057\u3066\u304b\u3089\u8981\u4ef6\u3092\u30c1\u30a7\u30c3\u30af\u3057\u307e\u3059\nset -eE\n\nhandle_error() {\n    echo "false"\n}\n\ntrap \'handle_error\' ERR\n\nif [[ "$(journalctl -D /var/log/journal -u k3s | grep \'Managed etcd cluster initializing\' | grep -v grep | wc -l)" -gt 0 ]]; then\n    case $1 in \n        "1.1.11")\n            echo $(stat -c %a /var/lib/rancher/k3s/server/db/etcd);;\n        "1.2.29")\n            echo $(journalctl -D /var/log/journal -u k3s | grep \'Running kube-apiserver\' | tail -n1 | grep \'etcd-\');;\n        "2.1")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.2")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.3")\n            echo $(grep \'auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.4")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.5")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.6")\n            echo $(grep \'peer-auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.7")\n            echo $(grep \'trusted-ca-file\' /var/lib/rancher/k3s/server/db/etcd/config);;\n    esac\nelse\n# \u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b9\u30ad\u30e3\u30f3\u306b\u5408\u683c\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u8fd4\u3057\u307e\u3059\n    case $1 in\n        "1.1.11")\n            echo "700";;\n        "1.2.29")\n            echo "--etcd-certfile AND --etcd-keyfile";;\n        "2.1")\n            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 1.1.11\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'700' \u306f '700' \u3068\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"700\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"1112-etcd\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6240\u6709\u8005\u304cetcd\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:["1.1.12 etcd\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6240\u6709\u8005\u304cetcd",":etcd","\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\netcd\u30b5\u30fc\u30d0\u30fc\u30ce\u30fc\u30c9\u3067\u3001\u30b3\u30de\u30f3\u30c9'ps -ef | grep etcd'\u304b\u3089\u5f15\u6570--data-dir\u3068\u3057\u3066\u6e21\u3055\u308c\u308betcd\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u4e0a\u8a18\u3067\u898b\u3064\u304b\u3063\u305fetcd\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1achown etcd",":etcd"," /var/lib/etcd"]}),"\n",(0,t.jsx)(r.h3,{id:"1113-adminconf\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c600\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"1.1.13 admin.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c600\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1achmod 600 /var/lib/rancher/k3s/server/cred/admin.kubeconfig"]}),"\n",(0,t.jsxs)(r.h3,{id:"1114-adminconf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:["1.1.14 admin.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot",":root","\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1achown root",":root"," /etc/kubernetes/admin.conf"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/sh -c 'if test -e /var/lib/rancher/k3s/server/cred/admin.kubeconfig; then stat -c %U:%G /var/lib/rancher/k3s/server/cred/admin.kubeconfig; fi'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'root:root' \u306f 'root:root' \u3068\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root:root\n"})}),"\n",(0,t.jsx)(r.h3,{id:"1115-schedulerconf\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c644\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"1.1.15 scheduler.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6a29\u9650\u304c644\u4ee5\u4e0a\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\uff1achmod 644 scheduler"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/sh -c 'if test -e /var/lib/rancher/k3s/server/cred/scheduler.kubeconfig; then stat -c permissions=%a /var/lib/rancher/k3s/server/cred/scheduler.kubeconfig; fi'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"permissions\u306f644\u306e\u6a29\u9650\u3092\u6301\u3061\u3001\u671f\u5f85\u3055\u308c\u308b\u6a29\u9650\u306f644\u4ee5\u4e0a\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"permissions=644\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"1116-schedulerconf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:["1.1.16 scheduler.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot",":root","\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"\u4f8b\u3048\u3070\u3001`chown root:root scheduler`\n\n**\u76e3\u67fb:**\n\n```bash\n/bin/sh -c 'if test -e /var/lib/rancher/k3s/server/cred/scheduler.kubeconfig; then stat -c %U:%G /var/lib/rancher/k3s/server/cred/scheduler.kubeconfig; fi'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'root:root' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root:root\n"})}),"\n",(0,t.jsx)(r.h3,{id:"1117-\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fcconf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"1.1.17 \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc.conf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\u3048\u3070\u3001\nchmod 644 controllermanager"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/sh -c 'if test -e /var/lib/rancher/k3s/server/cred/controller.kubeconfig; then stat -c permissions=%a /var/lib/rancher/k3s/server/cred/controller.kubeconfig; fi'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"permissions \u304c644\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6301\u3061\u3001\u671f\u5f85\u3055\u308c\u308b\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306f644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"permissions=644\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"1118-\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fcconf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:["1.1.18 \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot",":root","\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\u3048\u3070\u3001\nchown root",":root"," controllermanager"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"stat -c %U:%G /var/lib/rancher/k3s/server/tls\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'root:root' \u304c 'root:root' \u3068\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root:root\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"1119-kubernetes-pki\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304a\u3088\u3073\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:["1.1.19 Kubernetes PKI\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304a\u3088\u3073\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot",":root","\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\u3048\u3070\u3001\nchown -R root",":root"," /etc/kubernetes/pki/"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"find /var/lib/rancher/k3s/server/tls | xargs stat -c %U:%G\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'root:root' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root root:root\n"})}),"\n",(0,t.jsx)(r.h3,{id:"1120-kubernetes-pki\u8a3c\u660e\u66f8\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:"1.1.20 Kubernetes PKI\u8a3c\u660e\u66f8\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\u3048\u3070\u3001\nchmod -R 644 /etc/kubernetes/pki/*.crt"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"stat -c %n %a /var/lib/rancher/k3s/server/tls/*.crt\n"})}),"\n",(0,t.jsx)(r.h3,{id:"1121-kubernetes-pki\u30ad\u30fc\u306e\u30d5\u30a1\u30a4\u30eb\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c600\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:"1.1.21 Kubernetes PKI\u30ad\u30fc\u306e\u30d5\u30a1\u30a4\u30eb\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c600\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b\u3048\u3070\u3001\nchmod -R 600 /etc/kubernetes/pki/*.key"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"stat -c %n %a /var/lib/rancher/k3s/server/tls/*.key\n"})}),"\n",(0,t.jsx)(r.h2,{id:"12-api\u30b5\u30fc\u30d0\u30fc",children:"1.2 API\u30b5\u30fc\u30d0\u30fc"}),"\n",(0,t.jsx)(r.h3,{id:"121---anonymous-auth\u5f15\u6570\u304cfalse\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:"1.2.1 --anonymous-auth\u5f15\u6570\u304cfalse\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--anonymous-auth=false"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'anonymous-auth'\n"})}),"\n",(0,t.jsx)(r.h3,{id:"122---token-auth-file\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"1.2.2 --token-auth-file\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3063\u3066\u8a8d\u8a3c\u306e\u305f\u3081\u306e\u4ee3\u66ff\u30e1\u30ab\u30cb\u30ba\u30e0\u3092\u69cb\u6210\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001",(0,t.jsx)(r.code,{children:"--token-auth-file=<filename>"})," \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u524a\u9664\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/ps -ef | grep containerd | grep -v grep\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--token-auth-file' \u304c\u5b58\u5728\u3057\u306a\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root 1616 1600 6 13:26 ? 00:01:28 containerd -c /var/lib/rancher/k3s/agent/etc/containerd/config.toml -a /run/k3s/containerd/containerd.sock --state /run/k3s/containerd --root /var/lib/rancher/k3s/agent/containerd root 2318 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id b41ec3297be4625c2406ad8b7b4f8b91cddd60850c420050c4c3273f809b3e7e -address /run/k3s/containerd/containerd.sock root 2341 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id e7999a65ae0a4e9969f32317ec48ae4f7071b62f92e5236696737973be77c2e1 -address /run/k3s/containerd/containerd.sock root 3199 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 90c4e63d6ee29d40a48c2fdaf2738c2472cba1139dde8a550466c452184f8528 -address /run/k3s/containerd/containerd.sock root 3923 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id be5f4b9bd1ed9239362b7000b47f353acb8bc8ca52a9c9145cba0e902ec1c4b9 -address /run/k3s/containerd/containerd.sock root 4559 1 0 13:28 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 04cd40ea6b6078797f177c902c89412c70e523ad2a687a62829bf1d16ff0e19c -address /run/k3s/containerd/containerd.sock root 4647 1 0 13:28 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 48f37a480315b6adce2d2a5c5d67a85412dd0ba7a2e82816434e0deb9fa75de9 -address /run/k3s/containerd/containerd.sock root 6610 1 0 13:47 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 1cf71c22f568468055e517ab363437c0e54e45274c64024d337cc5bcce66341d -address /run/k3s/containerd/containerd.sock\n"})}),"\n",(0,t.jsx)(r.h3,{id:"123---denyserviceexternalips\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"1.2.3 --DenyServiceExternalIPs\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001",(0,t.jsx)(r.code,{children:"DenyServiceExternalIPs"})," \u3092\u6709\u52b9\u306a\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30d7\u30e9\u30b0\u30a4\u30f3\u304b\u3089\u524a\u9664\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/ps -ef | grep containerd | grep -v grep\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--enable-admission-plugins' \u304c\u5b58\u5728\u3059\u308b \u307e\u305f\u306f '--enable-admission-plugins' \u304c\u5b58\u5728\u3057\u306a\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root 1616 1600 6 13:26 ? 00:01:28 containerd -c /var/lib/rancher/k3s/agent/etc/containerd/config.toml -a /run/k3s/containerd/containerd.sock --state /run/k3s/containerd --root /var/lib/rancher/k3s/agent/containerd root 2318 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id b41ec3297be4625c2406ad8b7b4f8b91cddd60850c420050c4c3273f809b3e7e -address /run/k3s/containerd/containerd.sock root 2341 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id e7999a65ae0a4e9969f32317ec48ae4f7071b62f92e5236696737973be77c2e1 -address /run/k3s/containerd/containerd.sock root 3199 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 90c4e63d6ee29d40a48c2fdaf2738c2472cba1139dde8a550466c452184f8528 -address /run/k3s/containerd/containerd.sock root 3923 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id be5f4b9bd1ed9239362b7000b47f353acb8bc8ca52a9c9145cba0e902ec1c4b9 -address /run/k3s/containerd/containerd.sock root 4559 1 0 13:28 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 04cd40ea6b6078797f177c902c89412c70e523ad2a687a62829bf1d16ff0e19c -address /run/k3s/containerd/containerd.sock root 4647 1 0 13:28 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 48f37a480315b6adce2d2a5c5d67a85412dd0ba7a2e82816434e0deb9fa75de9 -address /run/k3s/containerd/containerd.sock root 6610 1 0 13:47 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 1cf71c22f568468055e517ab363437c0e54e45274c64024d337cc5bcce66341d -address /run/k3s/containerd/containerd.sock\n"})}),"\n",(0,t.jsx)(r.h3,{id:"124---kubelet-https\u5f15\u6570\u304ctrue\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"1.2.4 --kubelet-https\u5f15\u6570\u304ctrue\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001--kubelet-https\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u524a\u9664\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"125---kubelet-client-certificate\u304a\u3088\u3073--kubelet-client-key\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"1.2.5 --kubelet-client-certificate\u304a\u3088\u3073--kubelet-client-key\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3063\u3066\u3001apiserver\u3068kubelets\u9593\u306eTLS\u63a5\u7d9a\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bkubelet\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3068\u30ad\u30fc\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"--kubelet-client-certificate=<path/to/client-certificate-file>\n--kubelet-client-key=<path/to/client-key-file>\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'kubelet-certificate-authority'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--kubelet-client-certificate' \u304c\u5b58\u5728\u3057\u3001'--kubelet-client-key' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-markdown",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"126-ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-automated",children:"1.2.6 Ensure that the --kubelet-certificate-authority argument is set as appropriate (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nFollow the Kubernetes documentation and setup the TLS connection between\nthe apiserver and kubelets. Then, edit the API server pod specification file\n/etc/kubernetes/manifests/kube-apiserver.yaml on the control plane node and set the\n--kubelet-certificate-authority parameter to the path to the cert file for the certificate authority\n",(0,t.jsx)(r.code,{children:"--kubelet-certificate-authority=<ca-string>"}),"."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'kubelet-certificate-authority'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--kubelet-certificate-authority' is present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"127-ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-automated",children:"1.2.7 Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml\non the control plane node and set the --authorization-mode parameter to values other than AlwaysAllow.\nOne such example could be as below.\n--authorization-mode=RBAC"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'authorization-mode'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--authorization-mode' does not have 'AlwaysAllow'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"128-ensure-that-the---authorization-mode-argument-includes-node-automated",children:"1.2.8 Ensure that the --authorization-mode argument includes Node (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml\non the control plane node and set the --authorization-mode parameter to a value that includes Node.\n--authorization-mode=Node,RBAC"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'authorization-mode'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--authorization-mode' has 'Node'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-markdown",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"126-ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-automated-1",children:"1.2.6 Ensure that the --kubelet-certificate-authority argument is set as appropriate (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nFollow the Kubernetes documentation and setup the TLS connection between\nthe apiserver and kubelets. Then, edit the API server pod specification file\n/etc/kubernetes/manifests/kube-apiserver.yaml on the control plane node and set the\n--kubelet-certificate-authority parameter to the path to the cert file for the certificate authority\n",(0,t.jsx)(r.code,{children:"--kubelet-certificate-authority=<ca-string>"}),"."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'kubelet-certificate-authority'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--kubelet-certificate-authority' is present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"127-ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-automated-1",children:"1.2.7 Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml\non the control plane node and set the --authorization-mode"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-markdown",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"129-ensure-that-the---authorization-mode-argument-includes-rbac-automated",children:"1.2.9 Ensure that the --authorization-mode argument includes RBAC (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001--authorization-mode \u30d1\u30e9\u30e1\u30fc\u30bf\u3092RBAC\u3092\u542b\u3080\u5024\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070 ",(0,t.jsx)(r.code,{children:"--authorization-mode=Node,RBAC"}),"\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'authorization-mode'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--authorization-mode' \u306b 'RBAC' \u304c\u542b\u307e\u308c\u3066\u3044\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1210-ensure-that-the-admission-control-plugin-eventratelimit-is-set-manual",children:"1.2.10 Ensure that the admission control plugin EventRateLimit is set (Manual)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u5e0c\u671b\u3059\u308b\u5236\u9650\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001API\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"--enable-admission-plugins=...,EventRateLimit,...\n--admission-control-config-file=<path/to/configuration/file>\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'enable-admission-plugins'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--enable-admission-plugins' \u306b 'EventRateLimit' \u304c\u542b\u307e\u308c\u3066\u3044\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1211-ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set-automated",children:"1.2.11 Ensure that the admission control plugin AlwaysAdmit is not set (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001--enable-admission-plugins \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u524a\u9664\u3059\u308b\u304b\u3001AlwaysAdmit\u3092\u542b\u307e\u306a\u3044\u5024\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'enable-admission-plugins'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--enable-admission-plugins' \u306b 'AlwaysAdmit' \u304c\u542b\u307e\u308c\u3066\u3044\u306a\u3044 \u307e\u305f\u306f '--enable-admission-plugins' \u304c\u5b58\u5728\u3057\u306a\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'```markdown\nSep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1212-ensure-that-the-admission-control-plugin-alwayspullimages-is-set-manual",children:"1.2.12 Ensure that the admission control plugin AlwaysPullImages is set (Manual)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," warn"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u306e\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u7de8\u96c6\u3057\u3001--enable-admission-plugins \u30d1\u30e9\u30e1\u30fc\u30bf\u306b AlwaysPullImages \u3092\u542b\u3081\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--enable-admission-plugins=...,AlwaysPullImages,..."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/ps -ef | grep containerd | grep -v grep\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--enable-admission-plugins' is present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root 1616 1600 6 13:26 ? 00:01:28 containerd -c /var/lib/rancher/k3s/agent/etc/containerd/config.toml -a /run/k3s/containerd/containerd.sock --state /run/k3s/containerd --root /var/lib/rancher/k3s/agent/containerd root 2318 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id b41ec3297be4625c2406ad8b7b4f8b91cddd60850c420050c4c3273f809b3e7e -address /run/k3s/containerd/containerd.sock root 2341 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id e7999a65ae0a4e9969f32317ec48ae4f7071b62f92e5236696737973be77c2e1 -address /run/k3s/containerd/containerd.sock root 3199 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 90c4e63d6ee29d40a48c2fdaf2738c2472cba1139dde8a550466c452184f8528 -address /run/k3s/containerd/containerd.sock root 3923 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id be5f4b9bd1ed9239362b7000b47f353acb8bc8ca52a9c9145cba0e902ec1c4b9 -address /run/k3s/containerd/containerd.sock root 4559 1 0 13:28 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 04cd40ea6b6078797f177c902c89412c70e523ad2a687a62829bf1d16ff0e19c -address /run/k3s/containerd/containerd.sock root 4647 1 0 13:28 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 48f37a480315b6adce2d2a5c5d67a85412dd0ba7a2e82816434e0deb9fa75de9 -address /run/k3s/containerd/containerd.sock root 6610 1 0 13:47 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 1cf71c22f568468055e517ab363437c0e54e45274c64024d337cc5bcce66341d -address /run/k3s/containerd/containerd.sock\n"})}),"\n",(0,t.jsx)(r.h3,{id:"1213-ensure-that-the-admission-control-plugin-securitycontextdeny-is-set-if-podsecuritypolicy-is-not-used-manual",children:"1.2.13 Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used (Manual)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," warn"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u306e\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u7de8\u96c6\u3057\u3001--enable-admission-plugins \u30d1\u30e9\u30e1\u30fc\u30bf\u306b SecurityContextDeny \u3092\u542b\u3081\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u305f\u3060\u3057\u3001PodSecurityPolicy \u304c\u65e2\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u9664\u304d\u307e\u3059\u3002\n--enable-admission-plugins=...,SecurityContextDeny,..."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'enable-admission-plugins'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--enable-admission-plugins' has 'SecurityContextDeny' OR '--enable-admission-plugins' has 'PodSecurityPolicy'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1214-ensure-that-the-admission-control-plugin-serviceaccount-is-set-automated",children:"1.2.14 Ensure that the admission control plugin ServiceAccount is set (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001\u74b0\u5883\u306b\u5fdc\u3058\u3066 ServiceAccount \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001API\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u306e\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u3067\u7de8\u96c6\u3057\u3001--disable-admission-plugins \u30d1\u30e9\u30e1\u30fc\u30bf\u304c ServiceAccount \u3092\u542b\u307e\u306a\u3044\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep -v grep\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--disable-admission-plugins' is present OR '--disable-admission-plugins' is not present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'```markdown\nSep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1215-namespacelifecycle-\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.15 NamespaceLifecycle \u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e API \u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001--disable-admission-plugins \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u3066 NamespaceLifecycle \u304c\u542b\u307e\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep -v grep\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--disable-admission-plugins' \u304c\u5b58\u5728\u3059\u308b\u304b '--disable-admission-plugins' \u304c\u5b58\u5728\u3057\u306a\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1216-noderestriction-\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.16 NodeRestriction \u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes \u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001kubelet \u306b NodeRestriction \u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e API \u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001--enable-admission-plugins \u30d1\u30e9\u30e1\u30fc\u30bf\u306b NodeRestriction \u3092\u542b\u3080\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--enable-admission-plugins=...,NodeRestriction,..."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'enable-admission-plugins'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--enable-admission-plugins' \u306b 'NodeRestriction' \u304c\u542b\u307e\u308c\u3066\u3044\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1217---secure-port-\u5f15\u6570\u304c-0-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.17 --secure-port \u5f15\u6570\u304c 0 \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e API \u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001--secure-port \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u524a\u9664\u3059\u308b\u304b\u30010 \u4ee5\u5916\u306e\u7570\u306a\u308b\u30dd\u30fc\u30c8\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'secure-port'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--secure-port' \u304c 0 \u3088\u308a\u5927\u304d\u3044\u304b '--secure-port' \u304c\u5b58\u5728\u3057\u306a\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'```markdown\nSep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1218---profiling-\u5f15\u6570\u304c-false-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.18 --profiling \u5f15\u6570\u304c false \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e /etc/kubernetes/manifests/kube-apiserver.yaml \u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--profiling=false"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'profiling'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--profiling' \u304c 'false' \u306b\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1219---audit-log-path-\u5f15\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.19 --audit-log-path \u5f15\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e /etc/kubernetes/manifests/kube-apiserver.yaml \u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001--audit-log-path \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9069\u5207\u306a\u30d1\u30b9\u3068\u30d5\u30a1\u30a4\u30eb\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\n--audit-log-path=/var/log/apiserver/audit.log"]}),"\n",(0,t.jsx)(r.h3,{id:"1220---audit-log-maxage-\u5f15\u6570\u304c-30-\u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.20 --audit-log-maxage \u5f15\u6570\u304c 30 \u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e /etc/kubernetes/manifests/kube-apiserver.yaml \u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001--audit-log-maxage \u30d1\u30e9\u30e1\u30fc\u30bf\u3092 30 \u307e\u305f\u306f\u9069\u5207\u306a\u65e5\u6570\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\n--audit-log-maxage=30"]}),"\n",(0,t.jsx)(r.h3,{id:"1221---audit-log-maxbackup-\u5f15\u6570\u304c-10-\u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.21 --audit-log-maxbackup \u5f15\u6570\u304c 10 \u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e /etc/kubernetes/manifests/kube-apiserver.yaml \u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001--audit-log-maxbackup \u30d1\u30e9\u30e1\u30fc\u30bf\u3092 10 \u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\n--audit-log-maxbackup=10"]}),"\n",(0,t.jsx)(r.h3,{id:"1222---audit-log-maxsize-\u5f15\u6570\u304c-100-\u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.22 --audit-log-maxsize \u5f15\u6570\u304c 100 \u307e\u305f\u306f\u9069\u5207\u306a\u5024\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e /etc/kubernetes/manifests/kube-apiserver.yaml \u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001--audit-log-maxsize \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9069\u5207\u306a\u30b5\u30a4\u30ba\uff08MB\u5358\u4f4d\uff09\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001100 MB \u306b\u8a2d\u5b9a\u3059\u308b\u5834\u5408\u3001\n--audit-log-maxsize=100"]}),"\n",(0,t.jsx)(r.h3,{id:"1224---service-account-lookup-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.24 --service-account-lookup \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e /etc/kubernetes/manifests/kube-apiserver.yaml \u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--service-account-lookup=true\n\u307e\u305f\u306f\u3001\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089 --service-account-lookup \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u524a\u9664\u3057\u3066\u30c7\u30d5\u30a9\u30eb\u30c8\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep -v grep\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--service-account-lookup' \u304c\u5b58\u5728\u3057\u306a\u3044\u3001\u307e\u305f\u306f '--service-account-lookup' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1225---request-timeout-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.25 --request-timeout \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e /etc/kubernetes/manifests/kube-apiserver.yaml \u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001--service-account-key-file \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u516c\u958b\u9375\u30d5\u30a1\u30a4\u30eb\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\n",(0,t.jsx)(r.code,{children:"--service-account-key-file=<filename>"}),"\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"1226---etcd-certfile-\u304a\u3088\u3073---etcd-keyfile-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"1.2.26 --etcd-certfile \u304a\u3088\u3073 --etcd-keyfile \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes \u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3063\u3066\u3001apiserver \u3068 etcd \u9593\u306e TLS \u63a5\u7d9a\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e /etc/kubernetes/manifests/kube-apiserver.yaml \u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001etcd \u8a3c\u660e\u66f8\u304a\u3088\u3073\u9375\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"--etcd-certfile=<path/to/client-certificate-file>\n--etcd-keyfile=<path/to/client-key-file>\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'**\u76e3\u67fb\u30b9\u30af\u30ea\u30d7\u30c8:** `check_for_k3s_etcd.sh`\n\n```bash\n#!/bin/bash\n\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001k3s\u304c\u5b9f\u969b\u306betcd\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3053\u3068\uff08sqlite3\u306a\u3069\u306e\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u306f\u306a\u3044\u3053\u3068\uff09\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\n# \u8981\u4ef6\u3092\u78ba\u8a8d\u3059\u308b\u524d\u306b\nset -eE\n\nhandle_error() {\n    echo "false"\n}\n\ntrap \'handle_error\' ERR\n\n\nif [[ "$(journalctl -D /var/log/journal -u k3s | grep \'Managed etcd cluster initializing\' | grep -v grep | wc -l)" -gt 0 ]]; then\n    case $1 in \n        "1.1.11")\n            echo $(stat -c %a /var/lib/rancher/k3s/server/db/etcd);;\n        "1.2.29")\n            echo $(journalctl -D /var/log/journal -u k3s | grep \'Running kube-apiserver\' | tail -n1 | grep \'etcd-\');;\n        "2.1")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.2")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.3")\n            echo $(grep \'auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.4")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.5")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.6")\n            echo $(grep \'peer-auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.7")\n            echo $(grep \'trusted-ca-file\' /var/lib/rancher/k3s/server/db/etcd/config);;\n    esac\nelse\n# \u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b9\u30ad\u30e3\u30f3\u3092\u901a\u904e\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u8fd4\u3057\u307e\u3059\n    case $1 in\n        "1.1.11")\n            echo "700";;\n        "1.2.29")\n            echo "--etcd-certfile AND --etcd-keyfile";;\n        "2.1")\n            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 1.2.29\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--etcd-certfile' \u304c\u5b58\u5728\u3057\u3001'--etcd-keyfile' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"--etcd-certfile AND --etcd-keyfile\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"1227---tls-cert-file-\u304a\u3088\u3073---tls-private-key-file-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:["1.2.27 ",(0,t.jsx)(r.code,{children:"--tls-cert-file"})," \u304a\u3088\u3073 ",(0,t.jsx)(r.code,{children:"--tls-private-key-file"})," \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001apiserver\u3067TLS\u63a5\u7d9a\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u6b21\u306b\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb ",(0,t.jsx)(r.code,{children:"/etc/kubernetes/manifests/kube-apiserver.yaml"})," \u3092\u7de8\u96c6\u3057\u3001TLS\u8a3c\u660e\u66f8\u304a\u3088\u3073\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"--tls-cert-file=<path/to/tls-certificate-file>\n--tls-private-key-file=<path/to/tls-key-file>\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep -A1 'Running kube-apiserver' | tail -n2\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--tls-cert-file' \u304c\u5b58\u5728\u3057\u3001'--tls-private-key-file' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key" Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-scheduler --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/kube-scheduler --kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --profiling=false --secure-port=10259"\n'})}),"\n",(0,t.jsxs)(r.h3,{id:"1228---client-ca-file-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:["1.2.28 ",(0,t.jsx)(r.code,{children:"--client-ca-file"})," \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001apiserver\u3067TLS\u63a5\u7d9a\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u6b21\u306b\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb ",(0,t.jsx)(r.code,{children:"/etc/kubernetes/manifests/kube-apiserver.yaml"})," \u3092\u7de8\u96c6\u3057\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n",(0,t.jsx)(r.code,{children:"--client-ca-file=<path/to/client-ca-file>"})]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'client-ca-file'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--client-ca-file' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsxs)(r.h3,{id:"1229---etcd-cafile-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:["1.2.29 ",(0,t.jsx)(r.code,{children:"--etcd-cafile"})," \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001apiserver\u3068etcd\u9593\u306eTLS\u63a5\u7d9a\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u6b21\u306b\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb ",(0,t.jsx)(r.code,{children:"/etc/kubernetes/manifests/kube-apiserver.yaml"})," \u3092\u7de8\u96c6\u3057\u3001etcd\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n",(0,t.jsx)(r.code,{children:"--etcd-cafile=<path/to/ca-file>"})]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'etcd-cafile'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--etcd-cafile' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-markdown",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"1230-ensure-that-the---encryption-provider-config-argument-is-set-as-appropriate-manual",children:"1.2.30 Ensure that the --encryption-provider-config argument is set as appropriate (Manual)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," warn"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nFollow the Kubernetes documentation and configure a EncryptionConfig file.\nThen, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml\non the control plane node and set the --encryption-provider-config parameter to the path of that file.\nFor example, ",(0,t.jsx)(r.code,{children:"--encryption-provider-config=</path/to/EncryptionConfig/File>"})]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'encryption-provider-config'\n"})}),"\n",(0,t.jsx)(r.h3,{id:"1231-ensure-that-encryption-providers-are-appropriately-configured-manual",children:"1.2.31 Ensure that encryption providers are appropriately configured (Manual)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," warn"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nFollow the Kubernetes documentation and configure a EncryptionConfig file.\nIn this file, choose aescbc, kms or secretbox as the encryption provider."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"grep aescbc /path/to/encryption-config.json\n"})}),"\n",(0,t.jsx)(r.h3,{id:"1232-ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers-manual",children:"1.2.32 Ensure that the API Server only makes use of Strong Cryptographic Ciphers (Manual)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," warn"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml\non the control plane node and set the below parameter.\n--tls-cipher-suites=TLS_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_CHACHA20_POLY1305_SHA256,\nTLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,\nTLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,\nTLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,\nTLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,\nTLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,\nTLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA,\nTLS_RSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_GCM_SHA384"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'tls-cipher-suites'\n"})}),"\n",(0,t.jsx)(r.h2,{id:"13-controller-manager",children:"1.3 Controller Manager"}),"\n",(0,t.jsx)(r.h3,{id:"131-ensure-that-the---terminated-pod-gc-threshold-argument-is-set-as-appropriate-manual",children:"1.3.1 Ensure that the --terminated-pod-gc-threshold argument is set as appropriate (Manual)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," warn"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml\non the control plane node and set the --terminated-pod-gc-threshold to an appropriate threshold,\nfor example, --terminated-pod-gc-threshold=10"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-controller-manager' | tail -n1 | grep 'terminated-pod-gc-threshold'\n"})}),"\n",(0,t.jsx)(r.h3,{id:"132-ensure-that-the---profiling-argument-is-set-to-false-automated",children:"1.3.2 Ensure that the --profiling argument is set to false (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml\non the control plane node and set the below parameter.\n--profiling=false"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-controller-manager' | tail -n1 | grep 'profiling'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--profiling' is equal to 'false'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/kube-controller-manager --cluster-cidr=10.42.0.0/16 --cluster-signing-kube-apiserver-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --cluster-signing-kube-apiserver-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --cluster-signing-kubelet-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-serving-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-kubelet-serving-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --cluster-signing-legacy-unknown-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-legacy-unknown-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --configure-cloud-routes=false --controllers=*,-service,-route,-cloud-node-lifecycle --feature-gates=JobTrackingWithFinalizers=true --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --profiling=false --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=10257 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --use-service-account-credentials=true"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"133-ensure-that-the---use-service-account-credentials-argument-is-set-to-true-automated",children:"1.3.3 Ensure that the --use-service-account-credentials argument is set to true (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml\non the control plane node to set the below parameter.\n--use-service-account-credentials=true"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-controller-manager' | tail -n1 | grep 'use-service-account-credentials'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--use-service-account-credentials' is not equal to 'false'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/kube-controller-manager --cluster-cidr=10.42.0.0/16 --cluster-signing-kube-apiserver-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --cluster-signing-kube-apiserver-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --cluster-signing-kubelet-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-serving-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-kubelet-serving-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --cluster-signing-legacy-unknown-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-legacy-unknown-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --configure-cloud-routes=false --controllers=*,-service,-route,-cloud-node-lifecycle --feature-gates=JobTrackingWithFinalizers=true --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --profiling=false --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=10257 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --use-service-account-credentials=true"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"134-ensure-that-the---service-account-private-key-file-argument-is-set-as-appropriate-automated",children:"1.3.4 Ensure that the --service-account-private-key-file argument is set as appropriate (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml\non the control plane node and set the --service-account-private-key-file parameter\nto the private key file for service accounts. For example,\n",(0,t.jsx)(r.code,{children:"--service-account-private-key-file=<filename>"}),"."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-controller-manager' | tail -n1 | grep 'service-account-private-key-file'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--service-account-private-key-file' is present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-markdown",children:"\n### 1.2.30 \u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u305f --encryption-provider-config \u5f15\u6570\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)\n\n**\u7d50\u679c:** \u8b66\u544a\n\n**\u4fee\u6b63\u65b9\u6cd5:**\nKubernetes\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001EncryptionConfig\u30d5\u30a1\u30a4\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u6b21\u306b\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001\n--encryption-provider-config \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u4f8b: `--encryption-provider-config=</path/to/EncryptionConfig/File>`\n\n**\u76e3\u67fb:**\n\n```bash\njournalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'encryption-provider-config'\n"})}),"\n",(0,t.jsx)(r.h3,{id:"1231-\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u305f\u6697\u53f7\u5316\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",children:"1.2.31 \u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u305f\u6697\u53f7\u5316\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001EncryptionConfig\u30d5\u30a1\u30a4\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u3001\u6697\u53f7\u5316\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3068\u3057\u3066aescbc\u3001kms\u3001\u307e\u305f\u306fsecretbox\u3092\u9078\u629e\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"grep aescbc /path/to/encryption-config.json\n"})}),"\n",(0,t.jsx)(r.h3,{id:"1232-api\u30b5\u30fc\u30d0\u30fc\u304c\u5f37\u529b\u306a\u6697\u53f7\u5316\u30b9\u30a4\u30fc\u30c8\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",children:"1.2.32 API\u30b5\u30fc\u30d0\u30fc\u304c\u5f37\u529b\u306a\u6697\u53f7\u5316\u30b9\u30a4\u30fc\u30c8\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306eAPI\u30b5\u30fc\u30d0\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-apiserver.yaml \u3092\u7de8\u96c6\u3057\u3001\n\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--tls-cipher-suites=TLS_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_CHACHA20_POLY1305_SHA256,\nTLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,\nTLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,\nTLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,\nTLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,\nTLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,\nTLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA,\nTLS_RSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_GCM_SHA384"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'tls-cipher-suites'\n"})}),"\n",(0,t.jsx)(r.h2,{id:"13-\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc",children:"1.3 \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc"}),"\n",(0,t.jsx)(r.h3,{id:"131-\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u305f---terminated-pod-gc-threshold-\u5f15\u6570\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",children:"1.3.1 \u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u305f --terminated-pod-gc-threshold \u5f15\u6570\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-controller-manager.yaml \u3092\u7de8\u96c6\u3057\u3001\n--terminated-pod-gc-threshold \u3092\u9069\u5207\u306a\u95be\u5024\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u4f8b: --terminated-pod-gc-threshold=10"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-controller-manager' | tail -n1 | grep 'terminated-pod-gc-threshold'\n"})}),"\n",(0,t.jsx)(r.h3,{id:"132---profiling-\u5f15\u6570\u304c-false-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5",children:"1.3.2 --profiling \u5f15\u6570\u304c false \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d7\u30ec\u30fc\u30f3\u30ce\u30fc\u30c9\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/kube-controller-manager.yaml \u3092\u7de8\u96c6\u3057\u3001\n\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--profiling=false"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-controller-manager' | tail -n1 | grep 'profiling'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--profiling' \u304c 'false' \u306b\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/kube-controller-manager --cluster-cidr=10.42.0.0/16\n```markdown\nSep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/kube-controller-manager --cluster-cidr=10.42.0.0/16 --cluster-signing-kube-apiserver-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --cluster-signing-kube-apiserver-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --cluster-signing-kubelet-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-serving-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-kubelet-serving-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --cluster-signing-legacy-unknown-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-legacy-unknown-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --configure-cloud-routes=false --controllers=*,-service,-route,-cloud-node-lifecycle --feature-gates=JobTrackingWithFinalizers=true --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --profiling=false --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=10257 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --use-service-account-credentials=true"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"135-ensure-that-the---root-ca-file-argument-is-set-as-appropriate-automated",children:"1.3.5 Ensure that the --root-ca-file argument is set as appropriate (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml\non the control plane node and set the --root-ca-file parameter to the certificate bundle file.\n",(0,t.jsx)(r.code,{children:"--root-ca-file=<path/to/file>"})]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-controller-manager' | tail -n1 | grep 'root-ca-file'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--root-ca-file' is present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/kube-controller-manager --cluster-cidr=10.42.0.0/16 --cluster-signing-kube-apiserver-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --cluster-signing-kube-apiserver-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --cluster-signing-kubelet-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-serving-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-kubelet-serving-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --cluster-signing-legacy-unknown-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-legacy-unknown-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --configure-cloud-routes=false --controllers=*,-service,-route,-cloud-node-lifecycle --feature-gates=JobTrackingWithFinalizers=true --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --profiling=false --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=10257 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --use-service-account-credentials=true"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"136-ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-automated",children:"1.3.6 Ensure that the RotateKubeletServerCertificate argument is set to true (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," Not Applicable"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml\non the control plane node and set the --feature-gates parameter to include RotateKubeletServerCertificate=true.\n--feature-gates=RotateKubeletServerCertificate=true"]}),"\n",(0,t.jsx)(r.h3,{id:"137-ensure-that-the---bind-address-argument-is-set-to-127001-automated",children:"1.3.7 Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml\non the control plane node and ensure the correct value for the --bind-address parameter"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/ps -ef | grep containerd | grep -v grep\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--bind-address' is present OR '--bind-address' is not present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root 1616 1600 6 13:26 ? 00:01:28 containerd -c /var/lib/rancher/k3s/agent/etc/containerd/config.toml -a /run/k3s/containerd/containerd.sock --state /run/k3s/containerd --root /var/lib/rancher/k3s/agent/containerd root 2318 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id b41ec3297be4625c2406ad8b7b4f8b91cddd60850c420050c4c3273f809b3e7e -address /run/k3s/containerd/containerd.sock root 2341 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id e7999a65ae0a4e9969f32317ec48ae4f7071b62f92e5236696737973be77c2e1 -address /run/k3s/containerd/containerd.sock root 3199 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 90c4e63d6ee29d40a48c2fdaf2738c2472cba1139dde8a550466c452184f8528 -address /run/k3s/containerd/containerd.sock root 3923 1 0 13:27 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id be5f4b9bd1ed9239362b7000b47f353acb8bc8ca52a9c9145cba0e902ec1c4b9 -address /run/k3s/containerd/containerd.sock root 4559 1 0 13:28 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 04cd40ea6b6078797f177c902c89412c70e523ad2a687a62829bf1d16ff0e19c -address /run/k3s/containerd/containerd.sock root 4647 1 0 13:28 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 48f37a480315b6adce2d2a5c5d67a85412dd0ba7a2e82816434e0deb9fa75de9 -address /run/k3s/containerd/containerd.sock root 6610 1 0 13:47 ? 00:00:00 /var/lib/rancher/k3s/data/577968fa3d58539cc4265245941b7be688833e6bf5ad7869fa2afe02f15f1cd2/bin/containerd-shim-runc-v2 -namespace k8s.io -id 1cf71c22f568468055e517ab363437c0e54e45274c64024d337cc5bcce66341d -address /run/k3s/containerd/containerd.sock\n"})}),"\n",(0,t.jsx)(r.h2,{id:"14-scheduler",children:"1.4 Scheduler"}),"\n",(0,t.jsx)(r.h3,{id:"141-ensure-that-the---profiling-argument-is-set-to-false-automated",children:"1.4.1 Ensure that the --profiling argument is set to false (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the Scheduler pod specification file /etc/kubernetes/manifests/kube-scheduler.yaml file\non the control plane node and set the below parameter.\n--profiling=false"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-scheduler' | tail -n1\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--profiling' is equal to 'false'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-scheduler --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/kube-scheduler --kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --profiling=false --secure-port=10259"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"142-ensure-that-the---bind-address-argument-is-set-to-127001-automated",children:"1.4.2 Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nEdit the Scheduler pod specification file /etc/kubernetes/manifests/kube-scheduler.yaml\non the control plane node and ensure the correct value for the --bind-address parameter"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-scheduler' | tail -n1 | grep 'bind-address'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--bind-address' is equal to '127.0.0.1' OR '--bind-address' is not present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-scheduler --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/kube-scheduler --kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --profiling=false --secure-port=10259"\n'})}),"\n",(0,t.jsx)(r.h2,{id:"2-etcd-node-configuration",children:"2 Etcd Node Configuration"}),"\n",(0,t.jsx)(r.h3,{id:"21-ensure-that-the---cert-file-and---key-file-arguments-are-set-as-appropriate-automated",children:"2.1 Ensure that the --cert-file and --key-file arguments are set as appropriate (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nFollow the etcd service documentation and configure TLS encryption.\nThen, edit the etcd pod specification file /etc/kubernetes/manifests/etcd.yaml\non the master node and set the below parameters."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"--cert-file=</path/to/ca-file>\n--key-file=</path/to/key-file>\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Audit Script:"})," ",(0,t.jsx)(r.code,{children:"check_for_k3s_etcd.sh"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'#!/bin/bash\n\n# This script is used to ensure that k3s is actually running etcd (and not other databases like sqlite3)\n# before it checks the requirement\nset -eE\n\nhandle_error() {\n    echo "false"\n}\n\ntrap \'handle_error\' ERR\n\n\nif [[ "$(journalctl -D /var/log/journal -u k3s | grep \'Managed etcd cluster initializing\' | grep -v grep | wc -l)" -gt 0 ]]; then\n    case $1 in \n        "1.1.11")\n            echo $(stat -c %a /var/lib/rancher/k3s/server/db/etcd);;\n        "1.2.29")\n            echo $(journalctl -D /var/log/journal -u k3s | grep \'Running kube-apiserver\' | tail -n1 | grep \'etcd-\');;\n        "2.1")\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'```bash\n            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 2.1\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'cert-file' \u304c\u5b58\u5728\u3057\u3001\u304b\u3064 'key-file' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"cert-file AND key-file cert-file: /var/lib/rancher/k3s/server/tls/etcd/server-client.crt key-file: /var/lib/rancher/k3s/server/tls/etcd/server-client.key cert-file AND key-file\n"})}),"\n",(0,t.jsx)(r.h3,{id:"22---client-cert-auth-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"2.2 --client-cert-auth \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),'\n\u30de\u30b9\u30bf\u30fc\u30ce\u30fc\u30c9\u306e etcd \u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/etcd.yaml \u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--client-cert-auth="true"']}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u30b9\u30af\u30ea\u30d7\u30c8:"})," ",(0,t.jsx)(r.code,{children:"check_for_k3s_etcd.sh"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001k3s \u304c\u5b9f\u969b\u306b etcd \u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3053\u3068\uff08sqlite3 \u306a\u3069\u306e\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u306f\u306a\u3044\u3053\u3068\uff09\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\n# \u8981\u4ef6\u3092\u78ba\u8a8d\u3059\u308b\u524d\u306b\nset -eE\n\nhandle_error() {\n    echo "false"\n}\n\ntrap \'handle_error\' ERR\n\n\nif [[ "$(journalctl -D /var/log/journal -u k3s | grep \'Managed etcd cluster initializing\' | grep -v grep | wc -l)" -gt 0 ]]; then\n    case $1 in \n        "1.1.11")\n            echo $(stat -c %a /var/lib/rancher/k3s/server/db/etcd);;\n        "1.2.29")\n            echo $(journalctl -D /var/log/journal -u k3s | grep \'Running kube-apiserver\' | tail -n1 | grep \'etcd-\');;\n        "2.1")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.2")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.3")\n            echo $(grep \'auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.4")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.5")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.6")\n            echo $(grep \'peer-auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.7")\n            echo $(grep \'trusted-ca-file\' /var/lib/rancher/k3s/server/db/etcd/config);;\n    esac\nelse\n# \u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b9\u30ad\u30e3\u30f3\u3092\u901a\u904e\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u8fd4\u3057\u307e\u3059\n    case $1 in\n        "1.1.11")\n            echo "700";;\n        "1.2.29")\n            echo "--etcd-certfile AND --etcd-keyfile";;\n        "2.1")\n            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 2.2\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--client-cert-auth' \u304c\u5b58\u5728\u3059\u308b\u3001\u307e\u305f\u306f 'client-cert-auth' \u304c 'true' \u306b\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"--client-cert-auth=true client-cert-auth: true --client-cert-auth=true\n"})}),"\n",(0,t.jsx)(r.h3,{id:"23---auto-tls-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"2.3 --auto-tls \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30de\u30b9\u30bf\u30fc\u30ce\u30fc\u30c9\u306e etcd \u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/etcd.yaml \u3092\u7de8\u96c6\u3057\u3001--auto-tls \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u524a\u9664\u3059\u308b\u304b\u3001false \u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--auto-tls=false"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u30b9\u30af\u30ea\u30d7\u30c8:"})," ",(0,t.jsx)(r.code,{children:"check_for_k3s_etcd.sh"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001k3s \u304c\u5b9f\u969b\u306b etcd \u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3053\u3068\uff08sqlite3 \u306a\u3069\u306e\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u306f\u306a\u3044\u3053\u3068\uff09\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\n# \u8981\u4ef6\u3092\u78ba\u8a8d\u3059\u308b\u524d\u306b\nset -eE\n\nhandle_error() {\n    echo "false"\n}\n\ntrap \'handle_error\' ERR\n\n\nif [[ "$(journalctl -D /var/log/journal -u k3s | grep \'Managed etcd cluster initializing\' | grep -v grep | wc -l)" -gt 0 ]]; then\n    case $1 in \n        "1.1.11")\n            echo $(stat -c %a /var/lib/rancher/k3s/server/db/etcd);;\n        "1.2.29")\n            echo $(journalctl -D /var/log/journal -u k3s | grep \'Running kube-apiserver\' | tail -n1 | grep \'etcd-\');;\n        "2.1")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.2")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.3")\n            echo $(grep \'auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.4")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.5")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.6")\n            echo $(grep \'peer-auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.7")\n            echo $(grep \'trusted-ca-file\' /var/lib/rancher/k3s/server/db/etcd/config);;\n    esac\nelse\n# \u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b9\u30ad\u30e3\u30f3\u3092\u901a\u904e\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u8fd4\u3057\u307e\u3059\n    case $1 in\n        "1.1.11")\n            echo "700";;\n        "1.2.29")\n            echo "--etcd-certfile AND --etcd-keyfile";;\n        "2.1")\n            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 2.3\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'ETCD_AUTO_TLS' \u304c\u5b58\u5728\u3057\u306a\u3044\u3001\u307e\u305f\u306f 'ETCD_AUTO_TLS' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"error: process ID list syntax error Usage: ps [options] Try 'ps --help <simple|list|output|threads|misc|all>' or 'ps --help <s|l|o|t|m|a>' for additional help text. For more details see ps(1). cat: /proc//environ: No such file or directory error: process ID list syntax error Usage: ps [options] Try 'ps --help <simple|list|output|threads|misc|all>' or 'ps --help <s|l|o|t|m|a>' for additional help text. For more details see ps(1). cat: /proc//environ: No such file or directory error: process ID list syntax error Usage: ps [options] Try 'ps --help <simple|list|output|threads|misc|all>' or 'ps --help <s|l|o|t|m|a>' for additional help text. For more details see ps(1). cat: /proc//environ: No such file or directory\n"})}),"\n",(0,t.jsx)(r.h3,{id:"24---peer-cert-file-\u304a\u3088\u3073---peer-key-file-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"2.4 --peer-cert-file \u304a\u3088\u3073 --peer-key-file \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\netcd \u30b5\u30fc\u30d3\u30b9\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001etcd \u30af\u30e9\u30b9\u30bf\u30fc\u306b\u9069\u3057\u305f\u30d4\u30a2 TLS \u6697\u53f7\u5316\u3092\u69cb\u6210\u3057\u307e\u3059\u3002\n\u6b21\u306b\u3001\u30de\u30b9\u30bf\u30fc\u30ce\u30fc\u30c9\u306e etcd \u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/etcd.yaml \u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"--peer-client-file=</path/to/peer-cert-file>\n--peer-key-file=</path/to/peer-key-file>\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u30b9\u30af\u30ea\u30d7\u30c8:"})," ",(0,t.jsx)(r.code,{children:"check_for_k3s_etcd.sh"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001k3s \u304c\u5b9f\u969b\u306b etcd \u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3053\u3068\uff08sqlite3 \u306a\u3069\u306e\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u306f\u306a\u3044\u3053\u3068\uff09\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\n# \u8981\u4ef6\u3092\u78ba\u8a8d\u3059\u308b\u524d\u306b\nset -eE\n\nhandle_error() {\n    echo "false"\n}\n\ntrap \'handle_error\' ERR\n\n\nif [[ "$(journalctl -D /var/log/journal -u k3s | grep \'Managed etcd cluster initializing\' | grep -v grep | wc -l)" -gt 0 ]]; then\n    case $1 in \n        "1.1.11")\n            echo $(stat -c %a /var/lib/rancher/k3s/server/db/etcd);;\n        "1.2.29")\n            echo $(journalctl -D /var/log/journal -u k3s | grep \'Running kube-apiserver\' | tail -n1 | grep \'etcd-\');;\n        "2.1")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.2")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.3")\n            echo $(grep \'auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.4")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.5")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.6")\n            echo $(grep \'peer-auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.7")\n            echo $(grep \'trusted-ca-file\' /var/lib/rancher/k3s/server/db/etcd/config);;\n    esac\nelse\n# \u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b9\u30ad\u30e3\u30f3\u3092\u901a\u904e\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u8fd4\u3057\u307e\u3059\n    case $1 in\n        "1.1.11")\n            echo "700";;\n        "1.2.29")\n            echo "--etcd-certfile AND --etcd-keyfile";;\n        "2.1")\n            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 2.3\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'ETCD_AUTO_TLS' \u304c\u5b58\u5728\u3057\u306a\u3044\u3001\u307e\u305f\u306f 'ETCD_AUTO_TLS' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"error: process ID list syntax error Usage: ps [options] Try 'ps --help <simple|list|output|threads|misc|all>' or 'ps --help <s|l|o|t|m|a>' for additional help text. For more details see ps(1). cat: /proc//environ: No such file or directory error: process ID list syntax error Usage: ps [options] Try 'ps --help <simple|list|output|threads|misc|all>' or 'ps --help <s|l|o|t|m|a>' for additional help text. For more details see ps(1). cat: /proc//environ: No such file or directory error: process ID list syntax error Usage: ps [options] Try 'ps --help <simple|list|output|threads|misc|all>' or 'ps --help <s|l|o|t|m|a>' for additional help text. For more details see ps(1). cat: /proc//environ: No such file or directory\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 2.4\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'cert-file' \u304c\u5b58\u5728\u3057\u3001\u304b\u3064 'key-file' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"peer-cert-file AND peer-key-file cert-file: /var/lib/rancher/k3s/server/tls/etcd/peer-server-client.crt key-file: /var/lib/rancher/k3s/server/tls/etcd/peer-server-client.key peer-cert-file AND peer-key-file\n"})}),"\n",(0,t.jsx)(r.h3,{id:"25---peer-client-cert-auth-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"2.5 --peer-client-cert-auth \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30de\u30b9\u30bf\u30fc\u30ce\u30fc\u30c9\u306e etcd \u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/etcd.yaml \u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--peer-client-cert-auth=true"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u30b9\u30af\u30ea\u30d7\u30c8:"})," ",(0,t.jsx)(r.code,{children:"check_for_k3s_etcd.sh"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001k3s \u304c\u5b9f\u969b\u306b etcd \u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3053\u3068\uff08sqlite3 \u306a\u3069\u306e\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u306f\u306a\u3044\u3053\u3068\uff09\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\n# \u8981\u4ef6\u3092\u78ba\u8a8d\u3059\u308b\u524d\u306b\nset -eE\n\nhandle_error() {\n    echo "false"\n}\n\ntrap \'handle_error\' ERR\n\n\nif [[ "$(journalctl -D /var/log/journal -u k3s | grep \'Managed etcd cluster initializing\' | grep -v grep | wc -l)" -gt 0 ]]; then\n    case $1 in \n        "1.1.11")\n            echo $(stat -c %a /var/lib/rancher/k3s/server/db/etcd);;\n        "1.2.29")\n            echo $(journalctl -D /var/log/journal -u k3s | grep \'Running kube-apiserver\' | tail -n1 | grep \'etcd-\');;\n        "2.1")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.2")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.3")\n            echo $(grep \'auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.4")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.5")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.6")\n            echo $(grep \'peer-auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.7")\n            echo $(grep \'trusted-ca-file\' /var/lib/rancher/k3s/server/db/etcd/config);;\n    esac\nelse\n# \u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b9\u30ad\u30e3\u30f3\u3092\u30d1\u30b9\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u8fd4\u3057\u307e\u3059\n    case $1 in\n        "1.1.11")\n            echo "700";;\n        "1.2.29")\n            echo "--etcd-certfile AND --etcd-keyfile";;\n        "2.1")\n            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 2.5\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--client-cert-auth' \u304c\u5b58\u5728\u3059\u308b\u3001\u307e\u305f\u306f 'client-cert-auth' \u304c 'true' \u3068\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"--client-cert-auth=true client-cert-auth: true --client-cert-auth=true\n"})}),"\n",(0,t.jsx)(r.h3,{id:"26---peer-auto-tls-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u81ea\u52d5\u5316",children:"2.6 --peer-auto-tls \u5f15\u6570\u304c true \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30de\u30b9\u30bf\u30fc\u30ce\u30fc\u30c9\u306e etcd \u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/etcd.yaml \u3092\u7de8\u96c6\u3057\u3001--peer-auto-tls \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u524a\u9664\u3059\u308b\u304b\u3001false \u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--peer-auto-tls=false"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u30b9\u30af\u30ea\u30d7\u30c8:"})," ",(0,t.jsx)(r.code,{children:"check_for_k3s_etcd.sh"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001k3s \u304c\u5b9f\u969b\u306b etcd \u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3053\u3068\uff08sqlite3 \u306a\u3069\u306e\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u306f\u306a\u3044\u3053\u3068\uff09\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\n# \u8981\u4ef6\u3092\u78ba\u8a8d\u3059\u308b\u524d\u306b\nset -eE\n\nhandle_error() {\n    echo "false"\n}\n\ntrap \'handle_error\' ERR\n\n\nif [[ "$(journalctl -D /var/log/journal -u k3s | grep \'Managed etcd cluster initializing\' | grep -v grep | wc -l)" -gt 0 ]]; then\n    case $1 in \n        "1.1.11")\n            echo $(stat -c %a /var/lib/rancher/k3s/server/db/etcd);;\n        "1.2.29")\n            echo $(journalctl -D /var/log/journal -u k3s | grep \'Running kube-apiserver\' | tail -n1 | grep \'etcd-\');;\n        "2.1")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.2")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.3")\n            echo $(grep \'auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.4")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.5")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.6")\n            echo $(grep \'peer-auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.7")\n            echo $(grep \'trusted-ca-file\' /var/lib/rancher/k3s/server/db/etcd/config);;\n    esac\nelse\n# \u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b9\u30ad\u30e3\u30f3\u3092\u30d1\u30b9\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u8fd4\u3057\u307e\u3059\n    case $1 in\n        "1.1.11")\n            echo "700";;\n        "1.2.29")\n            echo "--etcd-certfile AND --etcd-keyfile";;\n        "2.1")\n            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 2.6\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--peer-auto-tls' \u304c\u5b58\u5728\u3057\u306a\u3044\u3001\u307e\u305f\u306f '--peer-auto-tls' \u304c 'false' \u3068\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"--peer-auto-tls=false error: process ID list syntax error Usage: ps [options] Try 'ps --help <simple|list|output|threads|misc|all>' or 'ps --help <s|l|o|t|m|a>' for additional help text. For more details see ps(1). cat: /proc//environ: No such file or directory --peer-auto-tls=false\n"})}),"\n",(0,t.jsx)(r.h3,{id:"27-etcd-\u306b\u5bfe\u3057\u3066\u4e00\u610f\u306e\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u304c\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",children:"2.7 etcd \u306b\u5bfe\u3057\u3066\u4e00\u610f\u306e\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u304c\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n[\u624b\u52d5\u30c6\u30b9\u30c8]\netcd \u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001etcd \u30b5\u30fc\u30d3\u30b9\u7528\u306e\u5c02\u7528\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u305d\u306e\u5f8c\u3001\u30de\u30b9\u30bf\u30fc\u30ce\u30fc\u30c9\u306e etcd \u30dd\u30c3\u30c9\u4ed5\u69d8\u30d5\u30a1\u30a4\u30eb /etc/kubernetes/manifests/etcd.yaml \u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n",(0,t.jsx)(r.code,{children:"--trusted-ca-file=</path/to/ca-file>"})]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u30b9\u30af\u30ea\u30d7\u30c8:"})," ",(0,t.jsx)(r.code,{children:"check_for_k3s_etcd.sh"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001k3s \u304c\u5b9f\u969b\u306b etcd \u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3053\u3068\uff08sqlite3 \u306a\u3069\u306e\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u306f\u306a\u3044\u3053\u3068\uff09\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\n# \u8981\u4ef6\u3092\u78ba\u8a8d\u3059\u308b\u524d\u306b\nset -eE\n\nhandle_error() {\n    echo "false"\n}\n\ntrap \'handle_error\' ERR\n\n\nif [[ "$(journalctl -D /var/log/journal -u k3s | grep \'Managed etcd cluster initializing\' | grep -v grep | wc -l)" -gt 0 ]]; then\n    case $1 in \n        "1.1.11")\n            echo $(stat -c %a /var/lib/rancher/k3s/server/db/etcd);;\n        "1.2.29")\n            echo $(journalctl -D /var/log/journal -u k3s | grep \'Running kube-apiserver\' | tail -n1 | grep \'etcd-\');;\n        "2.1")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.2")\n            echo $(grep -A 5 \'client-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.3")\n            echo $(grep \'auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.4")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep -E \'cert-file|key-file\');;\n        "2.5")\n            echo $(grep -A 5 \'peer-transport-security\' /var/lib/rancher/k3s/server/db/etcd/config | grep \'client-cert-auth\');;\n        "2.6")\n            echo $(grep \'peer-auto-tls\' /var/lib/rancher/k3s/server/db/etcd/config);;\n        "2.7")\n            echo $(grep \'trusted-ca-file\' /var/lib/rancher/k3s/server/db/etcd/config);;\n    esac\nelse\n# \u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b9\u30ad\u30e3\u30f3\u3092\u30d1\u30b9\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u8fd4\u3057\u307e\u3059\n    case $1 in\n        "1.1.11")\n            echo "700";;\n        "1.2.29")\n            echo "--etcd-certfile AND --etcd-keyfile";;\n        "2.1")\n            echo "cert-file AND key-file";;\n        "2.2")\n            echo "--client-cert-auth=true";;\n        "2.3")\n            echo "false";;\n        "2.4")\n            echo "peer-cert-file AND peer-key-file";;\n        "2.5")\n            echo "--client-cert-auth=true";;\n        "2.6")\n            echo "--peer-auto-tls=false";;\n        "2.7")\n            echo "--trusted-ca-file";;\n    esac\nfi\n\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb\u5b9f\u884c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./check_for_k3s_etcd.sh 2.7\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'trusted-ca-file' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"--trusted-ca-file trusted-ca-file: /var/lib/rancher/k3s/server/tls/etcd/server-ca.crt trusted-ca-file: /var/lib/rancher/k3s/server/tls/etcd/peer-ca.crt --trusted-ca-file\n"})}),"\n",(0,t.jsx)(r.h2,{id:"31-\u8a8d\u8a3c\u3068\u8a8d\u53ef",children:"3.1 \u8a8d\u8a3c\u3068\u8a8d\u53ef"}),"\n",(0,t.jsx)(r.h3,{id:"311-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u8a8d\u8a3c\u306f\u30e6\u30fc\u30b6\u30fc\u306b\u5bfe\u3057\u3066\u4f7f\u7528\u3055\u308c\u308b\u3079\u304d\u3067\u306f\u306a\u3044-\u624b\u52d5",children:"3.1.1 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u8a8d\u8a3c\u306f\u30e6\u30fc\u30b6\u30fc\u306b\u5bfe\u3057\u3066\u4f7f\u7528\u3055\u308c\u308b\u3079\u304d\u3067\u306f\u306a\u3044 (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u306e\u4ee3\u308f\u308a\u306b\u3001OIDC \u306e\u4f7f\u7528\u306a\u3069 Kubernetes \u304c\u63d0\u4f9b\u3059\u308b\u4ee3\u66ff\u30e1\u30ab\u30cb\u30ba\u30e0\u3092\u5b9f\u88c5\u3059\u308b\u3079\u304d\u3067\u3059\u3002"]}),"\n",(0,t.jsx)(r.h2,{id:"32-\u30ed\u30ae\u30f3\u30b0",children:"3.2 \u30ed\u30ae\u30f3\u30b0"}),"\n",(0,t.jsx)(r.h3,{id:"321-\u6700\u5c0f\u9650\u306e\u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",children:"3.2.1 \u6700\u5c0f\u9650\u306e\u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30af\u30e9\u30b9\u30bf\u30fc\u7528\u306e\u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kube-apiserver' | tail -n1 | grep 'audit-policy-file'\n"})}),"\n",(0,t.jsx)(r.h3,{id:"322-\u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u304c\u4e3b\u8981\u306a\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u554f\u984c\u3092\u30ab\u30d0\u30fc\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",children:"3.2.2 \u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u304c\u4e3b\u8981\u306a\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u554f\u984c\u3092\u30ab\u30d0\u30fc\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u63d0\u4f9b\u3055\u308c\u308b\u76e3\u67fb\u30dd\u30ea\u30b7\u30fc\u3092\u78ba\u8a8d\u3057\u3001\u5c11\u306a\u304f\u3068\u3082\u4ee5\u4e0b\u306e\u9818\u57df\u3092\u30ab\u30d0\u30fc\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"- \u30af\u30e9\u30b9\u30bf\u30fc\u306b\u3088\u3063\u3066\u7ba1\u7406\u3055\u308c\u308bSecrets\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3002Secrets\u3001ConfigMaps\u3001\u304a\u3088\u3073TokenReviews\u3078\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u306e\u307f\u3092\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b\u3088\u3046\u306b\u6ce8\u610f\u3057\u3001\u6a5f\u5bc6\u30c7\u30fc\u30bf\u306e\u30ed\u30b0\u8a18\u9332\u306e\u30ea\u30b9\u30af\u3092\u907f\u3051\u308b\u3002\n- Pod\u304a\u3088\u3073Deployment\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5909\u66f4\u3002\n- `pods/exec`\u3001`pods/portforward`\u3001`pods/proxy`\u3001\u304a\u3088\u3073`services/proxy`\u306e\u4f7f\u7528\u3002\n\u307b\u3068\u3093\u3069\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5bfe\u3057\u3066\u3001\u6700\u4f4e\u9650\u30e1\u30bf\u30c7\u30fc\u30bf\u30ec\u30d9\u30eb\u3067\u306e\u30ed\u30b0\u8a18\u9332\u304c\u63a8\u5968\u3055\u308c\u308b\uff08\u6700\u3082\u57fa\u672c\u7684\u306a\u30ed\u30b0\u8a18\u9332\u30ec\u30d9\u30eb\uff09\u3002\n\n## 4.1 \u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306e\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\n### 4.1.1 kubelet\u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b: chmod 644 /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\n\n### 4.1.2 kubelet\u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot:root\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09\n\n\n**\u7d50\u679c:** \u8a72\u5f53\u306a\u3057\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b:\nchown root:root /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\n\n### 4.1.3 \u30d7\u30ed\u30ad\u30b7kubeconfig\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3001\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09\n\n\n**\u7d50\u679c:** \u5408\u683c\n\n**\u4fee\u6b63\u65b9\u6cd5:**\n\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b:\nchmod 644 /var/lib/rancher/k3s/agent/kubeproxy.kubeconfig\n\n**\u76e3\u67fb:**\n\n```bash\nstat -c %a /var/lib/rancher/k3s/agent/kubeproxy.kubeconfig\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'permissions'\u304c\u5b58\u5728\u3059\u308b \u307e\u305f\u306f '/var/lib/rancher/k3s/agent/kubeproxy.kubeconfig'\u304c\u5b58\u5728\u3057\u306a\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"644 644\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"414-\u30d7\u30ed\u30ad\u30b7kubeconfig\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:["4.1.4 \u30d7\u30ed\u30ad\u30b7kubeconfig\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3001\u6240\u6709\u8005\u304croot",":root","\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b: chown root",":root"," /var/lib/rancher/k3s/agent/kubeproxy.kubeconfig"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/sh -c 'if test -e /var/lib/rancher/k3s/agent/kubeproxy.kubeconfig; then stat -c %U:%G /var/lib/rancher/k3s/agent/kubeproxy.kubeconfig; fi'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'root:root'\u304c\u5b58\u5728\u3059\u308b \u307e\u305f\u306f '/var/lib/rancher/k3s/agent/kubeproxy.kubeconfig'\u304c\u5b58\u5728\u3057\u306a\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root:root root:root\n"})}),"\n",(0,t.jsx)(r.h3,{id:"415---kubeconfig-kubeletconf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"4.1.5 --kubeconfig kubelet.conf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b:\nchmod 644 /var/lib/rancher/k3s/server/cred/admin.kubeconfig"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"stat -c %a /var/lib/rancher/k3s/agent/kubelet.kubeconfig\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'644'\u304c'644'\u3068\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"644 644\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"416---kubeconfig-kubeletconf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:["4.1.6 --kubeconfig kubelet.conf\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot",":root","\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\uff08\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u57fa\u3065\u304f\uff09\u3002\n\u4f8b:\nchown root",":root"," /var/lib/rancher/k3s/server/cred/admin.kubeconfig"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"stat -c %U:%G /var/lib/rancher/k3s/agent/kubelet.kubeconfig\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'root:root'\u304c'root:root'\u3068\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root:root root:root\n"})}),"\n",(0,t.jsx)(r.h3,{id:"417-\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:"4.1.7 \u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n--client-ca-file\u306e\u30d5\u30a1\u30a4\u30eb\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5909\u66f4\u3059\u308b\u305f\u3081\u306b\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059: ",(0,t.jsx)(r.code,{children:"chmod 644 <filename>"})]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"stat -c %a /var/lib/rancher/k3s/server/tls/server-ca.crt\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'644'\u304c\u5b58\u5728\u3059\u308b \u307e\u305f\u306f '640'\u304c\u5b58\u5728\u3059\u308b \u307e\u305f\u306f '600'\u304c'600'\u3068\u7b49\u3057\u3044 \u307e\u305f\u306f '444'\u304c\u5b58\u5728\u3059\u308b \u307e\u305f\u306f '440'\u304c\u5b58\u5728\u3059\u308b \u307e\u305f\u306f '400'\u304c\u5b58\u5728\u3059\u308b \u307e\u305f\u306f '000'\u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"644 600\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"418-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:["4.1.8 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u8a8d\u8a3c\u5c40\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot",":root","\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n--client-ca-file\u306e\u6240\u6709\u8005\u3092\u5909\u66f4\u3059\u308b\u305f\u3081\u306b\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059:\n",(0,t.jsx)(r.code,{children:"chown root:root <filename>"}),"."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"stat -c %U:%G /var/lib/rancher/k3s/server/tls/client-ca.crt\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'root:root'\u304c'root:root'\u3068\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"root:root root:root\n"})}),"\n",(0,t.jsx)(r.h3,{id:"419-kubelet---config\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"4.1.9 kubelet --config\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u304c644\u307e\u305f\u306f\u305d\u308c\u4ee5\u4e0a\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u76e3\u67fb\u30b9\u30c6\u30c3\u30d7\u3067\u7279\u5b9a\u3055\u308c\u305f\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u3092\u4f7f\u7528\u3057\u3066\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\nchmod 644 /var/lib/kubelet/config.yaml"]}),"\n",(0,t.jsxs)(r.h3,{id:"4110-kubelet---config\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:["4.1.10 kubelet --config\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u6240\u6709\u8005\u304croot",":root","\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u76e3\u67fb\u30b9\u30c6\u30c3\u30d7\u3067\u7279\u5b9a\u3055\u308c\u305f\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u3092\u4f7f\u7528\u3057\u3066\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\nchown root",":root"," /var/lib/kubelet/config.yaml"]}),"\n",(0,t.jsx)(r.h2,{id:"42-kubelet",children:"4.2 Kubelet"}),"\n",(0,t.jsx)(r.h3,{id:"421---anonymous-auth\u5f15\u6570\u304cfalse\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"4.2.1 --anonymous-auth\u5f15\u6570\u304cfalse\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubelet\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066",(0,t.jsx)(r.code,{children:"authentication: anonymous: enabled"}),"\u3092",(0,t.jsx)(r.code,{children:"false"}),"\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u5b9f\u884c\u53ef\u80fd\u306a\u5f15\u6570\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306ekubelet\u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf\u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092KUBELET_SYSTEM_PODS_ARGS\u5909\u6570\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n",(0,t.jsx)(r.code,{children:"--anonymous-auth=false"}),"\n\u30b7\u30b9\u30c6\u30e0\u306b\u57fa\u3065\u3044\u3066\u3001kubelet\u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\u4f8b:\nsystemctl daemon-reload\nsystemctl restart kubelet.service"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'/bin/sh -c \'if test $(journalctl -D /var/log/journal -u k3s | grep "Running kube-apiserver" | wc -l) -gt 0; then journalctl -D /var/log/journal -u k3s | grep "Running kube-apiserver" | tail -n1 | grep "anonymous-auth" | grep -v grep; else echo "--anonymous-auth=false"; fi\'\n'})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--anonymous-auth'\u304c'false'\u3068\u7b49\u3057\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'--anonymous-auth=false Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"422---authorization-mode\u5f15\u6570\u304calwaysallow\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5\u5316",children:"4.2.2 --authorization-mode\u5f15\u6570\u304cAlwaysAllow\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\u5316\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubelet\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066",(0,t.jsx)(r.code,{children:"authorization.mode"}),"\u3092Webhook\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u5b9f\u884c\u53ef\u80fd\u306a\u5f15\u6570\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306ekubelet\u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf\u3092\u7de8\u96c6\u3057\u3001\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092KUBELET_AUTHZ_ARGS\u5909\u6570\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n--authorization-mode=Webhook\n\u30b7\u30b9\u30c6\u30e0\u306b\u57fa\u3065\u3044\u3066\u3001kubelet\u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\u4f8b:\nsystemctl daemon-reload\nsystemctl restart kubelet.service"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'/bin/sh -c \'if test $(journalctl -D /var/log/journal -u k3s | grep "Running kube-apiserver" | wc -l) -gt 0; then journalctl -D /var/log/journal -u k3s | grep "Running kube-apiserver" | tail -n1 | grep "authorization-mode" | grep -v grep; else echo "--authorization-mode=Webhook"; fi\'\n'})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--authorization-mode'\u306b'AlwaysAllow'\u304c\u542b\u307e\u308c\u3066\u3044\u306a\u3044\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u308b\u5024"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'\n```markdown\n--authorization-mode=Webhook Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"423-ensure-that-the---client-ca-file-argument-is-set-as-appropriate-automated",children:"4.2.3 Ensure that the --client-ca-file argument is set as appropriate (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nIf using a Kubelet config file, edit the file to set ",(0,t.jsx)(r.code,{children:"authentication.x509.clientCAFile"})," to\nthe location of the client CA file.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_AUTHZ_ARGS variable.\n",(0,t.jsx)(r.code,{children:"--client-ca-file=<path/to/client-ca-file>"}),"\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'/bin/sh -c \'if test $(journalctl -D /var/log/journal -u k3s | grep "Running kube-apiserver" | wc -l) -gt 0; then journalctl -D /var/log/journal -u k3s | grep "Running kube-apiserver" | tail -n1 | grep "client-ca-file" | grep -v grep; else echo "--client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt"; fi\'\n'})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--client-ca-file' is present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'--client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt Sep 13 13:26:40 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:40Z" level=info msg="Running kube-apiserver --advertise-address=172.31.0.140 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --feature-gates=JobTrackingWithFinalizers=true --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"424-ensure-that-the---read-only-port-argument-is-set-to-0-manual",children:"4.2.4 Ensure that the --read-only-port argument is set to 0 (Manual)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," pass"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nIf using a Kubelet config file, edit the file to set ",(0,t.jsx)(r.code,{children:"readOnlyPort"})," to 0.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_SYSTEM_PODS_ARGS variable.\n--read-only-port=0\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kubelet' | tail -n1 | grep 'read-only-port'\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Expected Result"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--read-only-port' is equal to '0' OR '--read-only-port' is not present\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Returned Value"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:50 k3s-123-cis-pool2-98604672-hr9p5 k3s[1592]: time="2022-09-13T13:26:50Z" level=info msg="Running kubelet --address=0.0.0.0 --anonymous-auth=false --authentication-token-webhook=true --authorization-mode=Webhook --cgroup-driver=systemd --client-ca-file=/var/lib/rancher/k3s/agent/client-ca.crt --cloud-provider=external --cluster-dns=10.43.0.10 --cluster-domain=cluster.local --container-runtime-endpoint=unix:///run/k3s/containerd/containerd.sock --containerd=/run/k3s/containerd/containerd.sock --eviction-hard=imagefs.available<5%,nodefs.available<5% --eviction-minimum-reclaim=imagefs.available=10%,nodefs.available=10% --fail-swap-on=false --healthz-bind-address=127.0.0.1 --hostname-override=k3s-123-cis-pool2-98604672-hr9p5 --kubeconfig=/var/lib/rancher/k3s/agent/kubelet.kubeconfig --node-labels=rke.cattle.io/machine=00c4e7a0-5497-4367-a70c-0b836757eae8 --pod-infra-container-image=rancher/mirrored-pause:3.6 --pod-manifest-path=/var/lib/rancher/k3s/agent/pod-manifests --read-only-port=0 --resolv-conf=/run/systemd/resolve/resolv.conf --serialize-image-pulls=false --tls-cert-file=/var/lib/rancher/k3s/agent/serving-kubelet.crt --tls-private-key-file=/var/lib/rancher/k3s/agent/serving-kubelet.key" Sep 13 13:26:44 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:44Z" level=info msg="Running kubelet --address=0.0.0.0 --anonymous-auth=false --authentication-token-webhook=true --authorization-mode=Webhook --cgroup-driver=systemd --client-ca-file=/var/lib/rancher/k3s/agent/client-ca.crt --cloud-provider=external --cluster-dns=10.43.0.10 --cluster-domain=cluster.local --container-runtime-endpoint=unix:///run/k3s/containerd/containerd.sock --containerd=/run/k3s/containerd/containerd.sock --eviction-hard=imagefs.available<5%,nodefs.available<5% --eviction-minimum-reclaim=imagefs.available=10%,nodefs.available=10% --fail-swap-on=false --healthz-bind-address=127.0.0.1 --hostname-override=k3s-123-cis-pool3-b403f678-bzdg5 --kubeconfig=/var/lib/rancher/k3s/agent/kubelet.kubeconfig --node-labels=rke.cattle.io/machine=109d596c-89f5-4c10-8c7f-6b82a38edd8f --pod-infra-container-image=rancher/mirrored-pause:3.6 --pod-manifest-path=/var/lib/rancher/k3s/agent/pod-manifests --read-only-port=0 --resolv-conf=/run/systemd/resolve/resolv.conf --serialize-image-pulls=false --tls-cert-file=/var/lib/rancher/k3s/agent/serving-kubelet.crt --tls-private-key-file=/var/lib/rancher/k3s/agent/serving-kubelet.key"\n'})}),"\n",(0,t.jsx)(r.h3,{id:"425-ensure-that-the---streaming-connection-idle-timeout-argument-is-not-set-to-0-manual",children:"4.2.5 Ensure that the --streaming-connection-idle-timeout argument is not set to 0 (Manual)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," warn"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nIf using a Kubelet config file, edit the file to set ",(0,t.jsx)(r.code,{children:"streamingConnectionIdleTimeout"})," to a\nvalue other than 0.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_SYSTEM_PODS_ARGS variable.\n--streaming-connection-idle-timeout=5m\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Audit:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kubelet' | tail -n1 | grep 'streaming-connection-idle-timeout'\n"})}),"\n",(0,t.jsx)(r.h3,{id:"426-ensure-that-the---protect-kernel-defaults-argument-is-set-to-true-automated",children:"4.2.6 Ensure that the --protect-kernel-defaults argument is set to true (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," Not Applicable"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Remediation:"}),"\nIf using a Kubelet config file, edit the file to set ",(0,t.jsx)(r.code,{children:"protectKernelDefaults"})," to ",(0,t.jsx)(r.code,{children:"true"}),".\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_SYSTEM_PODS_ARGS variable.\n--protect-kernel-defaults=true\nBased on your system, restart the kubelet service. For example:\nsystemctl daemon-reload\nsystemctl restart kubelet.service"]}),"\n",(0,t.jsx)(r.h3,{id:"427-ensure-that-the---make-iptables-util-chains-argument-is-set-to-true-automated",children:"4.2.7 Ensure that the --make-iptables-util-chains argument is set to true (Automated)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Result:"})," Not Applicable"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Remediation:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"\n\u3082\u3057 Kubelet \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066 `makeIPTablesUtilChains` \u3092 `true` \u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306e kubelet \u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb\n`/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` \u3092\u7de8\u96c6\u3057\u3001\n`KUBELET_SYSTEM_PODS_ARGS` \u5909\u6570\u304b\u3089 `--make-iptables-util-chains` \u5f15\u6570\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u30b7\u30b9\u30c6\u30e0\u306b\u57fa\u3065\u3044\u3066\u3001kubelet \u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\uff1a\n```bash\nsystemctl daemon-reload\nsystemctl restart kubelet.service\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"428---hostname-override-\u5f15\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:["4.2.8 ",(0,t.jsx)(r.code,{children:"--hostname-override"})," \u5f15\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306e kubelet \u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb ",(0,t.jsx)(r.code,{children:"/etc/systemd/system/kubelet.service.d/10-kubeadm.conf"})," \u3092\u7de8\u96c6\u3057\u3001\n",(0,t.jsx)(r.code,{children:"KUBELET_SYSTEM_PODS_ARGS"})," \u5909\u6570\u304b\u3089 ",(0,t.jsx)(r.code,{children:"--hostname-override"})," \u5f15\u6570\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u30b7\u30b9\u30c6\u30e0\u306b\u57fa\u3065\u3044\u3066\u3001kubelet \u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\uff1a"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"systemctl daemon-reload\nsystemctl restart kubelet.service\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"429---event-qps-\u5f15\u6570\u304c-0-\u307e\u305f\u306f\u9069\u5207\u306a\u30a4\u30d9\u30f3\u30c8\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u78ba\u4fdd\u3059\u308b\u30ec\u30d9\u30eb\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:["4.2.9 ",(0,t.jsx)(r.code,{children:"--event-qps"})," \u5f15\u6570\u304c 0 \u307e\u305f\u306f\u9069\u5207\u306a\u30a4\u30d9\u30f3\u30c8\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u78ba\u4fdd\u3059\u308b\u30ec\u30d9\u30eb\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubelet \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066 ",(0,t.jsx)(r.code,{children:"eventRecordQPS"})," \u3092\u9069\u5207\u306a\u30ec\u30d9\u30eb\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306e kubelet \u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb\n",(0,t.jsx)(r.code,{children:"/etc/systemd/system/kubelet.service.d/10-kubeadm.conf"})," \u3092\u7de8\u96c6\u3057\u3001\n\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092 ",(0,t.jsx)(r.code,{children:"KUBELET_SYSTEM_PODS_ARGS"})," \u5909\u6570\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30b7\u30b9\u30c6\u30e0\u306b\u57fa\u3065\u3044\u3066\u3001kubelet \u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\uff1a"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"systemctl daemon-reload\nsystemctl restart kubelet.service\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/ps -fC containerd\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"4210---tls-cert-file-\u304a\u3088\u3073---tls-private-key-file-\u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:["4.2.10 ",(0,t.jsx)(r.code,{children:"--tls-cert-file"})," \u304a\u3088\u3073 ",(0,t.jsx)(r.code,{children:"--tls-private-key-file"})," \u5f15\u6570\u304c\u9069\u5207\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u5408\u683c"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubelet \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066 ",(0,t.jsx)(r.code,{children:"tlsCertFile"})," \u3092\u3053\u306e Kubelet \u3092\u8b58\u5225\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3059\u308b\u8a3c\u660e\u66f8\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u8a2d\u5b9a\u3057\u3001\n",(0,t.jsx)(r.code,{children:"tlsPrivateKeyFile"})," \u3092\u5bfe\u5fdc\u3059\u308b\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306e kubelet \u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb\n",(0,t.jsx)(r.code,{children:"/etc/systemd/system/kubelet.service.d/10-kubeadm.conf"})," \u3092\u7de8\u96c6\u3057\u3001\n\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092 ",(0,t.jsx)(r.code,{children:"KUBELET_CERTIFICATE_ARGS"})," \u5909\u6570\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"--tls-cert-file=<path/to/tls-certificate-file>\n--tls-private-key-file=<path/to/tls-key-file>\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u30b7\u30b9\u30c6\u30e0\u306b\u57fa\u3065\u3044\u3066\u3001kubelet \u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\uff1a"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"systemctl daemon-reload\nsystemctl restart kubelet.service\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"journalctl -D /var/log/journal -u k3s | grep 'Running kubelet' | tail -n1\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u671f\u5f85\u3055\u308c\u308b\u7d50\u679c:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:"'--tls-cert-file' \u304c\u5b58\u5728\u3057\u3001'--tls-private-key-file' \u304c\u5b58\u5728\u3059\u308b\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u8fd4\u3055\u308c\u305f\u5024:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-console",children:'Sep 13 13:26:50 k3s-123-cis-pool2-98604672-hr9p5 k3s[1592]: time="2022-09-13T13:26:50Z" level=info msg="Running kubelet --address=0.0.0.0 --anonymous-auth=false --authentication-token-webhook=true --authorization-mode=Webhook --cgroup-driver=systemd --client-ca-file=/var/lib/rancher/k3s/agent/client-ca.crt --cloud-provider=external --cluster-dns=10.43.0.10 --cluster-domain=cluster.local --container-runtime-endpoint=unix:///run/k3s/containerd/containerd.sock --containerd=/run/k3s/containerd/containerd.sock --eviction-hard=imagefs.available<5%,nodefs.available<5% --eviction-minimum-reclaim=imagefs.available=10%,nodefs.available=10% --fail-swap-on=false --healthz-bind-address=127.0.0.1 --hostname-override=k3s-123-cis-pool2-98604672-hr9p5 --kubeconfig=/var/lib/rancher/k3s/agent/kubelet.kubeconfig --node-labels=rke.cattle.io/machine=00c4e7a0-5497-4367-a70c-0b836757eae8 --pod-infra-container-image=rancher/mirrored-pause:3.6 --pod-manifest-path=/var/lib/rancher/k3s/agent/pod-manifests --read-only-port=0 --resolv-conf=/run/systemd/resolve/resolv.conf --serialize-image-pulls=false --tls-cert-file=/var/lib/rancher/k3s/agent/serving-kubelet.crt --tls-private-key-file=/var/lib/rancher/k3s/agent/serving-kubelet.key" Sep 13 13:26:44 k3s-123-cis-pool3-b403f678-bzdg5 k3s[1600]: time="2022-09-13T13:26:44Z" level=info msg="Running kubelet --address=0.0.0.0 --anonymous-auth=false --authentication-token-webhook=true --authorization-mode=Webhook --cgroup-driver=systemd --client-ca-file=/var/lib/rancher/k3s/agent/client-ca.crt --cloud-provider=external --cluster-dns=10.43.0.10 --cluster-domain=cluster.local --container-runtime-endpoint=unix:///run/k3s/containerd/containerd.sock --containerd=/run/k3s/containerd/containerd.sock --eviction-hard=imagefs.available<5%,nodefs.available<5% --eviction-minimum-reclaim=imagefs.available=10%,nodefs.available=10% --fail-swap-on=false --healthz-bind-address=127.0.0.1 --hostname-override=k3s-123-cis-pool3-b403f678-bzdg5 --kubeconfig=/var/lib/rancher/k3s/agent/kubelet.kubeconfig --node-labels=rke.cattle.io/machine=109d596c-89f5-4c10-8c7f-6b82a38edd8f --pod-infra-container-image=rancher/mirrored-pause:3.6 --pod-manifest-path=/var/lib/rancher/k3s/agent/pod-manifests --read-only-port=0 --resolv-conf=/run/systemd/resolve/resolv.conf --serialize-image-pulls=false --tls-cert-file=/var/lib/rancher/k3s/agent/serving-kubelet.crt --tls-private-key-file=/var/lib/rancher/k3s/agent/serving-kubelet.key"\n'})}),"\n",(0,t.jsxs)(r.h3,{id:"4211---rotate-certificates-\u5f15\u6570\u304c-false-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u81ea\u52d5",children:["4.2.11 ",(0,t.jsx)(r.code,{children:"--rotate-certificates"})," \u5f15\u6570\u304c ",(0,t.jsx)(r.code,{children:"false"})," \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u81ea\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubelet \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066 ",(0,t.jsx)(r.code,{children:"rotateCertificates"})," \u3092 ",(0,t.jsx)(r.code,{children:"true"})," \u306b\u8a2d\u5b9a\u3059\u308b\u304b\u3001\n\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u524a\u9664\u3057\u307e\u3059\u3002\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306e kubelet \u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb\n",(0,t.jsx)(r.code,{children:"/etc/systemd/system/kubelet.service.d/10-kubeadm.conf"})," \u3092\u7de8\u96c6\u3057\u3001\n",(0,t.jsx)(r.code,{children:"KUBELET_CERTIFICATE_ARGS"})," \u5909\u6570\u304b\u3089 ",(0,t.jsx)(r.code,{children:"--rotate-certificates=false"})," \u5f15\u6570\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u30b7\u30b9\u30c6\u30e0\u306b\u57fa\u3065\u3044\u3066\u3001kubelet \u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\uff1a"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"systemctl daemon-reload\nsystemctl restart kubelet.service\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"4212-rotatekubeletservercertificate-\u5f15\u6570\u304c-true-\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:["4.2.12 ",(0,t.jsx)(r.code,{children:"RotateKubeletServerCertificate"})," \u5f15\u6570\u304c ",(0,t.jsx)(r.code,{children:"true"})," \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8a72\u5f53\u306a\u3057"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306e kubelet \u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb ",(0,t.jsx)(r.code,{children:"/etc/systemd/system/kubelet.service.d/10-kubeadm.conf"})," \u3092\u7de8\u96c6\u3057\u3001\n\u4ee5\u4e0b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092 ",(0,t.jsx)(r.code,{children:"KUBELET_CERTIFICATE_ARGS"})," \u5909\u6570\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"--feature-gates=RotateKubeletServerCertificate=true\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u30b7\u30b9\u30c6\u30e0\u306b\u57fa\u3065\u3044\u3066\u3001kubelet \u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\uff1a"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"systemctl daemon-reload\nsystemctl restart kubelet.service\n"})}),"\n",(0,t.jsx)(r.h3,{id:"4213-kubelet-\u304c\u5f37\u529b\u306a\u6697\u53f7\u5316\u30b9\u30a4\u30fc\u30c8\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:"4.2.13 Kubelet \u304c\u5f37\u529b\u306a\u6697\u53f7\u5316\u30b9\u30a4\u30fc\u30c8\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubelet \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066 ",(0,t.jsx)(r.code,{children:"TLSCipherSuites"})," \u3092\n",(0,t.jsx)(r.code,{children:"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256"}),"\n\u307e\u305f\u306f\u3053\u308c\u3089\u306e\u5024\u306e\u30b5\u30d6\u30bb\u30c3\u30c8\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u5b9f\u884c\u53ef\u80fd\u306a\u5f15\u6570\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u5404\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306e kubelet \u30b5\u30fc\u30d3\u30b9\u30d5\u30a1\u30a4\u30eb\n",(0,t.jsx)(r.code,{children:"/etc/systemd/system/kubelet.service.d/10-kubeadm.conf"})," \u3092\u7de8\u96c6\u3057\u3001\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b ",(0,t.jsx)(r.code,{children:"--tls-cipher-suites"})," \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u307e\u305f\u306f\u3053\u308c\u3089\u306e\u5024\u306e\u30b5\u30d6\u30bb\u30c3\u30c8\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u30b7\u30b9\u30c6\u30e0\u306b\u57fa\u3065\u3044\u3066\u3001kubelet \u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\uff1a"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"systemctl daemon-reload\nsystemctl restart kubelet.service\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"\u76e3\u67fb:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"/bin/ps -fC containerd\n"})}),"\n",(0,t.jsx)(r.h2,{id:"51-rbac-\u3068\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8",children:"5.1 RBAC \u3068\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8"}),"\n",(0,t.jsxs)(r.h3,{id:"511-cluster-admin-\u30ed\u30fc\u30eb\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u306e\u307f\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:["5.1.1 ",(0,t.jsx)(r.code,{children:"cluster-admin"})," \u30ed\u30fc\u30eb\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u306e\u307f\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n",(0,t.jsx)(r.code,{children:"cluster-admin"})," \u30ed\u30fc\u30eb\u3078\u306e\u3059\u3079\u3066\u306e ",(0,t.jsx)(r.code,{children:"clusterrolebinding"})," \u3092\u7279\u5b9a\u3057\u307e\u3059\u3002\u305d\u308c\u3089\u304c\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u3001\n\u3053\u306e\u30ed\u30fc\u30eb\u304c\u5fc5\u8981\u304b\u3069\u3046\u304b\u3001\u307e\u305f\u306f\u3088\u308a\u5c11\u306a\u3044\u6a29\u9650\u306e\u30ed\u30fc\u30eb\u3092\u4f7f\u7528\u3067\u304d\u308b\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u53ef\u80fd\u306a\u5834\u5408\u306f\u3001\u307e\u305a\u30e6\u30fc\u30b6\u30fc\u3092\u4f4e\u6a29\u9650\u306e\u30ed\u30fc\u30eb\u306b\u30d0\u30a4\u30f3\u30c9\u3057\u3001\u305d\u306e\u5f8c ",(0,t.jsx)(r.code,{children:"cluster-admin"})," \u30ed\u30fc\u30eb\u3078\u306e ",(0,t.jsx)(r.code,{children:"clusterrolebinding"})," \u3092\u524a\u9664\u3057\u307e\u3059\uff1a"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"kubectl delete clusterrolebinding [name]\n"})}),"\n",(0,t.jsx)(r.h3,{id:"512-\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u624b\u52d5",children:"5.1.2 \u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u53ef\u80fd\u306a\u5834\u5408\u306f\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3078\u306e ",(0,t.jsx)(r.code,{children:"get"}),"\u3001",(0,t.jsx)(r.code,{children:"list"}),"\u3001\u304a\u3088\u3073 ",(0,t.jsx)(r.code,{children:"watch"})," \u30a2\u30af\u30bb\u30b9\u3092\u524a\u9664\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"513-\u30ed\u30fc\u30eb\u304a\u3088\u3073\u30af\u30e9\u30b9\u30bf\u30fc\u30ed\u30fc\u30eb\u3067\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306e\u4f7f\u7528\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u624b\u52d5",children:"5.1.3 \u30ed\u30fc\u30eb\u304a\u3088\u3073\u30af\u30e9\u30b9\u30bf\u30fc\u30ed\u30fc\u30eb\u3067\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306e\u4f7f\u7528\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u53ef\u80fd\u306a\u5834\u5408\u306f\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u30ed\u30fc\u30eb\u304a\u3088\u3073\u30ed\u30fc\u30eb\u3067\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306e\u4f7f\u7528\u3092\u7279\u5b9a\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u307e\u305f\u306f\u30a2\u30af\u30b7\u30e7\u30f3\u306b\u7f6e\u304d\u63db\u3048\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"514-\u30dd\u30c3\u30c9\u306e\u4f5c\u6210\u30a2\u30af\u30bb\u30b9\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u624b\u52d5",children:"5.1.4 \u30dd\u30c3\u30c9\u306e\u4f5c\u6210\u30a2\u30af\u30bb\u30b9\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u53ef\u80fd\u306a\u5834\u5408\u306f\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u30dd\u30c3\u30c9\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3078\u306e\u4f5c\u6210\u30a2\u30af\u30bb\u30b9\u3092\u524a\u9664\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"515-\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u7a4d\u6975\u7684\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:"5.1.5 \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u7a4d\u6975\u7684\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes \u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u304c Kubernetes API \u30b5\u30fc\u30d0\u30fc\u3078\u306e\u7279\u5b9a\u306e\u30a2\u30af\u30bb\u30b9\u3092\u5fc5\u8981\u3068\u3059\u308b\u5834\u5408\u306f\u3001\u660e\u793a\u7684\u306a\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u5404\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u3066\u3001\u3053\u306e\u5024\u3092\u542b\u3081\u307e\u3059\uff1a"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"automountServiceAccountToken: false\n"})}),"\n",(0,t.jsx)(r.h3,{id:"516-\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u30c8\u30fc\u30af\u30f3\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u306e\u307f\u30de\u30a6\u30f3\u30c8\u3055\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:"5.1.6 \u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u30c8\u30fc\u30af\u30f3\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u306e\u307f\u30de\u30a6\u30f3\u30c8\u3055\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u30c8\u30fc\u30af\u30f3\u3092\u30de\u30a6\u30f3\u30c8\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u30dd\u30c3\u30c9\u304a\u3088\u3073\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u5b9a\u7fa9\u3092\u5909\u66f4\u3057\u3066\u7121\u52b9\u306b\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsxs)(r.h3,{id:"517-systemmasters-\u30b0\u30eb\u30fc\u30d7\u306e\u4f7f\u7528\u3092\u907f\u3051\u308b\u624b\u52d5",children:["5.1.7 ",(0,t.jsx)(r.code,{children:"system:masters"})," \u30b0\u30eb\u30fc\u30d7\u306e\u4f7f\u7528\u3092\u907f\u3051\u308b\uff08\u624b\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u3059\u3079\u3066\u306e\u30e6\u30fc\u30b6\u30fc\u304b\u3089 ",(0,t.jsx)(r.code,{children:"system:masters"})," \u30b0\u30eb\u30fc\u30d7\u3092\u524a\u9664\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsxs)(r.h3,{id:"518-kubernetes-\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u3067\u306e-bindimpersonate\u304a\u3088\u3073-escalate-\u6a29\u9650\u306e\u4f7f\u7528\u3092\u5236\u9650\u3059\u308b\u624b\u52d5",children:["5.1.8 Kubernetes \u30af\u30e9\u30b9\u30bf\u30fc\u5185\u3067\u306e ",(0,t.jsx)(r.code,{children:"Bind"}),"\u3001",(0,t.jsx)(r.code,{children:"Impersonate"}),"\u3001\u304a\u3088\u3073 ",(0,t.jsx)(r.code,{children:"Escalate"})," \u6a29\u9650\u306e\u4f7f\u7528\u3092\u5236\u9650\u3059\u308b\uff08\u624b\u52d5\uff09"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u53ef\u80fd\u306a\u5834\u5408\u306f\u3001",(0,t.jsx)(r.code,{children:"impersonate"}),"\u3001",(0,t.jsx)(r.code,{children:"bind"}),"\u3001\u304a\u3088\u3073 ",(0,t.jsx)(r.code,{children:"escalate"})," \u6a29\u9650\u3092\u30b5\u30d6\u30b8\u30a7\u30af\u30c8\u304b\u3089\u524a\u9664\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h2,{id:"52-\u30dd\u30c3\u30c9\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u57fa\u6e96",children:"5.2 \u30dd\u30c3\u30c9\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u57fa\u6e96"}),"\n",(0,t.jsx)(r.h3,{id:"521-\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u5c11\u306a\u304f\u3068\u30821\u3064\u306e\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u30dd\u30ea\u30b7\u30fc\u5236\u5fa1\u30e1\u30ab\u30cb\u30ba\u30e0\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u624b\u52d5",children:"5.2.1 \u30af\u30e9\u30b9\u30bf\u30fc\u306b\u5c11\u306a\u304f\u3068\u30821\u3064\u306e\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u30dd\u30ea\u30b7\u30fc\u5236\u5fa1\u30e1\u30ab\u30cb\u30ba\u30e0\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\uff08\u624b\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u3092\u542b\u3080\u3059\u3079\u3066\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u5bfe\u3057\u3066\u3001Pod Security Admission \u307e\u305f\u306f\u5916\u90e8\u30dd\u30ea\u30b7\u30fc\u5236\u5fa1\u30b7\u30b9\u30c6\u30e0\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"522-\u7279\u6a29\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u81ea\u52d5",children:"5.2.2 \u7279\u6a29\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u81ea\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u3092\u542b\u3080\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3066\u3001\n\u7279\u6a29\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u5236\u9650\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"523-\u30db\u30b9\u30c8\u30d7\u30ed\u30bb\u30b9id\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u81ea\u52d5",children:"5.2.3 \u30db\u30b9\u30c8\u30d7\u30ed\u30bb\u30b9ID\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u81ea\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u3092\u542b\u3080\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3066\u3001\n",(0,t.jsx)(r.code,{children:"hostPID"})," \u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u5236\u9650\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"524-\u30db\u30b9\u30c8ipc\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\u81ea\u52d5",children:"5.2.4 \u30db\u30b9\u30c8IPC\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b\uff08\u81ea\u52d5\uff09"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u3092\u542b\u3080\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3066\u3001\n",(0,t.jsx)(r.code,{children:"hostIPC"})," \u30b3\u30f3\u30c6\u30ca\u306e\u8a31\u53ef\u3092\u5236\u9650\u3057\u307e\u3059\u3002\n",(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u306e\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u304c\u3042\u308b\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3001",(0,t.jsx)(r.code,{children:"hostIPC"}),"\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5236\u9650\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"525-\u30db\u30b9\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",children:"5.2.5 \u30db\u30b9\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u5171\u6709\u3057\u3088\u3046\u3068\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u306e\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u304c\u3042\u308b\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3001",(0,t.jsx)(r.code,{children:"hostNetwork"}),"\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5236\u9650\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"526-allowprivilegeescalation\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",children:"5.2.6 allowPrivilegeEscalation\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u306e\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u304c\u3042\u308b\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3001",(0,t.jsx)(r.code,{children:".spec.allowPrivilegeEscalation"}),"\u304c",(0,t.jsx)(r.code,{children:"true"}),"\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5236\u9650\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"527-\u30eb\u30fc\u30c8\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",children:"5.2.7 \u30eb\u30fc\u30c8\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u4f5c\u6210\u3057\u3001",(0,t.jsx)(r.code,{children:"MustRunAsNonRoot"}),"\u307e\u305f\u306fUID\u306e\u7bc4\u56f2\u306b0\u3092\u542b\u307e\u306a\u3044",(0,t.jsx)(r.code,{children:"MustRunAs"}),"\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"528-net_raw\u6a5f\u80fd\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",children:"5.2.8 NET_RAW\u6a5f\u80fd\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u306e\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u304c\u3042\u308b\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3001",(0,t.jsx)(r.code,{children:"NET_RAW"}),"\u6a5f\u80fd\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5236\u9650\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"529-\u8ffd\u52a0\u3055\u308c\u305f\u6a5f\u80fd\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u81ea\u52d5\u5316",children:"5.2.9 \u8ffd\u52a0\u3055\u308c\u305f\u6a5f\u80fd\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u81ea\u52d5\u5316)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n",(0,t.jsx)(r.code,{children:"allowedCapabilities"}),"\u304c\u7a7a\u306e\u914d\u5217\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u9650\u308a\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u306e\u30dd\u30ea\u30b7\u30fc\u306b\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"5210-\u6a5f\u80fd\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u624b\u52d5",children:"5.2.10 \u6a5f\u80fd\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30af\u30e9\u30b9\u30bf\u30fc\u4e0a\u3067\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u6a5f\u80fd\u306e\u4f7f\u7528\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306bLinux\u6a5f\u80fd\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u3059\u3079\u3066\u306e\u6a5f\u80fd\u3092\u524a\u9664\u3057\u306a\u3044\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u7981\u6b62\u3059\u308bPSP\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3092\u691c\u8a0e\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"5211-windows-hostprocess\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u624b\u52d5",children:"5.2.11 Windows HostProcess\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u306e\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u304c\u3042\u308b\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3001",(0,t.jsx)(r.code,{children:".securityContext.windowsOptions.hostProcess"}),"\u304c",(0,t.jsx)(r.code,{children:"true"}),"\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5236\u9650\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"5212-hostpath\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u624b\u52d5",children:"5.2.12 HostPath\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u306e\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u304c\u3042\u308b\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3001",(0,t.jsx)(r.code,{children:"hostPath"}),"\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u6301\u3064\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5236\u9650\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"5213-hostports\u3092\u4f7f\u7528\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b-\u624b\u52d5",children:"5.2.13 HostPorts\u3092\u4f7f\u7528\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u6700\u5c0f\u9650\u306b\u6291\u3048\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30e6\u30fc\u30b6\u30fc\u306e\u30ef\u30fc\u30af\u30ed\u30fc\u30c9\u304c\u3042\u308b\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u5404\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u8ffd\u52a0\u3057\u3001",(0,t.jsx)(r.code,{children:"hostPort"}),"\u30bb\u30af\u30b7\u30e7\u30f3\u3092\u4f7f\u7528\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5236\u9650\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h2,{id:"53-\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u3068cni",children:"5.3 \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u3068CNI"}),"\n",(0,t.jsx)(r.h3,{id:"531-\u4f7f\u7528\u4e2d\u306ecni\u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",children:"5.3.1 \u4f7f\u7528\u4e2d\u306eCNI\u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u4f7f\u7528\u4e2d\u306eCNI\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u5225\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u7528\u3059\u308b\u304b\u3001Kubernetes\u30af\u30e9\u30b9\u30bf\u30fc\u5185\u306e\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u3092\u5236\u9650\u3059\u308b\u305f\u3081\u306e\u4ee3\u66ff\u30e1\u30ab\u30cb\u30ba\u30e0\u3092\u691c\u8a0e\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"532-\u3059\u3079\u3066\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",children:"5.3.2 \u3059\u3079\u3066\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30ea\u30b7\u30fc\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066NetworkPolicy\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h2,{id:"54-\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u7ba1\u7406",children:"5.4 \u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u7ba1\u7406"}),"\n",(0,t.jsx)(r.h3,{id:"541-\u74b0\u5883\u5909\u6570\u3068\u3057\u3066\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3088\u308a\u3082\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u63a8\u5968\u3059\u308b-\u624b\u52d5",children:"5.4.1 \u74b0\u5883\u5909\u6570\u3068\u3057\u3066\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3088\u308a\u3082\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u63a8\u5968\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u53ef\u80fd\u3067\u3042\u308c\u3070\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u3092\u5909\u66f4\u3057\u3066\u3001\u74b0\u5883\u5909\u6570\u3067\u306f\u306a\u304f\u30de\u30a6\u30f3\u30c8\u3055\u308c\u305f\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092\u8aad\u307f\u53d6\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"542-\u5916\u90e8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u691c\u8a0e\u3059\u308b-\u624b\u52d5",children:"5.4.2 \u5916\u90e8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u691c\u8a0e\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30af\u30e9\u30a6\u30c9\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3084\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u7ba1\u7406\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u304c\u63d0\u4f9b\u3059\u308b\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u7ba1\u7406\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u53c2\u7167\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h2,{id:"55-\u62e1\u5f35\u53ef\u80fd\u306a\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb",children:"5.5 \u62e1\u5f35\u53ef\u80fd\u306a\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb"}),"\n",(0,t.jsx)(r.h3,{id:"551-imagepolicywebhook\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u3092\u4f7f\u7528\u3057\u3066\u30a4\u30e1\u30fc\u30b8\u306e\u51fa\u6240\u3092\u8a2d\u5b9a\u3059\u308b-\u624b\u52d5",children:"5.5.1 ImagePolicyWebhook\u30a2\u30c9\u30df\u30c3\u30b7\u30e7\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u3092\u4f7f\u7528\u3057\u3066\u30a4\u30e1\u30fc\u30b8\u306e\u51fa\u6240\u3092\u8a2d\u5b9a\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001\u30a4\u30e1\u30fc\u30b8\u306e\u51fa\u6240\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h2,{id:"57-\u4e00\u822c\u7684\u306a\u30dd\u30ea\u30b7\u30fc",children:"5.7 \u4e00\u822c\u7684\u306a\u30dd\u30ea\u30b7\u30fc"}),"\n",(0,t.jsx)(r.h3,{id:"571-\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u9593\u306b\u7ba1\u7406\u5883\u754c\u3092\u4f5c\u6210\u3059\u308b-\u624b\u52d5",children:"5.7.1 \u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u9593\u306b\u7ba1\u7406\u5883\u754c\u3092\u4f5c\u6210\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001\u30c7\u30d7\u30ed\u30a4\u30e1\u30f3\u30c8\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5fc5\u8981\u306a\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"572-pod\u5b9a\u7fa9\u3067seccomp\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304cdockerdefault\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b-\u624b\u52d5",children:"5.7.2 Pod\u5b9a\u7fa9\u3067seccomp\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304cdocker/default\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\n",(0,t.jsx)(r.code,{children:"securityContext"}),"\u3092\u4f7f\u7528\u3057\u3066\u3001Pod\u5b9a\u7fa9\u3067docker/default seccomp\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306f\u305d\u306e\u4f8b\u3067\u3059\uff1a\nsecurityContext:\nseccompProfile:\ntype: RuntimeDefault"]}),"\n",(0,t.jsx)(r.h3,{id:"573-pod\u304a\u3088\u3073\u30b3\u30f3\u30c6\u30ca\u306bsecuritycontext\u3092\u9069\u7528\u3059\u308b-\u624b\u52d5",children:"5.7.3 Pod\u304a\u3088\u3073\u30b3\u30f3\u30c6\u30ca\u306bSecurityContext\u3092\u9069\u7528\u3059\u308b (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3044\u3001Pod\u306bSecurityContext\u3092\u9069\u7528\u3057\u307e\u3059\u3002\u63a8\u5968\u3055\u308c\u308bSecurityContext\u306e\u30ea\u30b9\u30c8\u306b\u3064\u3044\u3066\u306f\u3001CIS Security Benchmark for Docker Containers\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"574-\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306f\u4f7f\u7528\u3057\u306a\u3044-\u624b\u52d5",children:"5.7.4 \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306f\u4f7f\u7528\u3057\u306a\u3044 (\u624b\u52d5)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u7d50\u679c:"})," \u8b66\u544a"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u4fee\u6b63\u65b9\u6cd5:"}),"\nKubernetes\u30ea\u30bd\u30fc\u30b9\u306e\u9069\u5207\u306a\u5206\u96e2\u3092\u53ef\u80fd\u306b\u3059\u308b\u305f\u3081\u306b\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3001\u3059\u3079\u3066\u306e\u65b0\u3057\u3044\u30ea\u30bd\u30fc\u30b9\u304c\u7279\u5b9a\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u4f5c\u6210\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002"]})]})}function h(e={}){const{wrapper:r}={...(0,c.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,r,s)=>{s.d(r,{R:()=>a,x:()=>i});var n=s(96540);const t={},c=n.createContext(t);function a(e){const r=n.useContext(c);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),n.createElement(c.Provider,{value:r},e.children)}}}]);