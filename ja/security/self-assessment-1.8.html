<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-security/self-assessment-1.8" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">CIS 1.8 セルフアセスメントガイド | K3s</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.k3s.io/ja/security/self-assessment-1.8"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" property="og:locale:alternate" content="kr"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="CIS 1.8 セルフアセスメントガイド | K3s"><meta data-rh="true" name="description" content="概要"><meta data-rh="true" property="og:description" content="概要"><link data-rh="true" rel="icon" href="/ja/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.k3s.io/ja/security/self-assessment-1.8"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/security/self-assessment-1.8" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/zh/security/self-assessment-1.8" hreflang="zh"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/kr/security/self-assessment-1.8" hreflang="kr"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/ja/security/self-assessment-1.8" hreflang="ja"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/security/self-assessment-1.8" hreflang="x-default"><link rel="stylesheet" href="/ja/assets/css/styles.15638059.css">
<script src="/ja/assets/js/runtime~main.1af520aa.js" defer="defer"></script>
<script src="/ja/assets/js/main.b7feabc5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="ナビゲーション" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ナビゲーションバーを開く" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ja/"><div class="navbar__logo"><img src="/ja/img/k3s-logo-light.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ja/img/k3s-logo-dark.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>日本語</a><ul class="dropdown__menu"><li><a href="/security/self-assessment-1.8" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh/security/self-assessment-1.8" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li><li><a href="/kr/security/self-assessment-1.8" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="kr">한국어</a></li><li><a href="/ja/security/self-assessment-1.8" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">日本語</a></li></ul></div><a href="https://github.com/k3s-io/k3s/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn">GitHub</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ダークモードを切り替える(現在はライトモード)" aria-label="ダークモードを切り替える(現在はライトモード)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ドキュメントのサイドバー" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/">K3s - 軽量なKubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/quick-start">クイックスタートガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ja/installation">Installation</a><button aria-label="&#x27;Installation&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ja/datastore">Cluster Datastore</a><button aria-label="&#x27;Cluster Datastore&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ja/upgrades">Upgrades</a><button aria-label="&#x27;Upgrades&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/ja/security">Security</a><button aria-label="&#x27;Security&#x27;の目次を隠す" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/security/secrets-encryption">secretの暗号化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/security/hardening-guide">CIS ハードニングガイド</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ja/security/self-assessment-1.8">CIS 1.8 セルフアセスメントガイド</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/security/self-assessment-1.7">CIS 1.7 セルフアセスメントガイド</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/security/self-assessment-1.24">CIS 1.24 自己評価ガイド</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ja/cli">CLI Tools</a><button aria-label="&#x27;CLI Tools&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/architecture">アーキテクチャ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/cluster-access">クラスターアクセス</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/storage">ボリュームとストレージ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ja/networking">Networking</a><button aria-label="&#x27;Networking&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/helm">Helm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/advanced">高度なオプション / 設定</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/ja/reference/env-variables">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/ja/release-notes/v1.30.X">Release Notes</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/related-projects">関連プロジェクト</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/known-issues">既知の問題</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/faq">FAQ</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/ja/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/ja/security"><span itemprop="name">Security</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">CIS 1.8 セルフアセスメントガイド</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>CIS 1.8 セルフアセスメントガイド</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="概要">概要<a href="#概要" class="hash-link" aria-label="概要 への直接リンク" title="概要 への直接リンク">​</a></h2>
<p>このドキュメントは<a href="/ja/security/hardening-guide">K3sセキュリティ強化ガイド</a>の補足資料です。強化ガイドはK3sの本番インストールを強化するための具体的なガイダンスを提供し、このベンチマークガイドはCIS Kubernetesベンチマークの各コントロールに対して強化されたクラスターのセキュリティレベルを評価するのに役立ちます。K3sのオペレーター、セキュリティチーム、監査人、意思決定者が使用することを目的としています。</p>
<p>このガイドはK3sの<strong>v1.27-v1.29</strong>リリースラインおよびCIS Kubernetesベンチマークの<strong>v1.8</strong>リリースに特化しています。</p>
<p>各コントロールの詳細な説明やテスト失敗時の修正方法については、CIS Kubernetesベンチマークv1.8の該当セクションを参照してください。ベンチマークは、無料アカウントを作成後に<a href="https://www.cisecurity.org/benchmark/kubernetes" target="_blank" rel="noopener noreferrer">Center for Internet Security (CIS)</a>からダウンロードできます。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="コントロールテストの方法論">コントロールテストの方法論<a href="#コントロールテストの方法論" class="hash-link" aria-label="コントロールテストの方法論  への直接リンク" title="コントロールテストの方法論 への直接リンク">​</a></h3>
<p>CIS Kubernetesベンチマークの各コントロールは、付随する強化ガイドに従って設定されたK3sクラスターに対して評価されました。</p>
<p>コントロール監査が元のCISベンチマークと異なる場合、K3sに特化した監査コマンドがテスト用に提供されています。</p>
<p>各コントロールの結果は以下の通りです：</p>
<ul>
<li><strong>合格</strong> - テスト対象のK3sクラスターがベンチマークに記載された監査に合格しました。</li>
<li><strong>該当なし</strong> - コントロールはK3sの設計上適用されません。修正セクションでその理由を説明します。</li>
<li><strong>警告</strong> - コントロールはCISベンチマークで手動とされており、クラスターの使用ケースやその他の要因に依存します。これらのコントロールはK3sがその実装を妨げないことを確認するために評価されていますが、テスト対象のクラスターのさらなる設定や監査は行われていません。</li>
</ul>
<p>このガイドは、K3sがSystemdユニットとして実行されていることを前提としています。インストール方法が異なる場合は、「監査」コマンドをシナリオに合わせて調整する必要があります。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>注記</div><div class="admonitionContent_BuS1"><p>このガイドでは、<code>scored</code>テスト、つまり<code>自動化</code>テストのみを対象としています。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="11-コントロールプレーンノードの設定ファイル">1.1 コントロールプレーンノードの設定ファイル<a href="#11-コントロールプレーンノードの設定ファイル" class="hash-link" aria-label="1.1 コントロールプレーンノードの設定ファイル への直接リンク" title="1.1 コントロールプレーンノードの設定ファイル への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="111-apiサーバーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化">1.1.1 APIサーバーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化）<a href="#111-apiサーバーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="1.1.1 APIサーバーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="1.1.1 APIサーバーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chmod 600 /etc/kubernetes/manifests/kube-apiserver.yaml
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="112-apiサーバーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化">1.1.2 APIサーバーポッド仕様ファイルの所有者がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#112-apiサーバーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化" class="hash-link" aria-label="112-apiサーバーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク" title="112-apiサーバーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chown root<!-- -->:root<!-- --> /etc/kubernetes/manifests/kube-apiserver.yaml
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="113-コントローラーマネージャーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化">1.1.3 コントローラーマネージャーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化）<a href="#113-コントローラーマネージャーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="1.1.3 コントローラーマネージャーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="1.1.3 コントローラーマネージャーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chmod 600 /etc/kubernetes/manifests/kube-controller-manager.yaml
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="114-コントローラーマネージャーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化">1.1.4 コントローラーマネージャーポッド仕様ファイルの所有者がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#114-コントローラーマネージャーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化" class="hash-link" aria-label="114-コントローラーマネージャーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク" title="114-コントローラーマネージャーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chown root<!-- -->:root<!-- --> /etc/kubernetes/manifests/kube-controller-manager.yaml
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="115-スケジューラーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化">1.1.5 スケジューラーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化）<a href="#115-スケジューラーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="1.1.5 ス  ケジューラーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="1.1.5 スケジューラーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chmod 600 /etc/kubernetes/manifests/kube-scheduler.yaml
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="116-スケジューラーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化">1.1.6 スケジューラーポッド仕様ファイルの所有者がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#116-スケジューラーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化" class="hash-link" aria-label="116-スケジューラーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク" title="116-スケジューラーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chown root<!-- -->:root<!-- --> /etc/kubernetes/manifests/kube-scheduler.yaml
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="117-etcdポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化">1.1.7 etcdポッド仕様ファイルの権限が600以上の制限に設定されて いることを確認する（自動化）<a href="#117-etcdポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="1.1.7 etcdポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="1.1.7 etcdポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chmod 600 /etc/kubernetes/manifests/etcd.yaml
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="118-etcdポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化">1.1.8 etcdポッド仕様ファイルの所有者がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#118-etcdポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化" class="hash-link" aria-label="118-etcdポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク" title="118-etcdポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chown root<!-- -->:root<!-- --> /etc/kubernetes/manifests/etcd.yaml
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="119-コンテナネットワークインターフェイスファイルの権限が600以上の制限に設定されていることを 確認する自動化">1.1.9 コンテナネットワークインターフェイスファイルの権限が600以上の制限に設定されていることを確認する（自動化）<a href="#119-コンテナネットワークインターフェイスファイルの権限が600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="1.1.9 コンテナネットワークインターフェイスファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="1.1.9 コンテナネットワークインターフェイスファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chmod 600 &lt;path/to/cni/files&gt;
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1110-コンテナネットワークインターフェイスファイルの所有者がrootに設定されていることを確認する手動">1.1.10 コンテナネットワークインターフェイスファイルの所有者がroot<!-- -->:root<!-- -->に設定されていることを確認する（手動）<a href="#1110-コンテナネットワークインターフェイスファイルの所有者がrootに設定されていることを確認する手動" class="hash-link" aria-label="1110-コンテナネットワークインターフェイスファイルの所有者がrootに設定されていることを確認する手動 への直接リンク" title="1110-コンテナネットワークインターフェイスファイルの所有者がrootに設定されていることを確認する手動 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロー  ルプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chown root<!-- -->:root<!-- --> &lt;path/to/cni/files&gt;
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1111-etcdデータディレクトリの権限が700以上の制限に設定されていることを確認する自動化">1.1.11 etcdデータディレクトリの権限が700以上の制限に設定されていることを確認する（自動化）<a href="#1111-etcdデータディレクトリの権限が700以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="1.1.11 etcdデータディレクトリの権限が700以上の制限に設定されていることを確認する（自動化） への直接リンク" title="1.1.11 etcdデータディレクトリの権限が700以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">stat -c %a /var/lib/rancher/k3s/server/db/etcd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;700&#x27; が &#x27;700&#x27; と等しい</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">700</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1112-etcdデータディレクトリの所有者がetcdに設定されていることを確認する自動化">1.1.12 etcdデータディレクトリの所有者がetcd<!-- -->:etcd<!-- -->に設定されていることを確認する（自動化）<a href="#1112-etcdデータディレクトリの所有者がetcdに設定されていることを確認する自動化" class="hash-link" aria-label="1112-etcdデータディレクトリの所有者がetcdに設定されていることを確認する自動化 への直接リンク" title="1112-etcdデータディレクトリの所有者がetcdに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
etcdサーバーノードで、コマンド &#x27;ps -ef | grep etcd&#x27; から引数 --data-dir として渡されるetcdデータディレクトリを取得します。
上記で見つかったetcdデータディレクトリに基づいて以下のコマンドを実行します。
例: chown etcd<!-- -->:etcd<!-- --> /var/lib/etcd
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1113-adminconfファイルの権限が600以上の制限に設定されていることを確認する自動化">1.1.13 admin.confファイルの権限が600以上の制限に設定されていることを確認する（自動化）<a href="#1113-adminconfファイルの権限が600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="1.1.13 admin.confファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="1.1.13 admin.confファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: chmod 600 /var/lib/rancher/k3s/server/cred/admin.kubeconfig</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1114-adminconfファイルの所有者がrootに設定されていることを確認する自動化">1.1.14 admin.confファイルの所有者がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#1114-adminconfファイルの所有者がrootに設定されていることを確認する自動化" class="hash-link" aria-label="1114-adminconfファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク" title="1114-adminconfファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test -e /var/lib/rancher/k3s/server/cred/admin.kubeconfig; then stat -c %U:%G /var/lib/rancher/k3s/server/cred/admin.kubeconfig; fi&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;root<!-- -->:root<!-- -->&#x27; が &#x27;root<!-- -->:root<!-- -->&#x27; と等しい</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root:root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1115-schedulerconfファイルの権限が600以上の制限に設定されていることを確認する自動化">1.1.15 scheduler.confファイルの権限が600以上の制限に設定されていることを確認する（自動化）<a href="#1115-schedulerconfファイルの権限が600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="1.1.15 scheduler.confファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="1.1.15 scheduler.confファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test -e /var/lib/rancher/k3s/server/cred/scheduler.kubeconfig; then stat -c permissions=%a /var/lib/rancher/k3s/server/cred/scheduler.kubeconfig; fi&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> permissionsが600であり、600以上の制限が期待される</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1116-schedulerconfファイルの所有者がrootに設定されていることを確認する自動化">1.1.16 scheduler.confファイルの所有者がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#1116-schedulerconfファイルの所有者がrootに設定されていることを確認する自動化" class="hash-link" aria-label="1116-schedulerconfファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク" title="1116-schedulerconfファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test -e /var/lib/rancher/k3s/server/cred/scheduler.kubeconfig; then stat -c %U:%G /var/lib/rancher/k3s/server/cred/scheduler.kubeconfig; fi&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;root<!-- -->:root<!-- -->&#x27; が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root:root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1117-controller-managerconfファイルの権限が600以上の制限に設定されていることを確認する自動化">1.1.17 controller-manager.confファイルの権限が600以上の制限に設定されていることを確認する（自動化）<a href="#1117-controller-managerconfファイルの権限が600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="1.1.17 controller-manager.confファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="1.1.17 controller-manager.confファイルの権限が600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test -e /var/lib/rancher/k3s/server/cred/controller.kubeconfig; then stat -c permissions=%a /var/lib/rancher/k3s/server/cred/controller.kubeconfig; fi&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> permissionsが600であり、600以上の制限が期待される</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1118-controller-managerconfファイルの所有者がrootに設定されていることを確認する自動化">1.1.18 controller-manager.confファイルの所有者がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#1118-controller-managerconfファイルの所有者がrootに設定されていることを確認する自動化" class="hash-link" aria-label="1118-controller-managerconfファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク" title="1118-controller-managerconfファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">stat -c %U:%G /var/lib/rancher/k3s/server/cred/controller.kubeconfig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;root<!-- -->:root<!-- -->&#x27; が &#x27;root<!-- -->:root<!-- -->&#x27; と等しい</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root:root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1119-kubernetes-pkiディレクトリおよびファイルの所有者がrootに設定されていることを確認する自動化">1.1.19 Kubernetes PKIディレクトリおよびファイルの所有者がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#1119-kubernetes-pkiディレクトリおよびファイルの所有者がrootに設定されていることを確認する自動化" class="hash-link" aria-label="1119-kubernetes-pkiディレクトリおよびファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク" title="1119-kubernetes-pkiディレクトリおよびファイルの所有者がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">stat -c %U:%G /var/lib/rancher/k3s/server/tls</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;root<!-- -->:root<!-- -->&#x27; が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root:root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1120-kubernetes-pki証明書ファイルの権限が600以上の制限に設定されていることを確認する手動">1.1.20 Kubernetes PKI証明書ファイルの権限が600以上の制限に設定されていることを確認する（手動）<a href="#1120-kubernetes-pki証明書ファイルの権限が600以上の制限に設定されていることを確認する手動" class="hash-link" aria-label="1.1.20 Kubernetes PKI証明書ファイルの権限が600以上の制限に設定されていることを確認する（手動） への直接リンク" title="1.1.20 Kubernetes PKI証明書ファイルの権限が600以上の制限に設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 警告</p>
<p><strong>修正方法:</strong>
マスターノードで以下のコマンドを実行します（システム上のファイルの場所に基づく）。
例: find /var/lib/rancher/k3s/server/tls/ -type f -name &#x27;*.crt&#x27; -exec chmod -v 600 <!-- --> +</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1121-kubernetes-pkiキーのファイル権限が600に設定されていることを確認する手動">1.1.21 Kubernetes PKIキーのファイル権限が600に設定されていることを確認する（手動）<a href="#1121-kubernetes-pkiキーのファイル権限が600に設定されていることを確認する手動" class="hash-link" aria-label="1.1.21 Kubernetes PKIキーのファイル権限が600に設定されていることを確認する（手動） への直接リンク" title="1.1.21 Kubernetes PKIキーのファイル権限が600に設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">find /var/lib/rancher/k3s/server/tls/ -type f -name &#x27;*.key&#x27; | xargs stat -c permissions=%a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> permissionsが600であり、600以上の制限が期待される</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="12-apiサーバー">1.2 APIサーバー<a href="#12-apiサーバー" class="hash-link" aria-label="1.2 APIサーバー への直接リンク" title="1.2 APIサーバー への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="121---anonymous-auth-引数が-false-に設定されていることを確認する手動">1.2.1 --anonymous-auth 引数が false に設定されていることを確認する（手動）<a href="#121---anonymous-auth-引数が-false-に設定されていることを確認する手動" class="hash-link" aria-label="1.2.1 --anonymous-auth 引数が false に設定されていることを確認する（手動） への直接リンク" title="1.2.1 --anonymous-auth 引数が false に設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;anonymous-auth&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--anonymous-auth&#x27; が &#x27;false&#x27; に等しい</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="122---token-auth-file-パラメータが設定されていないことを確認する自動">1.2.2 --token-auth-file パラメータが設定されていないことを確認する（自動）<a href="#122---token-auth-file-パラメータが設定されていないことを確認する自動" class="hash-link" aria-label="1.2.2 --token-auth-file パラメータが設定されていないことを確認する（自動） への直接リンク" title="1.2.2 --token-auth-file パラメータが設定されていないことを確認する（自動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/ps -ef | grep containerd | grep -v grep</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--token-auth-file&#x27; が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        2415    2397  0 Apr22 ?        00:06:36 containerd </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        3162       1  0 Apr22 ?        00:00:30 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id d540dd74296e1dc069f7c25dc9e76690d9afb22b404cd87c7f6217889da7aa7e -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        3215       1  0 Apr22 ?        00:00:29 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id 551b739eb5a7f61465027aaf2848954a29639e8ddf4f78a89fc9f881eb6b1378 -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        3318       1  0 Apr22 ?        00:00:31 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id dbf0b3aadcbf40fd7dc27f340051fc58979d46c2174963967ae01170c7d88f2d -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        4135       1  0 Apr22 ?        00:00:41 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id 21e58656877367076224111e51be5d30e8d316dbcb8c05a36a8432eda2d16ccb -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        4300       1  0 Apr22 ?        00:00:30 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id c1db1ac0969a14f1addcc0295ec09fa9fa4c55edac1acc4701ac18326dcb8a51 -address /run/k3s/containerd/containerd.sock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="123---denyserviceexternalips-が設定されていないことを確認する自動">1.2.3 --DenyServiceExternalIPs が設定されていないことを確認する（自動）<a href="#123---denyserviceexternalips-が設定されていないこと  を確認する自動" class="hash-link" aria-label="1.2.3 --DenyServiceExternalIPs が設定されていないことを確認する（自動） への直接リンク" title="1.2.3 --DenyServiceExternalIPs が設定されていないことを確認する（自動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/ps -ef | grep containerd | grep -v grep</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--enable-admission-plugins&#x27; が存在するか、存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        2415    2397  0 Apr22 ?        00:06:36 containerd </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        3162       1  0 Apr22 ?        00:00:30 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id d540dd74296e1dc069f7c25dc9e76690d9afb22b404cd87c7f6217889da7aa7e -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        3215       1  0 Apr22 ?        00:00:29 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id 551b739eb5a7f61465027aaf2848954a29639e8ddf4f78a89fc9f881eb6b1378 -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        3318       1  0 Apr22 ?        00:00:31 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id dbf0b3aadcbf40fd7dc27f340051fc58979d46c2174963967ae01170c7d88f2d -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        4135       1  0 Apr22 ?        00:00:41 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id 21e58656877367076224111e51be5d30e8d316dbcb8c05a36a8432eda2d16ccb -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        4300       1  0 Apr22 ?        00:00:30 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id c1db1ac0969a14f1addcc0295ec09fa9fa4c55edac1acc4701ac18326dcb8a51 -address /run/k3s/containerd/containerd.sock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="124---kubelet-client-certificate-および---kubelet-client-key-引数が適切に設定されていることを確認する自動">1.2.4 --kubelet-client-certificate および --kubelet-client-key 引数が適切に設定されていることを確認する（自動）<a href="#124---kubelet-client-certificate-および---kubelet-client-key-引数が適切に設定されていることを確認する自動" class="hash-link" aria-label="1.2.4 --kubelet-client-certificate および --kubelet-client-key 引数が適切に設定されていることを確認する（自動） への直接リンク" title="1.2.4 --kubelet-client-certificate および --kubelet-client-key 引数が適切に設定されていることを確認する（自動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;kubelet-certificate-authority&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--kubelet-client-certificate&#x27; が存在し、かつ &#x27;--kubelet-client-key&#x27; が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2024-04-22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="125---kubelet-certificate-authority-引数が適切に設定されていることを確認する自動化">1.2.5 --kubelet-certificate-authority 引数が適切に設定されていることを確認する（自動化）<a href="#125---kubelet-certificate-authority-引数が適切に設定されていることを確認する自動化" class="hash-link" aria-label="1.2.5 --kubelet-certificate-authority 引数が適切に設定されていることを確認する（自動化） への直接リンク" title="1.2.5 --kubelet-certificate-authority 引数が適切に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
Kubernetesのドキュメントに従って、apiserverとkubelet間のTLS接続を設定してください。その後、コントロールプレーンノード上のAPIサーバーポッド仕様ファイル
/etc/kubernetes/manifests/kube-apiserver.yamlを編集し、
--kubelet-certificate-authorityパラメータを認証局の証明書ファイルへのパスに設定してください。
--kubelet-certificate-authority=&lt;ca-string&gt;
寛容 - 提供証明書を生成する際、特定のクラウドプロバイダーに必要なホスト名の上書きと併せて機能が  破損する可能性があります。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="126---authorization-mode-引数が-alwaysallow-に設定されていないことを確認する自動化">1.2.6 --authorization-mode 引数が AlwaysAllow に設定されていないことを確認する（自動化）<a href="#126---authorization-mode-引数が-alwaysallow-に設定されていないことを確認する自動化" class="hash-link" aria-label="1.2.6 --authorization-mode 引数が AlwaysAllow に設定されていないことを確認する（自動化） への直接リンク" title="1.2.6 --authorization-mode 引数が AlwaysAllow に設定されていないことを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;authorization-mode&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--authorization-mode&#x27; に &#x27;AlwaysAllow&#x27; が含まれていない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2024-04-22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="127---authorization-mode-引数に-node-が含まれていることを確認する自動化">1.2.7 --authorization-mode 引数に Node が含まれていることを確認する（自動化）<a href="#127---authorization-mode-引数に-node-が含まれていることを確認する自動化" class="hash-link" aria-label="1.2.7 --authorization-mode 引数に Node が含まれていることを確認する（自動化） への直接リンク" title="1.2.7 --authorization-mode 引数に Node が含まれていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;authorization-mode&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコ  ピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--authorization-mode&#x27; に &#x27;Node&#x27; が含まれている</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2024-04-22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="128---authorization-mode-引数に-rbac-が含まれていることを確認する自動化">1.2.8 --authorization-mode 引数に RBAC が含まれていることを確認する（自動化）<a href="#128---authorization-mode-引数に-rbac-が含まれていることを確認する自動化" class="hash-link" aria-label="1.2.8 --authorization-mode 引数に RBAC が含まれていることを確認する（自動化） への直接リンク" title="1.2.8 --authorization-mode 引数に RBAC が含まれていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;authorization-mode&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコ  ピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--authorization-mode&#x27; に &#x27;RBAC&#x27; が設定されている</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="129-入場制御プラグイン-eventratelimit-が設定されていることを確認する-手動">1.2.9 入場制御プラグイン EventRateLimit が設定されていることを確認する (手動)<a href="#129-入場制御プラグイン-eventratelimit-が設定されていることを確認する-手動" class="hash-link" aria-label="1.2.9 入場制御プラグイン EventRateLimit が設定されていることを確認する (手動) への直接リンク" title="1.2.9 入場制御プラグイン EventRateLimit が設定されていることを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
Kubernetes のドキュメントに従い、設定ファイルに希望する制限を設定します。
次に、API サーバーのポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、以下のパラメーターを設定します。
--enable-admission-plugins=...,EventRateLimit,...
--admission-control-config-file=&lt;path/to/configuration/file&gt;</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1210-入場制御プラグイン-alwaysadmit-が設定されていないことを確認する-自動">1.2.10 入場制御プラグイン AlwaysAdmit が設定されていないことを確認す  る (自動)<a href="#1210-入場制御プラグイン-alwaysadmit-が設定されていないことを確認する-自動" class="hash-link" aria-label="1.2.10 入場制御プラグイン AlwaysAdmit が設定されていないことを確認する (自動) への直接リンク" title="1.2.10 入場制御プラグイン AlwaysAdmit が設定されていないことを確認する (自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> PASS</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;enable-admission-plugins&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--enable-admission-plugins&#x27; に &#x27;AlwaysAdmit&#x27; が含まれていない、または &#x27;--enable-admission-plugins&#x27; が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1211-入場制御プラグイン-alwayspullimages-が設定されていることを確認する-手動">1.2.11 入場制御プラグイン AlwaysPullImages が設定されていることを確認する (手動)<a href="#1211-入場制御プラグイン-alwayspullimages-が設定されていることを確認する-手動" class="hash-link" aria-label="1.2.11 入場制御プラグイン AlwaysPullImages が設定されていることを確認する (手動) への直接リンク" title="1.2.11 入場制御プラグイン AlwaysPullImages が設定されていることを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードの API サーバーポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、--enable-admission-plugins パラメーターに AlwaysPullImages を含めるように設定します。
--enable-admission-plugins=...,AlwaysPullImages,...</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1212-podsecuritypolicy-が使用されていない場合入場制御プラグイン-securitycontextdeny-が設定されていることを確認する-手動">1.2.12 PodSecurityPolicy が使用されていない場合、入場制御プラグイン SecurityContextDeny が設定されていることを確認する (手動)<a href="#1212-podsecuritypolicy-が使用されていない場合入場制御プラグイン-securitycontextdeny-が設定されていることを確認する-手動" class="hash-link" aria-label="1.2.12 PodSecurityPolicy が使用されていない場合、入場制御プラグイン SecurityContextDeny が設定されていることを確認する (手動) への直接リンク" title="1.2.12 PodSecurityPolicy が使用されていない場合、入場制御プラグイン SecurityContextDeny が設定されていることを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
コントロールプレーンノードの API サーバーポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、--enable-admission-plugins パラメーターに SecurityContextDeny を含めるように設定します。ただし、PodSecurityPolicy が既に存在する場合は除きます。
--enable-admission-plugins=...,SecurityContextDeny,...
許容 - Pod Security Policy を有効にすると、アプリケーションが予期せず失敗する可能性があります。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1213-入場制御プラグイン-serviceaccount-が設定されていることを確認する-自動">1.2.13 入場制御プラグイン ServiceAccount が設定されていることを確認する (自動)<a href="#1213-入場制御プラグイン-serviceaccount-が設定されていることを確認する-自動" class="hash-link" aria-label="1.2.13 入場制御プラグイン ServiceAccount が設定されていることを確認する (自動) への直接リンク" title="1.2.13 入場制御プラグイン ServiceAccount が設定されていることを確認する (自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> PASS</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep -v grep</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--disable-admission-plugins&#x27; が存在する、または &#x27;--disable-admission-plugins&#x27; が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1214-namespacelifecycleアドミッションコントロールプラグインが設定されていることを確認する-自動化">1.2.14 NamespaceLifecycleアドミッションコントロールプラグインが設定されていることを確認する (自動化)<a href="#1214-namespacelifecycleアドミッションコントロールプラグインが設定されていることを確認する-自動化" class="hash-link" aria-label="1.2.14 NamespaceLifecycleアドミッションコントロールプラグインが設定されていることを確認する (自動化) への直接リンク" title="1.2.14 NamespaceLifecycleアドミッションコントロールプラグインが設定されていることを確認する (自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep -v grep</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--disable-admission-plugins&#x27;が存在するか、&#x27;--disable-admission-plugins&#x27;が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1215-noderestrictionアドミッションコントロールプラグインが設定されていることを確認する-自動化">1.2.15 NodeRestrictionアドミッションコントロールプラグインが設定されていることを確認する (自動化)<a href="#1215-noderestrictionアドミッションコントロールプラグインが設定されていることを確認する-自動化" class="hash-link" aria-label="1.2.15 NodeRestrictionアドミッションコントロールプラグインが設定されていることを確認する (自動化) への直接リンク" title="1.2.15 NodeRestrictionアドミッションコントロールプラグインが設定されていることを確認する (自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;enable-admission-plugins&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--enable-admission-plugins&#x27;に&#x27;NodeRestriction&#x27;が含まれている</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1216---profiling引数がfalseに設定されていることを確認する-自動化">1.2.16 --profiling引数がfalseに設定されていることを確認する (自動化)<a href="#1216---profiling引数がfalseに設定されていることを確認する-自動化" class="hash-link" aria-label="1.2.16 --profiling引数がfalseに設定されていることを確認する (自動化) への直接リンク" title="1.2.16 --profiling引数がfalseに設定されていることを確認する (自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;profiling&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--profiling&#x27;が&#x27;false&#x27;に設定されている</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1217-ensure-that-the---audit-log-path-argument-is-set-automated">1.2.17 Ensure that the --audit-log-path argument is set (Automated)<a href="#1217-ensure-that-the---audit-log-path-argument-is-set-automated" class="hash-link" aria-label="1.2.17 Ensure that the --audit-log-path argument is set (Automated) への直接リンク" title="1.2.17 Ensure that the --audit-log-path argument is set (Automated) への直接リンク">​</a></h3>
<p><strong>Result:</strong> Not Applicable</p>
<p><strong>Remediation:</strong>
APIサーバーポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、--audit-log-path パラメータを適切なパスとファイルに設定します。例えば、
--audit-log-path=/var/log/apiserver/audit.log
許容。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1218-ensure-that-the---audit-log-maxage-argument-is-set-to-30-or-as-appropriate-automated">1.2.18 Ensure that the --audit-log-maxage argument is set to 30 or as appropriate (Automated)<a href="#1218-ensure-that-the---audit-log-maxage-argument-is-set-to-30-or-as-appropriate-automated" class="hash-link" aria-label="1.2.18 Ensure that the --audit-log-maxage argument is set to 30 or as appropriate (Automated) への直接リンク" title="1.2.18 Ensure that the --audit-log-maxage argument is set to 30 or as appropriate (Automated) への直接リンク">​</a></h3>
<p><strong>Result:</strong> Not Applicable</p>
<p><strong>Remediation:</strong>
APIサーバーポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、--audit-log-maxage パラメータを30または適切な日数に設定します。例えば、
--audit-log-maxage=30
許容。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1219-ensure-that-the---audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate-automated">1.2.19 Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate (Automated)<a href="#1219-ensure-that-the---audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate-automated" class="hash-link" aria-label="1.2.19 Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate (Automated) への直接リンク" title="1.2.19 Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate (Automated) への直接リンク">​</a></h3>
<p><strong>Result:</strong> Not Applicable</p>
<p><strong>Remediation:</strong>
APIサーバーポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、--audit-log-maxbackup パラメータを10または適切な値に設定します。例えば、
--audit-log-maxbackup=10
許容。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1220-ensure-that-the---audit-log-maxsize-argument-is-set-to-100-or-as-appropriate-automated">1.2.20 Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate (Automated)<a href="#1220-ensure-that-the---audit-log-maxsize-argument-is-set-to-100-or-as-appropriate-automated" class="hash-link" aria-label="1.2.20 Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate (Automated) への直接リンク" title="1.2.20 Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate (Automated) への直接リンク">​</a></h3>
<p><strong>Result:</strong> Not Applicable</p>
<p><strong>Remediation:</strong>
APIサーバーポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、--audit-log-maxsize パラメータを適切なサイズ（MB単位）に設定します。例えば、100 MBに設定するには、--audit-log-maxsize=100
許容。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1221-ensure-that-the---request-timeout-argument-is-set-as-appropriate-manual">1.2.21 Ensure that the --request-timeout argument is set as appropriate (Manual)<a href="#1221-ensure-that-the---request-timeout-argument-is-set-as-appropriate-manual" class="hash-link" aria-label="1.2.21 Ensure that the --request-timeout argument is set as appropriate (Manual) への直接リンク" title="1.2.21 Ensure that the --request-timeout argument is set as appropriate (Manual) への直接リンク">​</a></h3>
<p><strong>Result:</strong> Not Applicable</p>
<p><strong>Remediation:</strong>
APIサーバーポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、必要に応じて以下のパラメータを適切に設定します。例えば、--request-timeout=300s
許容。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1222-ensure-that-the---service-account-lookup-argument-is-set-to-true-automated">1.2.22 Ensure that the --service-account-lookup argument is set to true (Automated)<a href="#1222-ensure-that-the---service-account-lookup-argument-is-set-to-true-automated" class="hash-link" aria-label="1.2.22 Ensure that the --service-account-lookup argument is set to true (Automated) への直接リンク" title="1.2.22 Ensure that the --service-account-lookup argument is set to true (Automated) への直接リンク">​</a></h3>
<p><strong>Result:</strong> PASS</p>
<p><strong>Audit:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep -v grep</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Expected Result:</strong> &#x27;--service-account-lookup&#x27; が存在しないか、&#x27;--service-account-lookup&#x27; が &#x27;true&#x27; に等しい</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>Returned Value:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1223---service-account-key-file-引数が適切に設定されていることを確認する自動化">1.2.23 --service-account-key-file 引数が適切に設定されていることを確認する(自動化)<a href="#1223---service-account-key-file-引数が適切に設定されていることを確認する自動化" class="hash-link" aria-label="1.2.23 --service-account-key-file 引数が適切に設定されていることを確認する(自動化) への直接リンク" title="1.2.23 --service-account-key-file 引数が適切に設定されていることを確認する(自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>Remediation:</strong>
APIサーバーポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、--service-account-key-file パラメータをサービスアカウントの公開鍵ファイルに設定します。例えば、
--service-account-key-file=&lt;filename&gt;</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1224---etcd-certfileと--etcd-keyfile引数が適切に設定されていることを確認する自動化">1.2.24 --etcd-certfileと--etcd-keyfile引数が適切に設定されていることを確認する(自動化)<a href="#1224---etcd-certfileと--etcd-keyfile引数が適切に設定されていることを確認する自動化" class="hash-link" aria-label="1.2.24 --etcd-certfileと--etcd-keyfile引数が適切に設定されていることを確認する(自動化) への直接リンク" title="1.2.24 --etcd-certfileと--etcd-keyfile引数が適切に設定されていることを確認する(自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--etcd-certfile&#x27; が存在し、&#x27;--etcd-keyfile&#x27; が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1225---tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する自動化">1.2.25 --tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する（自動化）<a href="#1225---tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する自動化" class="hash-link" aria-label="1.2.25 --tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する（自動化） への直接リンク" title="1.2.25 --tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal -u k3s | grep -A1 &#x27;Running kube-apiserver&#x27; | tail -n2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--tls-cert-file&#x27;が存在し、かつ&#x27;--tls-private-key-file&#x27;が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-scheduler --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --bind-address=127.0.0.1 --kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --profiling=false --secure-port=10259&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1226---client-ca-file-引数が適切に設定されていることを確認する自動化">1.2.26 --client-ca-file 引数が適切に設定されていることを確認する（自動化）<a href="#1226---client-ca-file-引数が適切に設定されていることを確認する自動化" class="hash-link" aria-label="1.2.26 --client-ca-file 引数が適切に設定されていることを確認する（自動化） への直接リンク" title="1.2.26 --client-ca-file 引数が適切に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;client-ca-file&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--client-ca-file&#x27; が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1227---etcd-cafile-引数が適切に設定されていることを確認する自動化">1.2.27 --etcd-cafile 引数が適切に設定されていることを確認する（自動化）<a href="#1227---etcd-cafile-引数が適切に設定されていることを確認する自動化" class="hash-link" aria-label="1.2.27 --etcd-cafile 引数が適切に設定されていることを確認する（自動化） への直接リンク" title="1.2.27 --etcd-cafile 引数が適切に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;etcd-cafile&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--etcd-cafile&#x27; が存在すること</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1228---encryption-provider-config-引数が適切に設定されていることを確認する手動">1.2.28 --encryption-provider-config 引数が適切に設定されていることを確認する（手動）<a href="#1228---encryption-provider-config-引数が適切に設定されていることを確認する手動" class="hash-link" aria-label="1.2.28 --encryption-provider-config 引数が適切に設定されていることを確認する（手動） への直接リンク" title="1.2.28 --encryption-provider-config 引数が適切に設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 適用外</p>
<p><strong>修正方法:</strong>
Kubernetes のドキュメントに従って EncryptionConfig ファイルを設定してください。
その後、コントロールプレーンノード上の API サーバーポッド仕様ファイル /etc/kubernetes/manifests/kube-apiserver.yaml を編集し、
--encryption-provider-config パラメータをそのファイルのパスに設定してください。
例: --encryption-provider-config=&lt;/path/to/EncryptionConfig/File&gt;
許容 - 暗号化を有効にすると、データが暗号化されるためデータの復旧方法が変更されます。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1229-暗号化プロバイダーが適切に設定されていることを確認する手動">1.2.29 暗号化プロバイダーが適切に設定されていることを確認する（手動）<a href="#1229-暗号化プロバイダーが適切に設定されていることを確認する手動" class="hash-link" aria-label="1.2.29 暗号化プロバイダーが適切に設定されていることを確認する（手動） への直接リンク" title="1.2.29 暗号化プロバイダーが適切に設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 適用外</p>
<p><strong>修正方法:</strong>
Kubernetes のドキュメントに従って EncryptionConfig ファイルを設定してください。
このファイルで、aescbc、kms、または secretbox を暗号化プロバイダーとして選択してください。
許容 - 暗号化を有効にすると、データが暗号化されるためデータの復旧方法が変更されます。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1230-api-サーバーが強力な暗号化暗号スイートのみを使用していることを確認する手動">1.2.30 API サーバーが強力な暗号化暗号スイートのみを使用していることを確認する（手動）<a href="#1230-api-サーバーが強力な暗号化暗号スイートのみを使用していることを確認する手動" class="hash-link" aria-label="1.2.30 API サーバーが強力な暗号化暗号スイートのみを使用していることを確認する（手動） への直接リンク" title="1.2.30 API サーバーが強力な暗号化暗号スイートのみを使用していることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-apiserver&#x27; | tail -n1 | grep &#x27;tls-cipher-suites&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--tls-cipher-suites&#x27; に &#x27;TLS_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_CHACHA20_POLY1305_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_GCM_SHA384&#x27; からの有効な要素が含まれています</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="13-コントローラーマネージャー">1.3 コントローラーマネージャー<a href="#13-コントローラーマネージャー" class="hash-link" aria-label="1.3 コントローラーマネージャー への直接リンク" title="1.3 コントローラーマネージャー への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="131---terminated-pod-gc-threshold-引数が適切に設定されていることを確認する-手動">1.3.1 --terminated-pod-gc-threshold 引数が適切に設定されていることを確認する (手動)<a href="#131---terminated-pod-gc-threshold-引数が適切に設定されていることを確認する-手動" class="hash-link" aria-label="1.3.1 --terminated-pod-gc-threshold 引数が適切に設定されていることを確認する (手動) への直接リンク" title="1.3.1 --terminated-pod-gc-threshold 引数が適切に設定されていることを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-controller-manager&#x27; | tail -n1 | grep &#x27;terminated-pod-gc-threshold&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--terminated-pod-gc-threshold&#x27; が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cluster-cidr=10.42.0.0/16 --cluster-signing-kube-apiserver-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kube-apiserver-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kubelet-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-serving-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-kubelet-serving-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --cluster-signing-legacy-unknown-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-legacy-unknown-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --configure-cloud-routes=false --controllers=*,tokencleaner,-service,-route,-cloud-node-lifecycle --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --profiling=false --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=10257 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --terminated-pod-gc-threshold=10 --use-service-account-credentials=true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="132---profiling-引数が-false-に設定されていることを確認する-自動">1.3.2 --profiling 引数が false に設定されていることを確認する (自動)<a href="#132---profiling-引数が-false-に設定されていることを確認する-自動" class="hash-link" aria-label="1.3.2 --profiling 引数が false に設定されていることを確認する (自動) への直接リンク" title="1.3.2 --profiling 引数が false に設定されていることを確認する (自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-controller-manager&#x27; | tail -n1 | grep &#x27;profiling&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--profiling&#x27; が &#x27;false&#x27; である</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cluster-cidr=10.42.0.0/16 --cluster-signing-kube-apiserver-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kube-apiserver-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kubelet-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-serving-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-kubelet-serving-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --cluster-signing-legacy-unknown-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-legacy-unknown-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --configure-cloud-routes=false --controllers=*,tokencleaner,-service,-route,-cloud-node-lifecycle --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --profiling=false --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=10257 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --terminated-pod-gc-threshold=10 --use-service-account-credentials=true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="133---use-service-account-credentials-引数が-true-に設定されていることを確認する-自動化">1.3.3 --use-service-account-credentials 引数が true に設定されていることを確認する (自動化)<a href="#133---use-service-account-credentials-引数が-true-に設定されていることを確認する-自動化" class="hash-link" aria-label="1.3.3 --use-service-account-credentials 引数が true に設定されていることを確認する (自動化) への直接リンク" title="1.3.3 --use-service-account-credentials 引数が true に設定されていることを確認する (自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-controller-manager&#x27; | tail -n1 | grep &#x27;use-service-account-credentials&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--use-service-account-credentials&#x27; が &#x27;false&#x27; ではない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cluster-cidr=10.42.0.0/16 --cluster-signing-kube-apiserver-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kube-apiserver-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kubelet-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-serving-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-kubelet-serving-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --cluster-signing-legacy-unknown-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-legacy-unknown-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --configure-cloud-routes=false --controllers=*,tokencleaner,-service,-route,-cloud-node-lifecycle --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --profiling=false --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=10257 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --terminated-pod-gc-threshold=10 --use-service-account-credentials=true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="134---service-account-private-key-file-引数が適切に設定されていることを確認する-自動化">1.3.4 --service-account-private-key-file 引数が適切に設定されていることを確認する (自動化)<a href="#134---service-account-private-key-file-引数が適切に設定されていることを確認する-自動化" class="hash-link" aria-label="1.3.4 --service-account-private-key-file 引数が適切に設定されていることを確認する (自動化) への直接リンク" title="1.3.4 --service-account-private-key-file 引数が適切に設定されていることを確認する (自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-controller-manager&#x27; | tail -n1 | grep &#x27;service-account-private-key-file&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--service-account-private-key-file&#x27; が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cluster-cidr=10.42.0.0/16 --cluster-signing-kube-apiserver-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kube-apiserver-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kubelet-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-serving-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-kubelet-serving-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --cluster-signing-legacy-unknown-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-legacy-unknown-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --configure-cloud-routes=false --controllers=*,tokencleaner,-service,-route,-cloud-node-lifecycle --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --profiling=false --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=10257 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --terminated-pod-gc-threshold=10 --use-service-account-credentials=true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="135---root-ca-file-引数が適切に設定されていることを確認する-自動化">1.3.5 --root-ca-file 引数が適切に設定されていることを確認する (自動化)<a href="#135---root-ca-file-引数が適切に設定されていることを確認する-自動化" class="hash-link" aria-label="1.3.5 --root-ca-file 引数が適切に設定されていることを確認する (自動化) への直接リンク" title="1.3.5 --root-ca-file 引数が適切に設定されていることを確認する (自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-controller-manager&#x27; | tail -n1 | grep &#x27;root-ca-file&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--root-ca-file&#x27; が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-controller-manager --allocate-node-cidrs=true --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --bind-address=127.0.0.1 --cluster-cidr=10.42.0.0/16 --cluster-signing-kube-apiserver-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kube-apiserver-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-client-cert-file=/var/lib/rancher/k3s/server/tls/client-ca.nochain.crt --cluster-signing-kubelet-client-key-file=/var/lib/rancher/k3s/server/tls/client-ca.key --cluster-signing-kubelet-serving-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-kubelet-serving-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --cluster-signing-legacy-unknown-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.nochain.crt --cluster-signing-legacy-unknown-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --configure-cloud-routes=false --controllers=*,tokencleaner,-service,-route,-cloud-node-lifecycle --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --profiling=false --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=10257 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --terminated-pod-gc-threshold=10 --use-service-account-credentials=true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="136-rotatekubeletservercertificate-引数が-true-に設定されていることを確認する-自動化">1.3.6 RotateKubeletServerCertificate 引数が true に設定されていることを確認する (自動化)<a href="#136-rotatekubeletservercertificate-引数が-true-に設定されていることを確認する-自動化" class="hash-link" aria-label="1.3.6 RotateKubeletServerCertificate 引数が true に設定されていることを確認する (自動化) への直接リンク" title="1.3.6 RotateKubeletServerCertificate 引数が true に設定されていることを確認する (自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正:</strong>
コントロールプレーンノードの Controller Manager ポッド仕様ファイル /etc/kubernetes/manifests/kube-controller-manager.yaml を編集し、--feature-gates パラメータに RotateKubeletServerCertificate=true を含めます。
--feature-gates=RotateKubeletServerCertificate=true
該当なし。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="137---bind-address-引数が-127001-に設定されていることを確認する-自動化">1.3.7 --bind-address 引数が 127.0.0.1 に設定されていることを確認する (自動化)<a href="#137---bind-address-引数が-127001-に設定されていることを確認する-自動化" class="hash-link" aria-label="1.3.7 --bind-address 引数が 127.0.0.1 に設定されていることを確認する (自動化) への直接リンク" title="1.3.7 --bind-address 引数が 127.0.0.1 に設定されていることを確認する (自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/ps -ef | grep containerd | grep -v grep</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--bind-address&#x27; が存在する OR &#x27;--bind-address&#x27; が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        2415    2397  0 Apr22 ?        00:06:36 containerd </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        3162       1  0 Apr22 ?        00:00:30 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id d540dd74296e1dc069f7c25dc9e76690d9afb22b404cd87c7f6217889da7aa7e -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        3215       1  0 Apr22 ?        00:00:29 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id 551b739eb5a7f61465027aaf2848954a29639e8ddf4f78a89fc9f881eb6b1378 -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        3318       1  0 Apr22 ?        00:00:31 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id dbf0b3aadcbf40fd7dc27f340051fc58979d46c2174963967ae01170c7d88f2d -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        4135       1  0 Apr22 ?        00:00:41 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id 21e58656877367076224111e51be5d30e8d316dbcb8c05a36a8432eda2d16ccb -address /run/k3s/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root        4300       1  0 Apr22 ?        00:00:30 /var/lib/rancher/k3s/data/124f36823e5696ab11a8a042537e1edbc6d69919dc7579be22caccc18ccc083f/bin/containerd-shim-runc-v2 -namespace k8s.io -id c1db1ac0969a14f1addcc0295ec09fa9fa4c55edac1acc4701ac18326dcb8a51 -address /run/k3s/containerd/containerd.sock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="14-スケジューラー">1.4 スケジューラー<a href="#14-スケジューラー" class="hash-link" aria-label="1.4 スケジューラー への直接リンク" title="1.4 スケジューラー への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="141---profiling-引数が-false-に設定されていることを確認する-自動化">1.4.1 --profiling 引数が false に設定されていることを確認する (自動化)<a href="#141---profiling-引数が-false-に設定されていることを確認する-自動化" class="hash-link" aria-label="1.4.1 --profiling 引数が false に設定されていることを確認する (自動化) への直接リンク" title="1.4.1 --profiling 引数が false に設定されていることを確認する (自動化) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal -u k3s | grep &#x27;Running kube-scheduler&#x27; | tail -n1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--profiling&#x27; が &#x27;false&#x27; である</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"></code></pre></div></div></details>
<p>Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-scheduler --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --bind-address=127.0.0.1 --kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --profiling=false --secure-port=10259&quot;</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/details&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### 1.4.2 --bind-addressの引数が127.0.0.1に設定されていることを確認する（自動化）</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**結果:** 合格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**監査:**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal  -u k3s | grep &#x27;Running kube-scheduler&#x27; | tail -n1 | grep &#x27;bind-address&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--bind-address&#x27;が&#x27;127.0.0.1&#x27;に等しい、または&#x27;--bind-address&#x27;が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値：</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-scheduler --authentication-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --authorization-kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --bind-address=127.0.0.1 --kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --profiling=false --secure-port=10259&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-etcdノードの設定">2 Etcdノードの設定<a href="#2-etcdノードの設定" class="hash-link" aria-label="2 Etcdノードの設定 への直接リンク" title="2 Etcdノードの設定 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21---cert-fileと--key-file引数が適切に設定されていることを確認する自動化">2.1 --cert-fileと--key-file引数が適切に設定されていることを確認する（自動化）<a href="#21---cert-fileと--key-file引数が適切に設定されていることを確認する自動化" class="hash-link" aria-label="2.1 --cert-fileと--key-file引数が適切に設定されていることを確認する（自動化） への直接リンク" title="2.1 --cert-fileと--key-file引数が適切に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grep -A 5 &#x27;client-transport-security&#x27; /var/lib/rancher/k3s/server/db/etcd/config | grep -E &#x27;cert-file|key-file&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;cert-file&#x27;が存在し、かつ&#x27;key-file&#x27;が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  cert-file: /var/lib/rancher/k3s/server/tls/etcd/server-client.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  key-file: /var/lib/rancher/k3s/server/tls/etcd/server-client.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22---client-cert-auth引数がtrueに設定されていることを確認する自動化">2.2 --client-cert-auth引数がtrueに設定されていることを確認する（自動化）<a href="#22---client-cert-auth引数がtrueに設定されていることを確認する自動化" class="hash-link" aria-label="2.2 --client-cert-auth引数がtrueに設定されていることを確認する（自動化） への直接リンク" title="2.2 --client-cert-auth引数がtrueに設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grep -A 5 &#x27;client-transport-security&#x27; /var/lib/rancher/k3s/server/db/etcd/config | grep &#x27;client-cert-auth&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--client-cert-auth&#x27;が存在する、もしくは&#x27;client-cert-auth&#x27;が&#x27;true&#x27;に等しい</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  client-cert-auth: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23---auto-tls引数がtrueに設定されていないことを確認する自動化">2.3 --auto-tls引数がtrueに設定されていないことを確認する（自動化）<a href="#23---auto-tls引数がtrueに設定されていないことを確認する自動化" class="hash-link" aria-label="2.3 --auto-tls引数がtrueに設定されていないことを確認する（自動化） への直接リンク" title="2.3 --auto-tls引数がtrueに設定されていないことを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grep &#x27;auto-tls&#x27; /var/lib/rancher/k3s/server/db/etcd/config | true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;ETCD_AUTO_TLS&#x27;が存在しない、もしくは&#x27;ETCD_AUTO_TLS&#x27;が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">error: process ID list syntax error</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Usage:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ps [options]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Try &#x27;ps --help &lt;simple|list|output|threads|misc|all&gt;&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  or &#x27;ps --help &lt;s|l|o|t|m|a&gt;&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> for additional help text.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For more details see ps(1).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat: /proc//environ: No such file or directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24---peer-cert-fileと--peer-key-file引数が適切に設定されていることを確認する自動化">2.4 --peer-cert-fileと--peer-key-file引数が適切に設定されていることを確認する（自動化）<a href="#24---peer-cert-fileと--peer-key-file引数が適切に設定されていることを確認する自動化" class="hash-link" aria-label="2.4 --peer-cert-fileと--peer-key-file引数が適切に設定されていることを確認する（自動化） への直接リンク" title="2.4 --peer-cert-fileと--peer-key-file引数が適切に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grep -A 5 &#x27;peer-transport-security&#x27; /var/lib/rancher/k3s/server/db/etcd/config | grep -E &#x27;cert-file|key-file&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;cert-file&#x27;が存在し、かつ&#x27;key-file&#x27;が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  cert-file: /var/lib/rancher/k3s/server/tls/etcd/peer-server-client.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  key-file: /var/lib/rancher/k3s/server/tls/etcd/peer-server-client.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="25---peer-client-cert-auth引数がtrueに設定されていることを確認する自動化">2.5 --peer-client-cert-auth引数がtrueに設定されていることを確認する（自動化）<a href="#25---peer-client-cert-auth引数がtrueに設定されていることを確認する自動化" class="hash-link" aria-label="2.5 --peer-client-cert-auth引数がtrueに設定されていることを確認する（自動化） への直接リンク" title="2.5 --peer-client-cert-auth引数がtrueに設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grep -A 5 &#x27;peer-transport-security&#x27; /var/lib/rancher/k3s/server/db/etcd/config | grep &#x27;client-cert-auth&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--client-cert-auth&#x27;が存在する、もしくは&#x27;client-cert-auth&#x27;が&#x27;true&#x27;に等しい</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  client-cert-auth: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="26---peer-auto-tls引数がtrueに設定されていないことを確認する自動化">2.6 --peer-auto-tls引数がtrueに設定されていないことを確認する（自動化）<a href="#26---peer-auto-tls引数がtrueに設定されていないことを確認する自動化" class="hash-link" aria-label="2.6 --peer-auto-tls引数がtrueに設定されていないことを確認する（自動化） への直接リンク" title="2.6 --peer-auto-tls引数がtrueに設定されていないことを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grep &#x27;peer-auto-tls&#x27; /var/lib/rancher/k3s/server/db/etcd/config | true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;ETCD_PEER_AUTO_TLS&#x27;が存在しない、もしくは&#x27;ETCD_PEER_AUTO_TLS&#x27;が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">error: process ID list syntax error</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Usage:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ps [options]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Try &#x27;ps --help &lt;simple|list|output|threads|misc|all&gt;&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  or &#x27;ps --help &lt;s|l|o|t|m|a&gt;&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> for additional help text.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For more details see ps(1).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat: /proc//environ: No such file or directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="27-etcdに対して一意の認証局が使用されていることを確認する自動化">2.7 etcdに対して一意の認証局が使用されていることを確認する（自動化）<a href="#27-etcdに対して一意の認証局が使用されていることを確認する自動化" class="hash-link" aria-label="2.7 etcdに対して一意の認証局が使用されていることを確認する（自動化） への直接リンク" title="2.7 etcdに対して一意の認証局が使用されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grep &#x27;trusted-ca-file&#x27; /var/lib/rancher/k3s/server/db/etcd/config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;trusted-ca-file&#x27;が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  trusted-ca-file: /var/lib/rancher/k3s/server/tls/etcd/server-ca.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  trusted-ca-file: /var/lib/rancher/k3s/server/tls/etcd/peer-ca.crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="41-ワーカーノード設定ファイル">4.1 ワーカーノード設定ファイル<a href="#41-ワーカーノード設定ファイル" class="hash-link" aria-label="4.1 ワーカーノード設定ファイル への直接リンク" title="4.1 ワーカーノード設定ファイル への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="411-kubeletサービスファイルのパーミッションが600以上の制限に設定されていることを確認する自動化">4.1.1 kubeletサービスファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化）<a href="#411-kubeletサービスファイルのパーミッションが600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="4.1.1 kubeletサービスファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="4.1.1 kubeletサービスファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>改善策:</strong>
各ワーカーノードで以下のコマンドを実行してください（システムのファイル位置に基づいて）。
例：chmod 600 /etc/systemd/system/kubelet.service.d/10-kubeadm.conf
該当なし - すべての設定はコンテナ実行時に引数として渡されます。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="412-kubeletサービスファイルの所有権がrootに設定されていることを確認する自動化">4.1.2 kubeletサービスファイルの所有権がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#412-kubeletサービスファイルの所有権がrootに設定されていることを確認する自動化" class="hash-link" aria-label="412-kubeletサービスファイルの所有権がrootに設定されていることを確認する自動化 への直接リンク" title="412-kubeletサービスファイルの所有権がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>改善策:</strong>
各ワーカーノードで以下のコマンドを実行してください（システムのファイル位置に基づいて）。
例：
chown root<!-- -->:root<!-- --> /etc/systemd/system/kubelet.service.d/10-kubeadm.conf
該当なし。
すべての設定はコンテナ実行時に引数として渡されます。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="413-プロキシkubeconfigファイルが存在する場合パーミッションが600以上の制限に設定されていることを確認する手動">4.1.3 プロキシkubeconfigファイルが存在する場合、パーミッションが600以上の制限に設定されていることを確認する（手動）<a href="#413-プロキシkubeconfigファイルが存在する場合パーミッションが600以上の制限に設定されていることを確認する手動" class="hash-link" aria-label="4.1.3 プロキシkubeconfigファイルが存在する場合、パーミッションが600以上の制限に設定されていることを確認する（手動） への直接リンク" title="4.1.3 プロキシkubeconfigファイルが存在する場合、パーミッションが600以上の制限に設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 警告</p>
<p><strong>改善策:</strong>
各ワーカーノードで以下のコマンドを実行してください（システムのファイル位置に基づいて）。
例：
chmod 600 /var/lib/rancher/k3s/agent/kubeproxy.kubeconfig</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="414-プロキシkubeconfigファイルが存在する場合所有権がrootに設定されていることを確認する手動">4.1.4 プロキシkubeconfigファイルが存在する場合、所有権がroot<!-- -->:root<!-- -->に設定されていることを確認する（手動）<a href="#414-プロキシkubeconfigファイルが存在する場合所有権がrootに設定されていることを確認する手動" class="hash-link" aria-label="414-プロキシkubeconfigファイルが存在する場合所有権がrootに設定されていることを確認する手動 への直接リンク" title="414-プロキシkubeconfigファイルが存在する場合所有権がrootに設定されていることを確認する手動 への直接リンク">​</a></h3>
<p><strong>結果:</strong> パス</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test -e /var/lib/rancher/k3s/agent/kubeproxy.kubeconfig; then stat -c %U:%G /var/lib/rancher/k3s/agent/kubeproxy.kubeconfig; fi&#x27; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;root<!-- -->:root<!-- -->&#x27;が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root:root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="415---kubeconfig-kubeletconfファイルのパーミッションが600以上の制限に設定されていることを確認する自動化">4.1.5 --kubeconfig kubelet.confファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化）<a href="#415---kubeconfig-kubeletconfファイルのパーミッションが600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="4.1.5 --kubeconfig kubelet.confファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="4.1.5 --kubeconfig kubelet.confファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> パス</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test -e /var/lib/rancher/k3s/server/cred/admin.kubeconfig; then stat -c permissions=%a /var/lib/rancher/k3s/server/cred/admin.kubeconfig; fi&#x27; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> permissionsが600のパーミッションを持つ、期待される値は600以上の制限</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="416---kubeconfig-kubeletconfファイルの所有権がrootに設定されていることを確認する自動化">4.1.6 --kubeconfig kubelet.confファイルの所有権がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#416---kubeconfig-kubeletconfファイルの所有権がrootに設定されていることを確認する自動化" class="hash-link" aria-label="416---kubeconfig-kubeletconfファイルの所有権がrootに設定されていることを確認する自動化 への直接リンク" title="416---kubeconfig-kubeletconfファイルの所有権がrootに設定されていることを確認する自動化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> パス</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">stat -c %U:%G /var/lib/rancher/k3s/agent/kubelet.kubeconfig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong> 期待される結果:</strong> &#x27;root<!-- -->:root<!-- -->&#x27;が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root:root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="417-認証局ファイルのパーミッションが600以上の制限に設定されていることを確認する手動">4.1.7 認証局ファイルのパーミッションが600以上の制限に設定されていることを確認する（手動）<a href="#417-認証局ファイルのパーミッションが600以上の制限に設定されていることを確認する手動" class="hash-link" aria-label="4.1.7 認証局ファイルのパーミッションが600以上の制限に設定されていることを確認する（手動） への直接リンク" title="4.1.7 認証局ファイルのパーミッションが600以上の制限に設定 されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> パス</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">stat -c permissions=%a /var/lib/rancher/k3s/agent/client-ca.crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> permissionsが600のパーミッションを持つ、期待される値は600以上の制限</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="418-クライアント認証局ファイルの所有権がrootに設定されていることを確認する手動">4.1.8 クライアント認証局ファイルの所有権がroot<!-- -->:root<!-- -->に設定されていることを確認する（手動）<a href="#418-クライアント認証局ファイルの所有権がrootに設定されていることを確認する手動" class="hash-link" aria-label="418-クライアント認証局ファイルの所有権がrootに設定されていることを確認する手動 への直接リンク" title="418-クライアント認証局ファイルの所有権がrootに設定されていることを確認する手動 への直接リンク">​</a></h3>
<p><strong>結果:</strong> パス</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">stat -c %U:%G /var/lib/rancher/k3s/agent/client-ca.crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;root<!-- -->:root<!-- -->&#x27;が&#x27;root<!-- -->:root<!-- -->&#x27;と等しい</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root:root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="419-kubelet---config設定ファイルのパーミッションが600以上の制限に設定されていることを確認する自動化">4.1.9 kubelet --config設定ファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化）<a href="#419-kubelet---config設定ファイルのパーミッションが600以上の制限に設定されていることを確認する自動化" class="hash-link" aria-label="4.1.9 kubelet --config設定ファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化） への直接リンク" title="4.1.9 kubelet --config設定ファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> パス</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test -e /var/lib/rancher/k3s/agent/kubelet.kubeconfig; then stat -c permissions=%a /var/lib/rancher/k3s/agent/kubelet.kubeconfig; fi&#x27; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> permissionsが600のパーミッションを持つ、期待される値は600以上の制限</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">permissions=600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4110-kubelet---config設定ファイルの所有権がrootに設定されていることを確認する自動化">4.1.10 kubelet --config設定ファイルの所有権がroot<!-- -->:root<!-- -->に設定されていることを確認する（自動化）<a href="#4110-kubelet---config設定ファイルの所有権がrootに設定されていることを確認する自動化" class="hash-link" aria-label="4110-kubelet---config設定ファイルの所有権がrootに設定されていることを確認する自動化 への直接リンク" title="4110-kubelet---config設定ファイルの所有権がrootに設定されていることを確認する自動  化 への直接リンク">​</a></h3>
<p><strong>結果:</strong> パス</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test -e /var/lib/rancher/k3s/agent/kubelet.kubeconfig; then stat -c %U:%G /var/lib/rancher/k3s/agent/kubelet.kubeconfig; fi&#x27; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;root<!-- -->:root<!-- -->&#x27;が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">root:root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="42-kubelet">4.2 Kubelet<a href="#42-kubelet" class="hash-link" aria-label="4.2 Kubelet への直接リンク" title="4.2 Kubelet への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="421---anonymous-auth-引数が-false-に設定されていることを確認する自動化">4.2.1 --anonymous-auth 引数が false に設定されていることを確認する（自動化）<a href="#421---anonymous-auth-引数が-false-に設定されていることを確認する自動化" class="hash-link" aria-label="4.2.1 --anonymous-auth 引数が false に設定されていることを確認する（自動化） への直接リンク" title="4.2.1 --anonymous-auth 引数が false に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test $(journalctl -D /var/log/journal -u k3s | grep &quot;Running kube-apiserver&quot; | wc -l) -gt 0; then journalctl -D /var/log/journal -u k3s | grep &quot;Running kube-apiserver&quot; | tail -n1 | grep &quot;anonymous-auth&quot; | grep -v grep; else echo &quot;--anonymous-auth=false&quot;; fi&#x27; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--anonymous-auth&#x27; が &#x27;false&#x27; に等しい</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="422---authorization-modeの引数がalwaysallowに設定されていないことを確認する自動化">4.2.2 --authorization-modeの引数がAlwaysAllowに設定されていないことを確認する（自動化）<a href="#422---authorization-modeの引数がalwaysallowに設定されていないことを確認する自動化" class="hash-link" aria-label="4.2.2 --authorization-modeの引数がAlwaysAllowに設定されていないことを確認する（自動化） への直接リンク" title="4.2.2 --authorization-modeの引数がAlwaysAllowに設定されていないことを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test $(journalctl -D /var/log/journal -u k3s | grep &quot;Running kube-apiserver&quot; | wc -l) -gt 0; then journalctl -D /var/log/journal -u k3s | grep &quot;Running kube-apiserver&quot; | tail -n1 | grep &quot;authorization-mode&quot; | grep -v grep; else echo &quot;--authorization-mode=Webhook&quot;; fi&#x27; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--authorization-mode&#x27;に&#x27;AlwaysAllow&#x27;が含まれていない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="423---client-ca-file-引数が適切に設定されていることを確認する自動化">4.2.3 --client-ca-file 引数が適切に設定されていることを確認する（自動化）<a href="#423---client-ca-file-引数が適切に設定されていることを確認する自動化" class="hash-link" aria-label="4.2.3 --client-ca-file 引数が適切に設定されていることを確認する（自動化） への直接リンク" title="4.2.3 --client-ca-file 引数が適切に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/sh -c &#x27;if test $(journalctl -D /var/log/journal -u k3s | grep &quot;Running kube-apiserver&quot; | wc -l) -gt 0; then journalctl -D /var/log/journal -u k3s | grep &quot;Running kube-apiserver&quot; | tail -n1 | grep &quot;client-ca-file&quot; | grep -v grep; else echo &quot;--client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt&quot;; fi&#x27; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--client-ca-file&#x27; が存在する</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:19 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:19Z&quot; level=info msg=&quot;Running kube-apiserver --admission-control-config-file=/var/lib/rancher/k3s/server/psa.yaml --advertise-address=10.10.10.100 --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=https://kubernetes.default.svc.cluster.local,k3s --audit-log-maxage=30 --audit-log-maxbackup=10 --audit-log-maxsize=100 --audit-log-path=/var/lib/rancher/k3s/server/logs/audit.log --audit-policy-file=/var/lib/rancher/k3s/server/audit.yaml --authorization-mode=Node,RBAC --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --egress-selector-config-file=/var/lib/rancher/k3s/server/etc/egress-selector-config.yaml --enable-admission-plugins=NodeRestriction --enable-aggregator-routing=true --enable-bootstrap-token-auth=true --encryption-provider-config=/var/lib/rancher/k3s/server/cred/encryption-config.json --encryption-provider-config-automatic-reload=true --etcd-cafile=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --etcd-certfile=/var/lib/rancher/k3s/server/tls/etcd/client.crt --etcd-keyfile=/var/lib/rancher/k3s/server/tls/etcd/client.key --etcd-servers=https://127.0.0.1:2379 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --profiling=false --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-lookup=true --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.current.key --service-cluster-ip-range=10.43.0.0/16 --service-node-port-range=30000-32767 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305 --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="424---read-only-portの引数が0に設定されていることを確認する手動">4.2.4 --read-only-portの引数が0に設定されていることを確認する（手動）<a href="#424---read-only-portの引数が0に設定されていることを確認する手動" class="hash-link" aria-label="4.2.4 --read-only-portの引数が0に設定されていることを確認する（手動） への直接リンク" title="4.2.4 --read-only-portの引数が0に設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal -u k3s -u k3s-agent | grep &#x27;Running kubelet&#x27; | tail -n1 | grep &#x27;read-only-port&#x27; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--read-only-port&#x27;が&#x27;0&#x27;に等しい、または&#x27;--read-only-port&#x27;が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:21 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:21Z&quot; level=info msg=&quot;Running kubelet --address=0.0.0.0 --allowed-unsafe-sysctls=net.ipv4.ip_forward,net.ipv6.conf.all.forwarding --anonymous-auth=false --authentication-token-webhook=true --authorization-mode=Webhook --cgroup-driver=systemd --client-ca-file=/var/lib/rancher/k3s/agent/client-ca.crt --cloud-provider=external --cluster-dns=10.43.0.10 --cluster-domain=cluster.local --container-runtime-endpoint=unix:///run/k3s/containerd/containerd.sock --containerd=/run/k3s/containerd/containerd.sock --event-qps=0 --eviction-hard=imagefs.available&lt;5%,nodefs.available&lt;5% --eviction-minimum-reclaim=imagefs.available=10%,nodefs.available=10% --fail-swap-on=false --feature-gates=CloudDualStackNodeIPs=true --healthz-bind-address=127.0.0.1 --hostname-override=server-0 --kubeconfig=/var/lib/rancher/k3s/agent/kubelet.kubeconfig --make-iptables-util-chains=true --node-ip=10.10.10.100 --node-labels= --pod-infra-container-image=rancher/mirrored-pause:3.6 --pod-manifest-path=/var/lib/rancher/k3s/agent/pod-manifests --protect-kernel-defaults=true --read-only-port=0 --resolv-conf=/run/systemd/resolve/resolv.conf --serialize-image-pulls=false --streaming-connection-idle-timeout=5m --tls-cert-file=/var/lib/rancher/k3s/agent/serving-kubelet.crt --tls-private-key-file=/var/lib/rancher/k3s/agent/serving-kubelet.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="425---streaming-connection-idle-timeout-引数が0に設定されていないことを確認する手動">4.2.5 --streaming-connection-idle-timeout 引数が0に設定されていないことを確認する（手動）<a href="#425---streaming-connection-idle-timeout-引数が0に設定されていないことを確認する手動" class="hash-link" aria-label="4.2.5 --streaming-connection-idle-timeout 引数が0に設定されていないことを確認する（手動） への直接リンク" title="4.2.5 --streaming-connection-idle-timeout 引数が0に設定されていないことを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal -u k3s -u k3s-agent | grep &#x27;Running kubelet&#x27; | tail -n1 | grep &#x27;streaming-connection-idle-timeout&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--streaming-connection-idle-timeout&#x27; が &#x27;0&#x27; に等しくない、または &#x27;--streaming-connection-idle-timeout&#x27; が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:21 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:21Z&quot; level=info msg=&quot;Running kubelet --address=0.0.0.0 --allowed-unsafe-sysctls=net.ipv4.ip_forward,net.ipv6.conf.all.forwarding --anonymous-auth=false --authentication-token-webhook=true --authorization-mode=Webhook --cgroup-driver=systemd --client-ca-file=/var/lib/rancher/k3s/agent/client-ca.crt --cloud-provider=external --cluster-dns=10.43.0.10 --cluster-domain=cluster.local --container-runtime-endpoint=unix:///run/k3s/containerd/containerd.sock --containerd=/run/k3s/containerd/containerd.sock --event-qps=0 --eviction-hard=imagefs.available&lt;5%,nodefs.available&lt;5% --eviction-minimum-reclaim=imagefs.available=10%,nodefs.available=10% --fail-swap-on=false --feature-gates=CloudDualStackNodeIPs=true --healthz-bind-address=127.0.0.1 --hostname-override=server-0 --kubeconfig=/var/lib/rancher/k3s/agent/kubelet.kubeconfig --make-iptables-util-chains=true --node-ip=10.10.10.100 --node-labels= --pod-infra-container-image=rancher/mirrored-pause:3.6 --pod-manifest-path=/var/lib/rancher/k3s/agent/pod-manifests --protect-kernel-defaults=true --read-only-port=0 --resolv-conf=/run/systemd/resolve/resolv.conf --serialize-image-pulls=false --streaming-connection-idle-timeout=5m --tls-cert-file=/var/lib/rancher/k3s/agent/serving-kubelet.crt --tls-private-key-file=/var/lib/rancher/k3s/agent/serving-kubelet.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="426---make-iptables-util-chains-引数が-true-に設定されていることを確認する自動化">4.2.6 --make-iptables-util-chains 引数が true に設定されていることを確認する（自動化）<a href="#426---make-iptables-util-chains-引数が-true-に設定されていることを確認する自動化" class="hash-link" aria-label="4.2.6 --make-iptables-util-chains 引数が true に設定されていることを確認する（自動化） への直接リンク" title="4.2.6 --make-iptables-util-chains 引数が true に設定されていることを確認する（自動化） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -D /var/log/journal -u k3s -u k3s-agent | grep &#x27;Running kubelet&#x27; | tail -n1 | grep &#x27;make-iptables-util-chains&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;--make-iptables-util-chains&#x27; が &#x27;true&#x27; に等しい、または &#x27;--make-iptables-util-chains&#x27; が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Apr 22 20:12:21 server-0 k3s[2397]: time=&quot;2024-04-22T20:12:21Z&quot; level=info msg=&quot;Running kubelet --address=0.0.0.0 --allowed-unsafe-sysctls=net.ipv4.ip_forward,net.ipv6.conf.all.forwarding --anonymous-auth=false --authentication-token-webhook=true --authorization-mode=Webhook --cgroup-driver=systemd --client-ca-file=/var/lib/rancher/k3s/agent/client-ca.crt --cloud-provider=external --cluster-dns=10.43.0.10 --cluster-domain=cluster.local --container-runtime-endpoint=unix:///run/k3s/containerd/containerd.sock --containerd=/run/k3s/containerd/containerd.sock --event-qps=0 --eviction-hard=imagefs.available&lt;5%,nodefs.available&lt;5% --eviction-minimum-reclaim=imagefs.available=10%,nodefs.available=10% --fail-swap-on=false --feature-gates=CloudDualStackNodeIPs=true --healthz-bind-address=127.0.0.1 --hostname-override=server-0 --kubeconfig=/var/lib/rancher/k3s/agent/kubelet.kubeconfig --make-iptables-util-chains=true --node-ip=10.10.10.100 --node-labels= --pod-infra-container-image=rancher/mirrored-pause:3.6 --pod-manifest-path=/var/lib/rancher/k3s/agent/pod-manifests --protect-kernel-defaults=true --read-only-port=0 --resolv-conf=/run/systemd/resolve/resolv.conf --serialize-image-pulls=false --streaming-connection-idle-timeout=5m --tls-cert-file=/var/lib/rancher/k3s/agent/serving-kubelet.crt --tls-private-key-file=/var/lib/rancher/k3s/agent/serving-kubelet.key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="427---hostname-override-引数が設定されていないことを確認する手動">4.2.7 --hostname-override 引数が設定されていないことを確認する（手動）<a href="#427---hostname-override-引数が設定されていないことを確認する手動" class="hash-link" aria-label="4.2.7 --hostname-override 引数が設定されていないことを確認する（手動） への直接リンク" title="4.2.7 --hostname-override 引数が設定されていないことを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 適用外</p>
<p><strong>改善策:</strong>
各ワーカーノードの kubelet サービスファイル /etc/systemd/system/kubelet.service.d/10-kubeadm.conf を編集し、
KUBELET_SYSTEM_PODS_ARGS 変数から --hostname-override 引数を削除してください。
システムに応じて、kubelet サービスを再起動します。例えば、
systemctl daemon-reload
systemctl restart kubelet.service
適用外。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="428-適切なイベントキャプチャを確保するレベルに-eventrecordqps-引数が設定されていることを確認する手動">4.2.8 適切なイベントキャプチャを確保するレベルに eventRecordQPS 引数が設定されていること を確認する（手動）<a href="#428-適切なイベントキャプチャを確保するレベルに-eventrecordqps-引数が設定されていることを確認する手動" class="hash-link" aria-label="4.2.8 適切なイベントキャプチャを確保するレベルに eventRecordQPS 引数が設定されていることを確認する（手動） への直接リンク" title="4.2.8 適切なイベントキャプチャを確保するレベルに eventRecordQPS 引数が設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/ps -fC containerd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;eventRecordQPS&#x27; が存在する、または &#x27;eventRecordQPS&#x27; が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clusters:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- cluster:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server: https://127.0.0.1:6443</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    certificate-authority: /var/lib/rancher/k3s/agent/server-ca.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">contexts:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cluster: local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    namespace: default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    user: user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: Default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">current-context: Default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kind: Config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">preferences: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">users:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- name: user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  user:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    client-certificate: /var/lib/rancher/k3s/agent/client-kubelet.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    client-key: /var/lib/rancher/k3s/agent/client-kubelet.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="429---tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する手動">4.2.9 --tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する（手動）<a href="#429---tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する手動" class="hash-link" aria-label="4.2.9 --tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する（手動） への直接リンク" title="4.2.9 --tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 該当なし</p>
<p><strong>修正方法:</strong>
Kubelet設定ファイルを使用  している場合、ファイルを編集して<code>tlsCertFile</code>をこのKubeletを識別するために使用する証明書ファイルの場所に、<code>tlsPrivateKeyFile</code>を対応する秘密鍵ファイルの場所に設定します。
コマンドライン引数を使用している場合、各ワーカーノードの/etc/systemd/system/kubelet.service.d/10-kubeadm.confにあるkubeletサービスファイルを編集し、KUBELET_CERTIFICATE_ARGS変数に以下のパラメータを設定します。
--tls-cert-file=&lt;path/to/tls-certificate-file&gt;
--tls-private-key-file=&lt;path/to/tls-key-file&gt;
システムに応じて、kubeletサービスを再起動します。例えば、
systemctl daemon-reload
systemctl restart kubelet.service
許容 - サービス証明書を生成する際、特定のクラウドプロバイダーに必要なホスト名オーバーライドと併用すると機能が破壊される可能性があります。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4210---rotate-certificates引数がfalseに設定されていないことを確認する手動">4.2.10 --rotate-certificates引数がfalseに設定されていないことを確認する（手動）<a href="#4210---rotate-certificates引数がfalseに設定されていないことを確認する手動" class="hash-link" aria-label="4.2.10 --rotate-certificates引数がfalseに設定されていないことを確認する（手動） への直接リンク" title="4.2.10 --rotate-certificates引数がfalseに設定されていないことを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/ps -fC containerd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;rotateCertificates&#x27;が存在する または &#x27;rotateCertificates&#x27;が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値：</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clusters:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- cluster:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server: https://127.0.0.1:6443</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    certificate-authority: /var/lib/rancher/k3s/agent/server-ca.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">contexts:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cluster: local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    namespace: default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    user: user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: Default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">current-context: Default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kind: Config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">preferences: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">users:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- name: user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  user:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    client-certificate: /var/lib/rancher/k3s/agent/client-kubelet.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    client-key: /var/lib/rancher/k3s/agent/client-kubelet.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4211-rotatekubeletservercertificate-引数が-true-に設定されていることを確認する手動">4.2.11 RotateKubeletServerCertificate 引数が true に設定されていることを確認する（手動）<a href="#4211-rotatekubeletservercertificate-引数が-true-に設定されていることを確認する手動" class="hash-link" aria-label="4.2.11 RotateKubeletServerCertificate 引数が true に設定されていることを確認する（手動） への直接リンク" title="4.2.11 RotateKubeletServerCertificate 引数が true に設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 合格</p>
<p><strong>監査:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/ps -fC containerd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>期待される結果:</strong> &#x27;featureGates.RotateKubeletServerCertificate&#x27; が存在する、または &#x27;featureGates.RotateKubeletServerCertificate&#x27; が存在しない</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>返された値:</b></summary><div><div class="collapsibleContent_i85q"><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clusters:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- cluster:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server: https://127.0.0.1:6443</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    certificate-authority: /var/lib/rancher/k3s/agent/server-ca.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">contexts:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cluster: local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    namespace: default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    user: user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: Default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">current-context: Default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kind: Config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">preferences: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">users:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- name: user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  user:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    client-certificate: /var/lib/rancher/k3s/agent/client-kubelet.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    client-key: /var/lib/rancher/k3s/agent/client-kubelet.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4212-kubeletが強力な暗号化暗号のみを使用することを確認する手動">4.2.12 Kubeletが強力な暗号化暗号のみを使用することを確認する（手動）<a href="#4212-kubeletが強力な暗号化暗号のみを使用することを確認する手動" class="hash-link" aria-label="4.2.12 Kubeletが強力な暗号化暗号のみを使用することを確認する  （手動） への直接リンク" title="4.2.12 Kubeletが強力な暗号化暗号のみを使用することを確認する（手動） への直接リンク">​</a></h3>
<p><strong>結果:</strong> 警告</p>
<p><strong>修正方法:</strong>
Kubelet設定ファイルを使用している場合、ファイルを編集して<code>TLSCipherSuites</code>を
TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256
または、これらの値のサブセットに設定します。
実行可能引数を使用している場合、各ワーカーノードの/etc/systemd/system/kubelet.service.d/10-kubeadm.confにあるkubeletサービスファイルを編集し、
--tls-cipher-suites パラメータを以下のように、または、これらの値のサブセットに設定します。
--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256
システムに応じて、kubeletサービスを再起動します。例：
systemctl daemon-reload
systemctl restart kubelet.service</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4213-ポッドのpidに制限が設定されていることを確認する手動">4.2.13 ポッドのPIDに制限が設定されていることを確認する（手動）<a href="#4213-ポッドのpidに制限が設定されていることを確認する手動" class="hash-link" aria-label="4.2.13 ポッドのPIDに制限が設定されていることを確認する（手動） への直接リンク" title="4.2.13 ポッドのPIDに制限が設定されていることを確認する（手動） への直接リンク">​</a></h3>
<p><strong>Result:</strong> 警告</p>
<p><strong>Remediation:</strong>
このパラメータの適切なレベルを決定し、--pod-max-pids コマンドラインパラメータまたは PodPidsLimit 設定ファイル設定を介して設定します。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="51-rbac-とサービスアカウント">5.1 RBAC とサービスアカウント<a href="#51-rbac-とサービスアカウント" class="hash-link" aria-label="5.1 RBAC とサービスアカウント への直接リンク" title="5.1 RBAC とサービスアカウント への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="511-クラスター管理者ロールが必要な場合にのみ使用されていることを確認する-手動">5.1.1 クラスター管理者ロールが必要な場合にのみ使用されていることを確認する (手動)<a href="#511-クラスター管理者ロールが必要な場合にのみ使用されていることを確認する-手動" class="hash-link" aria-label="5.1.1 クラスター管理者ロールが必要な場合にのみ使用されていることを確認する (手動) への直接リンク" title="5.1.1 クラスター管理者ロールが必要な場合にのみ使用されていることを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 警告</p>
<p><strong>修正方法:</strong>
クラスター管理者 ロールへのすべてのクラスター役割バインディングを特定します。それらが使用されているかどうか、またはこのロールが必要かどうか、またはより少ない特権のロールを使用できるかどうかを確認します。可能な場合は、最初にユーザーを低特権のロールにバインドし、その後クラスター管理者ロールへのクラスター役割バインディングを削除します：
kubectl delete clusterrolebinding [name]</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="512-シークレットへのアクセスを最小限に抑える-手動">5.1.2 シークレットへのアクセスを最小限に抑える (手動)<a href="#512-シークレットへのアクセスを最小限に抑える-手動" class="hash-link" aria-label="5.1.2 シークレットへのアクセスを最小限に抑える (手動) への直接リンク" title="5.1.2 シークレットへのアクセスを最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 警告</p>
<p><strong>修正方法:</strong>
可能な場合は、クラスター内のシークレットオブジェクトへの get、list、および watch アクセスを削除します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="513-ロールおよびクラスター役割でのワイルドカードの使用を最小限に抑える-手動">5.1.3 ロールおよびクラスター役割でのワイルドカードの使用を最小限に抑える (手動)<a href="#513-ロールおよびクラスター役割でのワイルドカードの使用を最小限に抑える-手動" class="hash-link" aria-label="5.1.3 ロールおよびクラスター役割でのワイルドカードの使用を最小限に抑える (手動) への直接リンク" title="5.1.3 ロールおよびクラスター役割でのワイルドカードの使用を最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 警告</p>
<p><strong>修正方法:</strong>
可能な場合は、クラスター役割およびロールでのワイルドカードの使用を特定のオブジェクトまたはアクションに置き換えます。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="514-ポッドの作成アクセスを最小限に抑える-手動">5.1.4 ポッドの作成アクセスを最小限に抑える (手動)<a href="#514-ポッドの作成アクセスを最小限に抑える-手動" class="hash-link" aria-label="5.1.4 ポッドの作成アクセスを最小限に抑える (手動) への直接リンク" title="5.1.4 ポッドの作成アクセスを最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> 警告</p>
<p><strong>修正方法:</strong>
可能な場合は、クラスター内のポッドオブジェクトへの作成アクセスを削除します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="515-デフォルトのサービスアカウントが積極的に使用されていないことを確認する-手動">5.1.5 デフォルトのサービスアカウントが積極的に使用されていないことを確認する (手動)<a href="#515-デフォルトのサービスアカウントが積極的に使用されていないことを確認する-手動" class="hash-link" aria-label="5.1.5 デフォルトのサービスアカウントが積極的に使用されていないことを確認する (手動) への直接リンク" title="5.1.5 デフォルトのサービスアカウントが積極的に使用されていないことを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
Kubernetes ワークロードが Kubernetes API サーバーへの特定のアクセスを必要とする場合は、明示的なサービスアカウントを作成します。各デフォルトのサービスアカウントの設定を変更して、この値を含めます：
automountServiceAccountToken: false</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="516-サービスアカウントトークンが必要な場合にのみマウントされることを確認する-手動">5.1.6 サービスアカウントトークンが必要な場合にのみマウントされることを確認する (手動)<a href="#516-サービスアカウントトークンが必要な場合にのみマウントされることを確認する-手動" class="hash-link" aria-label="5.1.6 サービスアカウントトークンが必要な場合にのみマウントされることを確認する (手動) への直接リンク" title="5.1.6 サービスアカウントトークンが必要な場合にのみマウントされることを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
サービスアカウントトークンをマウントする必要のないポッドおよびサービスアカウントの定義を変更して無効にします。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="517-system-グループの使用を避ける-手動">5.1.7 system<!-- -->:masters<!-- --> グループの使用を避ける (手動)<a href="#517-system-グループの使用を避ける-手動" class="hash-link" aria-label="517-system-グループの使用を避ける-手動 への直接リンク" title="517-system-グループの使用を避ける-手動 への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
クラスター内のすべてのユーザーから system<!-- -->:masters<!-- --> グループを削除します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="518-kubernetes-クラスターでの-bindimpersonateおよび-escalate-権限の使用を制限する-手動">5.1.8 Kubernetes クラスターでの Bind、Impersonate、および Escalate 権限の使用を制限する (手動)<a href="#518-kubernetes-クラスターでの-bindimpersonateおよび-escalate-権限の使用を制限する-手動" class="hash-link" aria-label="5.1.8 Kubernetes クラスターでの Bind、Impersonate、および Escalate 権限の使用を制限する (手動) への直接リンク" title="5.1.8 Kubernetes クラスターでの Bind、Impersonate、および Escalate 権限の使用を制限する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
可能な場合は、サブジェクトから impersonate、bind、および escalate 権限を削除します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="519-永続ボリュームの作成アクセスを最小限に抑える-手動">5.1.9 永続ボリュームの作成アクセスを最小限に抑える (手動)<a href="#519-永続ボリュームの作成アクセスを最小限に抑える-手動" class="hash-link" aria-label="5.1.9 永続ボリュームの作成アクセスを最小限に抑える (手動) への直接リンク" title="5.1.9 永続ボリュームの作成アクセスを最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
可能な場合は、クラスター内の PersistentVolume オブジェクトへの作成アクセスを削除します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5110-ノードのプロキシサブリソースへのアクセスを最小限に抑える-手動">5.1.10 ノードのプロキシサブリソースへのアクセスを最小限に抑える (手動)<a href="#5110-ノードのプロキシサブリソースへのアクセスを最小限に抑える-手動" class="hash-link" aria-label="5.1.10 ノードのプロキシサブリソースへのアクセスを最小限に抑える (手動) への直接リンク" title="5.1.10 ノードのプロキシサブリソースへのアクセスを最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
可能な場合は、ノードオブジェ クトのプロキシサブリソースへのアクセスを削除します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5111-証明書署名要求オブジェクトの承認サブリソースへのアクセスを最小限に抑える-手動">5.1.11 証明書署名要求オブジェクトの承認サブリソースへのアクセスを最小限に抑える (手動)<a href="#5111-証明書署名要求オブジェクトの承認サブリソースへのアクセスを最小限に抑える-手動" class="hash-link" aria-label="5.1.11 証明書署名要求オブジェクトの承認サブリソースへのアクセスを最小限に抑える (手動) への直接リンク" title="5.1.11 証明書署名要求オブジェクトの承認サブリソースへのアクセスを最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
可能な場合は、証明書署名要求オブジェクトの承認サブリソースへのアクセスを削除します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5112-webhook-設定オブジェクトへのアクセスを最小限に抑える-手動">5.1.12 Webhook 設定オブジェクトへのアクセスを最小限に抑える (手動)<a href="#5112-webhook-設定オブジェクトへのアクセスを最小限に抑える-手動" class="hash-link" aria-label="5.1.12 Webhook 設定オブジェクトへのアクセスを最小限に抑える (手動) への直接リンク" title="5.1.12 Webhook 設定オブジェクトへのアクセスを最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
可能な場合は、validatingwebhookconfigurations または mutatingwebhookconfigurations オブジェクトへのアクセスを削除します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5113-サービスアカウントトークンの作成アクセスを最小限に抑える-手動">5.1.13  サービスアカウントトークンの作成アクセスを最小限に抑える (手動)<a href="#5113-サービスアカウントトークンの作成アクセスを最小限に抑える-手動" class="hash-link" aria-label="5.1.13 サービスアカウントトークンの作成アクセスを最小限に抑える (手動) への直接リンク" title="5.1.13 サービスアカウントトークンの作成アクセスを最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
可能な場合は、サービスアカウントオブジェクトのトークンサブリソースへのアクセスを削除します。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="52-ポッドセキュリティ基準">5.2 ポッドセキュリティ基準<a href="#52-ポッドセキュリティ基準" class="hash-link" aria-label="5.2 ポッドセキュリティ基準 への直接リンク" title="5.2 ポッドセキュリティ基準 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="521-クラスターに少なくとも1つのアクティブなポリシー制御メカニズムが存在することを確認する-手動">5.2.1 クラスターに少なくとも1つのアクティブなポリシー制御メカニズムが存在することを確認する (手動)<a href="#521-クラスターに少なくとも1つのアクティブなポリシー制御メカニズムが存在することを確認する-手動" class="hash-link" aria-label="5.2.1 クラスターに少なくとも1つのアクティブなポリシー制御メカニズムが存在することを確認する (手動) への直接リンク" title="5.2.1 クラスターに少なくとも1つのアクティブなポリシー制御メカニズムが存在することを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを含むすべての  ネームスペースに対して、Pod Security Admission または外部ポリシー制御システムが存在することを確認します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="522-特権コンテナの許可を最小限に抑える-手動">5.2.2 特権コンテナの許可を最小限に抑える (手動)<a href="#522-特権コンテナの許可を最小限に抑える-手動" class="hash-link" aria-label="5.2.2 特権コンテナの許可を最小限に抑える (手動) への直接リンク" title="5.2.2 特権コンテナの許可を最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを持つクラスター内の各ネームスペースにポリシーを追加して、特権コンテナの許可を制限します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="523-ホストプロセスidネームスペースを共有するコンテナの許可を最小限に抑える-自動">5.2.3 ホストプロセスIDネームスペースを共有するコンテナの許可を最小限に抑える (自動)<a href="#523-ホストプロセスidネームスペースを共有するコンテナの許可を最小限に抑える-自動" class="hash-link" aria-label="5.2.3 ホストプロセスIDネームスペースを共有するコンテナの許可を最小限に抑える (自動) への直接リンク" title="5.2.3 ホストプロセスIDネームスペースを共有するコンテナの許可を最小限に抑える (自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを持つクラスター内の各ネームスペースにポリシーを追加して、<code>hostPID</code> コンテナの許可を制限します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="524-ホストipcネームスペースを共有するコンテナの許可を最小限に抑える-自動">5.2.4   ホストIPCネームスペースを共有するコンテナの許可を最小限に抑える (自動)<a href="#524-ホストipcネームスペースを共有するコンテナの許可を最小限に抑える-自動" class="hash-link" aria-label="5.2.4 ホストIPCネームスペースを共有するコンテナの許可を最小限に抑える (自動) への直接リンク" title="5.2.4 ホストIPCネームスペースを共有するコンテナの許可を最小限に抑える (自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを持つクラスター内の各ネームスペースにポリシーを追加して、<code>hostIPC</code> コンテナの許可を制限します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="525-ホストネットワークネームスペースを共有するコンテナの許可を最小限に抑える-自動">5.2.5 ホストネットワークネームスペースを共有するコンテナの許可を最小限に抑える (自動)<a href="#525-ホストネットワークネームスペースを共有するコンテナの許可を最小限に抑える-自動" class="hash-link" aria-label="5.2.5 ホストネットワークネームスペースを共有するコンテナの許可を最小限に抑える (自動) への直接リンク" title="5.2.5 ホストネットワークネームスペースを共有するコンテナの許可を最小限に抑える (自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを持つクラスター内の各ネームスペースにポリシーを追加して、<code>hostNetwork</code> コンテナの許可を制限します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="526-allowprivilegeescalation-を持つコンテナの許可を最小限に抑える-自動">5.2.6 allowPrivilegeEscalation を持つコンテナの許可を最小限に抑える (自動)<a href="#526-allowprivilegeescalation-を持つコンテナの許可を最小限に抑える-自動" class="hash-link" aria-label="5.2.6 allowPrivilegeEscalation を持つコンテナの許可を最小限に抑える (自動) への直接リンク" title="5.2.6 allowPrivilegeEscalation を持つコンテナの許可を最小限に抑える (自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを持つクラスター内の各ネームスペースにポリシーを追加して、<code>.spec.allowPrivilegeEscalation</code> が <code>true</code> に設定されているコンテナの許可を制限します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="527-ルートコンテナの許可を最小限に抑える-自動">5.2.7 ルートコンテナの許可を最小限に抑える (自動)<a href="#527-ルートコンテナの許可を最小限に抑える-自動" class="hash-link" aria-label="5.2.7 ルートコンテナの許可を最小限に抑える (自動) への直接リンク" title="5.2.7 ルートコンテナの許可を最小限に抑える (自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
クラスター内の各ネームスペースにポリシーを作成し、<code>MustRunAsNonRoot</code> または UID の範囲に 0 を含まない <code>MustRunAs</code> が設定されていることを確認します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="528-net_raw-権限を持つコンテナの許可を最小限に抑える-自動">5.2.8 NET_RAW 権限を持つコンテナの許可を最小限に抑える (自動)<a href="#528-net_raw-権限を持つコンテナの許可を最小限に抑える-自動" class="hash-link" aria-label="5.2.8 NET_RAW 権限を持つコンテナの許可を最小限に抑える (自動) への直接リンク" title="5.2.8 NET_RAW 権限を持つコンテナの許可を最小限に抑える (  自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを持つクラスター内の各ネームスペースにポリシーを追加して、<code>NET_RAW</code> 権限を持つコンテナの許可を制限します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="529-追加の権限を持つコンテナの許可を最小限に抑える-自動">5.2.9 追加の権限を持つコンテナの許可を最小限に抑える (自動)<a href="#529-追加の権限を持つコンテナの許可を最小限に抑える-自動" class="hash-link" aria-label="5.2.9 追加の権限を持つコンテナの許可を最小限に抑える (自動) への直接リンク" title="5.2.9 追加の権限を持つコンテナの許可を最小限に抑える (自動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
クラスターのポリシーに <code>allowedCapabilities</code> が存在しないことを確認するか、空の配列に設定されていることを確認します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5210-権限が割り当てられたコンテナの許可を最小限に抑える-手動">5.2.10 権限が割り当てられたコンテナの許可を最小限に抑える (手動)<a href="#5210-権限が割り当てられたコンテナの許可を最小限に抑える-手動" class="hash-link" aria-label="5.2.10 権限が割り当てられたコンテナの許可を最小限に抑える (手動) への直接リンク" title="5.2.10 権限が割り当てられたコンテナの許可を最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
クラスター上で実行されているアプリケーションの権限の使用を確認します。ネームスペースに Linux 権限を必要としないアプリケーションが含まれている場合、すべての権限を削除しないコンテナの許可を禁止する PSP を追加することを検討します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5211-windows-hostprocess-コンテナの許可を最小限に抑える-手動">5.2.11 Windows HostProcess コンテナの許可を最小限に抑える (手動)<a href="#5211-windows-hostprocess-コンテナの許可を最小限に抑える-手動" class="hash-link" aria-label="5.2.11 Windows HostProcess コンテナの許可を最小限に抑える (手動) への直接リンク" title="5.2.11 Windows HostProcess コンテナの許可を最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを持つクラスター内の各ネームスペースにポリシーを追加して、<code>.securityContext.windowsOptions.hostProcess</code> が <code>true</code> に設定されているコンテナの許可を制限します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5212-hostpath-ボリュームの許可を最小限に抑える-手動">5.2.12 HostPath ボリュームの許可を最小限に抑える (手動)<a href="#5212-hostpath-ボリュームの許可を最小限に抑える-手動" class="hash-link" aria-label="5.2.12 HostPath ボリュームの許可を最小限に抑える (手動) への直接リンク" title="5.2.12 HostPath ボリュームの許可を最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを持つクラスター内の各ネームスペースにポリシーを追加して、<code>hostPath</code> ボリュームを持つコンテナの許可を制限します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5213-hostports-を使用するコンテナの許可を最小限に抑える-手動">5.2.13 HostPorts を使用するコンテナの許可を最小限に抑える (手動)<a href="#5213-hostports-を使用するコンテナの許可を最小限に抑える-手動" class="hash-link" aria-label="5.2.13 HostPorts を使用するコンテナの許可を最小限に抑える (手動) への直接リンク" title="5.2.13 HostPorts を使用するコンテナの許可を最小限に抑える (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ユーザーワークロードを持つクラスター内の各ネームスペースにポリシーを追加して、<code>hostPort</code> セクションを使用するコンテナの許可を制限します。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="53-ネットワークポリシーと-cni">5.3 ネットワークポリシーと CNI<a href="#53-ネットワークポリシーと-cni" class="hash-link" aria-label="5.3 ネットワークポリシーと CNI への直接リンク" title="5.3 ネットワークポリシーと CNI への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="531-使用中の-cni-がネットワークポリシーをサポートしていることを確認する-手動">5.3.1 使用中の CNI がネットワークポリシーをサポートしていることを確認する (手動)<a href="#531-使用中の-cni-がネットワークポリシーをサポートしていることを確認する-手動" class="hash-link" aria-label="5.3.1 使用中の CNI がネットワークポリシーをサポートしていることを確認する (手動) への直接リンク" title="5.3.1 使用中の CNI がネットワークポリシーをサポートしていることを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
使用中の CNI プラグインがネットワークポリシーをサポートしていない場合は、別のプラグインの使用を検討するか、Kubernetes クラスター内のトラフィックを制限するための代替メカニズムを見つけることを検討します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="532-すべてのネームスペースにネットワークポリシーが定義されていることを確認する-手動">5.3.2 すべてのネームスペースにネットワークポリシーが定義されていることを確認する (手動)<a href="#532-すべてのネームスペースにネットワークポリシーが定義されていることを確認する-手動" class="hash-link" aria-label="5.3.2 すべてのネームスペースにネットワークポリシーが定義されていることを確認する (手動) への直接リンク" title="5.3.2 すべてのネームスペースにネットワークポリシーが定義されていることを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ドキュメントに従い、必要に応じて NetworkPolicy オブジェクトを作成します。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="54-シークレット管理">5.4 シークレット管理<a href="#54-シークレット管理" class="hash-link" aria-label="5.4 シークレット管理 への直接リンク" title="5.4 シークレット管理 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="541-環境変数としてのシークレットよりもファイルとしてのシークレットを使用することを推奨する-手動">5.4.1 環境変数としてのシークレットよりもファイルとしてのシークレットを使用することを推奨する (手動)<a href="#541-環境変数としてのシークレットよりもファイルとしてのシークレットを使用することを推奨する-手動" class="hash-link" aria-label="5.4.1 環境変数としてのシークレットよりもファイルとしてのシークレットを使用することを推奨する (手動) への直接リンク" title="5.4.1 環境変数としてのシークレ ットよりもファイルとしてのシークレットを使用することを推奨する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
可能であれば、アプリケーションコードを再記述して、環境変数ではなくマウントされたシークレットファイルからシークレットを読み取るようにします。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="542-外部シークレットストレージを検討する-手動">5.4.2 外部シークレットストレージを検討する (手動)<a href="#542-外部シークレットストレージを検討する-手動" class="hash-link" aria-label="5.4.2 外部シークレットストレージを検討する (手動) への直接リンク" title="5.4.2 外部シークレットストレージを検討する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
クラウドプロバイダーまたはサードパーティのシークレット管理ソリューションが提供するシークレット管理オプションを参照します。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="55-拡張可能なアドミッションコントロール">5.5 拡張可能なアドミッションコントロール<a href="#55-拡張可能なアドミッションコントロール" class="hash-link" aria-label="5.5 拡張可能なアドミッションコントロール への直接リンク" title="5.5 拡張可能なアドミッションコントロール への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="551-imagepolicywebhook-アドミッションコントローラーを使用してイメージの出所を設定する-手動">5.5.1 ImagePolicyWebhook アドミッションコントローラーを使用してイメージの出所を設定する (手動)<a href="#551-imagepolicywebhook-アドミッションコントローラーを使用してイメージの出  所を設定する-手動" class="hash-link" aria-label="5.5.1 ImagePolicyWebhook アドミッションコントローラーを使用してイメージの出所を設定する (手動) への直接リンク" title="5.5.1 ImagePolicyWebhook アドミッションコントローラーを使用してイメージの出所を設定する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
Kubernetes のドキュメントに従い、イメージの出所を設定します。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="57-一般的なポリシー">5.7 一般的なポリシー<a href="#57-一般的なポリシー" class="hash-link" aria-label="5.7 一般的なポリシー への直接リンク" title="5.7 一般的なポリシー への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="571-ネームスペースを使用してリソース間に管理境界を作成する-手動">5.7.1 ネームスペースを使用してリソース間に管理境界を作成する (手動)<a href="#571-ネームスペースを使用してリソース間に管理境界を作成する-手動" class="hash-link" aria-label="5.7.1 ネームスペースを使用してリソース間に管理境界を作成する (手動) への直接リンク" title="5.7.1 ネームスペースを使用してリソース間に管理境界を作成する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
ドキュメントに従い、必要に応じてデプロイメント内のオブジェクトのためにネームスペースを作成します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="572-pod-定義で-seccomp-プロファイルが-dockerdefault-に設定されていることを確認する-手動">5.7.2 Pod 定義で seccomp プロファイルが docker/default に設定されていることを確認する (手動)<a href="#572-pod-定義で-seccomp-プロファイルが-dockerdefault-に設定されていることを確認する-手動" class="hash-link" aria-label="5.7.2 Pod 定義で seccomp プロファイルが docker/default に設定されていることを確認する (手動) への直接リンク" title="5.7.2 Pod 定義で seccomp プロファイルが docker/default に設定されていることを確認する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
Pod 定義で docker/default seccomp プロファイルを有効にするために <code>securityContext</code> を使用します。以下はその例です：
securityContext:
seccompProfile:
type: RuntimeDefault</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="573-pod-およびコンテナに-securitycontext-を適用する-手動">5.7.3 Pod およびコンテナに SecurityContext を適用する (手動)<a href="#573-pod-およびコンテナに-securitycontext-を適用する-手動" class="hash-link" aria-label="5.7.3 Pod およびコンテナに SecurityContext を適用する (手動) への直接リンク" title="5.7.3 Pod およびコンテナに SecurityContext を適用する (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
Kubernetes のドキュメントに従い、Pod に SecurityContext を適用します。推奨される SecurityContext のリストについては、CIS Security Benchmark for Docker Containers を参照してください。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="574-デフォルトのネームスペースを使用しない-手動">5.7.4 デフォルトのネームスペースを使用しない (手動)<a href="#574-デフォルトのネームスペースを使用しない-手動" class="hash-link" aria-label="5.7.4 デフォルトのネームスペースを使用しない (手動) への直接リンク" title="5.7.4 デフォルトのネームスペースを使用しない (手動) への直接リンク">​</a></h3>
<p><strong>結果:</strong> WARN</p>
<p><strong>修正方法:</strong>
Kubernetes リソースの適切な分離を可能にするためにネームスペースを作成し、すべての新しいリソースが特定のネームスペースに作成されることを確認します。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/k3s-io/docs/edit/main/docs/security/self-assessment-1.8.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated"><b><time datetime="2024-11-26T17:34:42.000Z" itemprop="dateModified">2024年11月26日</time></b>に<!-- -->最終更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/ja/security/hardening-guide"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">CIS ハードニングガイド</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ja/security/self-assessment-1.7"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">CIS 1.7 セルフアセスメントガイド</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概要" class="table-of-contents__link toc-highlight">概要</a><ul><li><a href="#コントロールテストの方法論" class="table-of-contents__link toc-highlight">コントロールテストの方法論</a></li></ul></li><li><a href="#11-コントロールプレーンノードの設定ファイル" class="table-of-contents__link toc-highlight">1.1 コントロールプレーンノードの設定ファイル</a><ul><li><a href="#111-apiサーバーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.1 APIサーバーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#112-apiサーバーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.2 APIサーバーポッド仕様ファイルの所有者がrootに設定されていることを確認する（自動化）</a></li><li><a href="#113-コントローラーマネージャーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.3 コントローラーマネージャーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#114-コントローラーマネージャーポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.4 コントローラーマネージャーポッド仕様ファイルの所有者がrootに設定されていることを確認する（自動化）</a></li><li><a href="#115-スケジューラーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.5 スケジューラーポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#116-スケジューラーポッド仕様ファイル の所有者がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.6 スケジューラーポッド仕様ファイルの所有者がrootに設定されていることを確認する（自動化）</a></li><li><a href="#117-etcdポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.7 etcdポッド仕様ファイルの権限が600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#118-etcdポッド仕様ファイルの所有者がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.8 etcdポッド仕様ファイルの所有者がrootに設定されていることを確認する（自動化）</a></li><li><a href="#119-コンテナネットワークインターフェイスファイルの権限が600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.9 コンテナネットワークインターフェイスファイルの権限が600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#1110-コンテナネットワークインターフェイスファイルの所有者がrootに設定されていることを確認する手動" class="table-of-contents__link toc-highlight">1.1.10 コンテナネットワークインターフェイスファイルの所有者がrootに設定されていることを確認する（手動）</a></li><li><a href="#1111-etcdデータディレクトリの権限が700以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.11 etcdデータディレクトリの権限が700以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#1112-etcdデータディレクトリの所有者がetcdに設定されていることを確 認する自動化" class="table-of-contents__link toc-highlight">1.1.12 etcdデータディレクトリの所有者がetcdに設定されていることを確認する（自動化）</a></li><li><a href="#1113-adminconfファイルの権限が600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.13 admin.confファイルの権限が600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#1114-adminconfファイルの所有者がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.14 admin.confファイルの所有者がrootに設定されていることを確認する（自動化）</a></li><li><a href="#1115-schedulerconfファイルの権限が600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.15 scheduler.confファイルの権限が600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#1116-schedulerconfファイルの所有者がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.16 scheduler.confファイルの所有者がrootに設定されていることを確認する（自動化）</a></li><li><a href="#1117-controller-managerconfファイルの権限が600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.17 controller-manager.confファイルの権限が600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#1118-controller-managerconfファイルの所有者がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.18 controller-manager.confファイルの所有者がrootに設定されていることを確認する（自動化）</a></li><li><a href="#1119-kubernetes-pkiディレクトリおよびファイルの所有者がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.1.19 Kubernetes PKIディレクトリおよびファイルの所有者がrootに設定されていることを確認する（自動化）</a></li><li><a href="#1120-kubernetes-pki証明書ファイルの権限が600以上の制限に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">1.1.20 Kubernetes PKI証明書ファイルの権限が600以上の制限に設定されていることを確認する（手動）</a></li><li><a href="#1121-kubernetes-pkiキーのファイル権限が600に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">1.1.21 Kubernetes PKIキーのファイル権限が600に設定されていることを確認する（手動）</a></li></ul></li><li><a href="#12-apiサーバー" class="table-of-contents__link toc-highlight">1.2 APIサーバー</a><ul><li><a href="#121---anonymous-auth-引数が-false-に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">1.2.1 --anonymous-auth 引数が false に設定されていることを確認する（手動）</a></li><li><a href="#122---token-auth-file-パラメータが設定されていないことを確認する自動" class="table-of-contents__link toc-highlight">1.2.2 --token-auth-file パラメータが設定されていないことを確認する（自動）</a></li><li><a href="#123---denyserviceexternalips-が設定されていないことを確認する自動" class="table-of-contents__link toc-highlight">1.2.3 --DenyServiceExternalIPs が設定されていないことを確認する（自動）</a></li><li><a href="#124---kubelet-client-certificate-および---kubelet-client-key-引数が適切に設定されていることを確認する自動" class="table-of-contents__link toc-highlight">1.2.4 --kubelet-client-certificate および --kubelet-client-key 引数が適切に 設定されていることを確認する（自動）</a></li><li><a href="#125---kubelet-certificate-authority-引数が適切に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.2.5 --kubelet-certificate-authority 引数が適切に設定されていることを確認する（自動化）</a></li><li><a href="#126---authorization-mode-引数が-alwaysallow-に設定されていないことを確認する自動化" class="table-of-contents__link toc-highlight">1.2.6 --authorization-mode 引数が AlwaysAllow に設定されていないことを確認する（自動化）</a></li><li><a href="#127---authorization-mode-引数に-node-が含まれていることを確認する自動化" class="table-of-contents__link toc-highlight">1.2.7 --authorization-mode 引数に Node が含まれていることを確認する（自動化）</a></li><li><a href="#128---authorization-mode-引数に-rbac-が含まれていることを確認する自動化" class="table-of-contents__link toc-highlight">1.2.8 --authorization-mode 引数に RBAC が含まれていることを確認する（自動化）</a></li><li><a href="#129-入場制御プラグイン-eventratelimit-が設定されていることを確認する-手動" class="table-of-contents__link toc-highlight">1.2.9 入場制御プラグイン EventRateLimit が設定されていることを確認する (手動)</a></li><li><a href="#1210-入場制御プラグイン-alwaysadmit-が設定されていないことを確認する-自動" class="table-of-contents__link toc-highlight">1.2.10 入場制御プラグイン AlwaysAdmit が設定されていないことを確認する (自動)</a></li><li><a href="#1211-入場制御プラグイン-alwayspullimages-が設定されていることを確認する-手動" class="table-of-contents__link toc-highlight">1.2.11 入場制御プラグイン AlwaysPullImages が設定されていることを確認する (手動)</a></li><li><a href="#1212-podsecuritypolicy-が使用されてい  ない場合入場制御プラグイン-securitycontextdeny-が設定されていることを確認する-手動" class="table-of-contents__link toc-highlight">1.2.12 PodSecurityPolicy が使用されていない場合、入場制御プラグイン SecurityContextDeny が設定されていることを確認する (手動)</a></li><li><a href="#1213-入場制御プラグイン-serviceaccount-が設定されていることを確認する-自動" class="table-of-contents__link toc-highlight">1.2.13 入場制御プラグイン ServiceAccount が設定されていることを確認する (自動)</a></li><li><a href="#1214-namespacelifecycleアドミッションコントロールプラグインが設定されていることを確認する-自動化" class="table-of-contents__link toc-highlight">1.2.14 NamespaceLifecycleアドミッションコントロールプラグインが設定されていることを確認する (自動化)</a></li><li><a href="#1215-noderestrictionアドミッションコントロールプラグインが設定されていることを確認する-自動化" class="table-of-contents__link toc-highlight">1.2.15 NodeRestrictionアドミッションコントロールプラグインが設定されていることを確認する (自動化)</a></li><li><a href="#1216---profiling引数がfalseに設定されていることを確認する-自動化" class="table-of-contents__link toc-highlight">1.2.16 --profiling引数がfalseに設定されていることを確認する (自動化)</a></li><li><a href="#1217-ensure-that-the---audit-log-path-argument-is-set-automated" class="table-of-contents__link toc-highlight">1.2.17 Ensure that the --audit-log-path argument is set (Automated)</a></li><li><a href="#1218-ensure-that-the---audit-log-maxage-argument-is-set-to-30-or-as-appropriate-automated" class="table-of-contents__link toc-highlight">1.2.18 Ensure that the --audit-log-maxage argument is set to 30 or as appropriate (Automated)</a></li><li><a href="#1219-ensure-that-the---audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate-automated" class="table-of-contents__link toc-highlight">1.2.19 Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate (Automated)</a></li><li><a href="#1220-ensure-that-the---audit-log-maxsize-argument-is-set-to-100-or-as-appropriate-automated" class="table-of-contents__link toc-highlight">1.2.20 Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate (Automated)</a></li><li><a href="#1221-ensure-that-the---request-timeout-argument-is-set-as-appropriate-manual" class="table-of-contents__link toc-highlight">1.2.21 Ensure that the --request-timeout argument is set as appropriate (Manual)</a></li><li><a href="#1222-ensure-that-the---service-account-lookup-argument-is-set-to-true-automated" class="table-of-contents__link toc-highlight">1.2.22 Ensure that the --service-account-lookup argument is set to true (Automated)</a></li><li><a href="#1223---service-account-key-file-引数が適切に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.2.23 --service-account-key-file 引数が適切に設定されていることを確認する(自動化)</a></li><li><a href="#1224---etcd-certfileと--etcd-keyfile引数が適切に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.2.24 --etcd-certfileと--etcd-keyfile引数が適切に設定されていることを確認する(自動化)</a></li><li><a href="#1225---tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.2.25 --tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する（自動化）</a></li><li><a href="#1226---client-ca-file-引数が適切に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.2.26 --client-ca-file 引数が適切に設定されていることを確認する（自動化）</a></li><li><a href="#1227---etcd-cafile-引数が適切に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">1.2.27 --etcd-cafile 引数が適切に設定されていることを確認する（自動化）</a></li><li><a href="#1228---encryption-provider-config-引数が適切に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">1.2.28 --encryption-provider-config 引数が適切に設定されていることを確認する（手動）</a></li><li><a href="#1229-暗号化プロバイダーが適切に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">1.2.29 暗号化プロバイダーが適切に設定されていることを確認する（手動）</a></li><li><a href="#1230-api-サーバーが強力な暗号化暗号スイートのみを使用していることを確認する手動" class="table-of-contents__link toc-highlight">1.2.30 API サーバーが強力な暗号化暗号スイートのみを使用していることを確認する（手動）</a></li></ul></li><li><a href="#13-コントローラーマネージャー" class="table-of-contents__link toc-highlight">1.3 コントローラーマネージャー</a><ul><li><a href="#131---terminated-pod-gc-threshold-引数が適切に設定されていることを確認する-手動" class="table-of-contents__link toc-highlight">1.3.1 --terminated-pod-gc-threshold 引数が適切に設定されていることを確認する (手動)</a></li><li><a href="#132---profiling-引数が-false-に設定されていることを確認する-自動" class="table-of-contents__link toc-highlight">1.3.2 --profiling 引数が false に設定されていることを確認する (自動)</a></li><li><a href="#133---use-service-account-credentials-引数が-true-に設定されていることを確認する-自動化" class="table-of-contents__link toc-highlight">1.3.3 --use-service-account-credentials 引数が true に設定されていることを確認す  る (自動化)</a></li><li><a href="#134---service-account-private-key-file-引数が適切に設定されていることを確認する-自動化" class="table-of-contents__link toc-highlight">1.3.4 --service-account-private-key-file 引数が適切に設定されていることを確認する (自動化)</a></li><li><a href="#135---root-ca-file-引数が適切に設定されていることを確認する-自動化" class="table-of-contents__link toc-highlight">1.3.5 --root-ca-file 引数が適切に設定されていることを確認する (自動化)</a></li><li><a href="#136-rotatekubeletservercertificate-引数が-true-に設定されていることを確認する-自動化" class="table-of-contents__link toc-highlight">1.3.6 RotateKubeletServerCertificate 引数が true に設定されていることを確認する (自動化)</a></li><li><a href="#137---bind-address-引数が-127001-に設定されていることを確認する-自動化" class="table-of-contents__link toc-highlight">1.3.7 --bind-address 引数が 127.0.0.1 に設定されていることを確認する (自動化)</a></li></ul></li><li><a href="#14-スケジューラー" class="table-of-contents__link toc-highlight">1.4 スケジューラー</a><ul><li><a href="#141---profiling-引数が-false-に設定されていることを確認する-自動化" class="table-of-contents__link toc-highlight">1.4.1 --profiling 引数が false に設定されていることを確認する (自動化)</a></li></ul></li><li><a href="#2-etcdノードの設定" class="table-of-contents__link toc-highlight">2 Etcdノードの設定</a><ul><li><a href="#21---cert-fileと--key-file引数が適切に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">2.1 --cert-fileと--key-file引数が適切に設定されていることを確認する（自動化）</a></li><li><a href="#22---client-cert-auth引数がtrueに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">2.2 --client-cert-auth引数がtrueに設定されていることを確認する（自動化）</a></li><li><a href="#23---auto-tls引数がtrueに設定されていないことを確認する自動化" class="table-of-contents__link toc-highlight">2.3 --auto-tls引数がtrueに設定されていないことを確認する（自動化）</a></li><li><a href="#24---peer-cert-fileと--peer-key-file引数が適切に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">2.4 --peer-cert-fileと--peer-key-file引数が適切に設定されていることを確認する（自動化）</a></li><li><a href="#25---peer-client-cert-auth引数がtrueに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">2.5 --peer-client-cert-auth引数がtrueに設定されていることを確認する（自動化）</a></li><li><a href="#26---peer-auto-tls引数がtrueに設定されていないことを確認する自動化" class="table-of-contents__link toc-highlight">2.6 --peer-auto-tls引数がtrueに設定されていないことを確認する（自動化）</a></li><li><a href="#27-etcdに対して一意の認証局が使用されていることを確認する自動化" class="table-of-contents__link toc-highlight">2.7 etcdに対して一意の認証局が使用されていることを確認する（自動化）</a></li></ul></li><li><a href="#41-ワーカーノード設定ファイル" class="table-of-contents__link toc-highlight">4.1 ワーカーノード設定ファイル</a><ul><li><a href="#411-kubeletサービスファイルのパーミッションが600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">4.1.1 kubeletサービスファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#412-kubeletサービスファイルの所有権がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">4.1.2 kubeletサービスファイルの所有権がrootに設定されていることを確認する（自動化）</a></li><li><a href="#413-プロキシkubeconfigファイルが存在する場合パーミッションが600以上の制限に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">4.1.3 プロキシkubeconfigファイルが存在する場合、パーミッションが600以上の制限に設定されていることを確認する（手動）</a></li><li><a href="#414-プロキシkubeconfigファイルが存在する場合所有権がrootに設定されていることを確認する手動" class="table-of-contents__link toc-highlight">4.1.4 プロキシkubeconfigファイルが存在する場合、所有権がrootに設定されていることを確認する（手動）</a></li><li><a href="#415---kubeconfig-kubeletconfファイルのパーミッションが600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">4.1.5 --kubeconfig kubelet.confファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#416---kubeconfig-kubeletconfファイルの所有権がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">4.1.6 --kubeconfig kubelet.confファイルの所有権がrootに設定されていることを確認する（自動化）</a></li><li><a href="#417-認証局ファイルのパーミッションが600以上の制限に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">4.1.7 認証局ファイルのパーミッションが600以上の制限に設定されていることを確認する（手動）</a></li><li><a href="#418-クライアント認証局ファイルの所有権がrootに設定されていることを確認する手動" class="table-of-contents__link toc-highlight">4.1.8 クライアント認証局ファイルの所有権がrootに設定されていることを確認する（手動）</a></li><li><a href="#419-kubelet---config設定ファイルのパーミッションが600以上の制限に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">4.1.9 kubelet --config設定ファイルのパーミッションが600以上の制限に設定されていることを確認する（自動化）</a></li><li><a href="#4110-kubelet---config設定ファイルの所有権がrootに設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">4.1.10 kubelet --config設定ファイルの所有権がrootに設定されていることを確認する（自動化）</a></li></ul></li><li><a href="#42-kubelet" class="table-of-contents__link toc-highlight">4.2 Kubelet</a><ul><li><a href="#421---anonymous-auth-引数が-false-に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">4.2.1 --anonymous-auth 引数が false に設定されていることを確認する（自動化）</a></li><li><a href="#422---authorization-modeの引数がalwaysallowに設定されていないことを確認する自動化" class="table-of-contents__link toc-highlight">4.2.2 --authorization-modeの引数がAlwaysAllowに設定されていないことを確認する（自動化）</a></li><li><a href="#423---client-ca-file-引数が適切に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">4.2.3 --client-ca-file 引数が適切に設定されていることを確認する（自動化）</a></li><li><a href="#424---read-only-portの引数が0に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">4.2.4 --read-only-portの引数が0に設定されていることを確認する（手動）</a></li><li><a href="#425---streaming-connection-idle-timeout-引数が0に設定されていないことを確認 する手動" class="table-of-contents__link toc-highlight">4.2.5 --streaming-connection-idle-timeout 引数が0に設定されていないことを確認する（手動）</a></li><li><a href="#426---make-iptables-util-chains-引数が-true-に設定されていることを確認する自動化" class="table-of-contents__link toc-highlight">4.2.6 --make-iptables-util-chains 引数が true に設定されていることを確認する（自動化）</a></li><li><a href="#427---hostname-override-引数が設定されていないことを確認する手動" class="table-of-contents__link toc-highlight">4.2.7 --hostname-override 引数が設定されていないことを確認する（手動）</a></li><li><a href="#428-適切なイベントキャプチャを確保するレベルに-eventrecordqps-引数が設定されていることを確認する手動" class="table-of-contents__link toc-highlight">4.2.8 適切なイベントキャプチャを確保するレベルに eventRecordQPS 引数が設定されていることを確認する（手動）</a></li><li><a href="#429---tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">4.2.9 --tls-cert-fileと--tls-private-key-file引数が適切に設定されていることを確認する（手動）</a></li><li><a href="#4210---rotate-certificates引数がfalseに設定されていないことを確認する手動" class="table-of-contents__link toc-highlight">4.2.10 --rotate-certificates引数がfalseに設定されていないことを確認する（手動）</a></li><li><a href="#4211-rotatekubeletservercertificate-引数が-true-に設定されていることを確認する手動" class="table-of-contents__link toc-highlight">4.2.11 RotateKubeletServerCertificate 引数が true に設定されていることを確認する（手動）</a></li><li><a href="#4212-kubeletが強力な暗号化暗号のみを使用することを確認する手動" class="table-of-contents__link toc-highlight">4.2.12 Kubeletが強力な暗号化暗号のみを使用することを確認する（手動）</a></li><li><a href="#4213-ポッドのpidに制限が設定されていることを確認する手動" class="table-of-contents__link toc-highlight">4.2.13 ポッドのPIDに制限が設定されていることを確認する（手動）</a></li></ul></li><li><a href="#51-rbac-とサービスアカウント" class="table-of-contents__link toc-highlight">5.1 RBAC とサービスアカウント</a><ul><li><a href="#511-クラスター管理者ロールが必要な場合にのみ使用されていることを確認する-手動" class="table-of-contents__link toc-highlight">5.1.1 クラスター管理者ロールが必要な場合にのみ使用されていることを確認する (手動)</a></li><li><a href="#512-シークレットへのアクセスを最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.1.2 シークレットへのアクセスを最小限に抑える (手動)</a></li><li><a href="#513-ロールおよびクラスター役割でのワイルドカードの使用を最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.1.3 ロールおよびクラスター役割でのワイルドカードの使用を最小限に抑える (手動)</a></li><li><a href="#514-ポッドの作成アクセスを最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.1.4 ポッドの作成アクセスを最小限に抑える (手動)</a></li><li><a href="#515-デフォルトのサービスアカウントが積極的に使用されていないことを確認する-手動" class="table-of-contents__link toc-highlight">5.1.5 デフォルトのサービスアカウントが積極的に使用されていないことを確認する (手動)</a></li><li><a href="#516-サービスアカウントトークンが必要な場合にのみマウントされることを確認する-手動" class="table-of-contents__link toc-highlight">5.1.6 サービスアカウントトークンが必要な場合にのみマウントされることを確認する (手動)</a></li><li><a href="#517-system-グループの使用を避ける-手動" class="table-of-contents__link toc-highlight">5.1.7 system グループの使用を避ける (手動)</a></li><li><a href="#518-kubernetes-クラスターでの-bindimpersonateおよび-escalate-権限の使用を制限する-手動" class="table-of-contents__link toc-highlight">5.1.8 Kubernetes クラスターでの Bind、Impersonate、および Escalate 権限の使用を制限する (手動)</a></li><li><a href="#519-永続ボリュームの作成アクセスを最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.1.9 永続ボリュームの作成アクセスを最小限に抑える (手動)</a></li><li><a href="#5110-ノードのプロキシサブリソースへのアクセスを最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.1.10 ノードのプロキシサブリソースへのアクセスを最小限に抑える (手動)</a></li><li><a href="#5111-証明書署名要求オブジェクトの承認サブリソースへのアクセスを最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.1.11 証明書署名要求オブジェクトの承認サブリソースへのアクセスを最小限に抑える (手動)</a></li><li><a href="#5112-webhook-設定オブジェクトへのアクセスを最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.1.12 Webhook 設定オブジェクトへのアクセスを最小限に抑える (手動)</a></li><li><a href="#5113-サービスアカウントトークンの作成アクセスを最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.1.13 サービスアカウントトークンの作成アクセスを最小限に抑える (手動)</a></li></ul></li><li><a href="#52-ポッドセキュリティ基準" class="table-of-contents__link toc-highlight">5.2 ポッドセキュリティ  基準</a><ul><li><a href="#521-クラスターに少なくとも1つのアクティブなポリシー制御メカニズムが存在することを確認する-手動" class="table-of-contents__link toc-highlight">5.2.1 クラスターに少なくとも1つのアクティブなポリシー制御メカニズムが存在することを確認する (手動)</a></li><li><a href="#522-特権コンテナの許可を最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.2.2 特権コンテナの許可を最小限に抑える (手動)</a></li><li><a href="#523-ホストプロセスidネームスペースを共有するコンテナの許可を最小限に抑える-自動" class="table-of-contents__link toc-highlight">5.2.3 ホストプロセスIDネームスペースを共有するコンテナの許可を最小限に抑える (自動)</a></li><li><a href="#524-ホストipcネームスペースを共有するコンテナの許可を最小限に抑える-自動" class="table-of-contents__link toc-highlight">5.2.4 ホストIPCネームスペースを共有するコンテナの許可を最小限に抑える (自動)</a></li><li><a href="#525-ホストネットワークネームスペースを共有するコンテナの許可を最小限に抑える-自動" class="table-of-contents__link toc-highlight">5.2.5 ホストネットワークネームスペースを共有するコンテナの許可を最小限に抑える (自動)</a></li><li><a href="#526-allowprivilegeescalation-を持つコンテナの許可を最小限に抑える-自動" class="table-of-contents__link toc-highlight">5.2.6 allowPrivilegeEscalation を持つコンテナの許可を最小限に抑える (自動)</a></li><li><a href="#527-ルートコンテナの許可を最小限に抑える-自動" class="table-of-contents__link toc-highlight">5.2.7 ルートコンテナの許可を最小限に抑える (自動)</a></li><li><a href="#528-net_raw-権限を持つコンテナの許可を最小限に抑える-自動" class="table-of-contents__link toc-highlight">5.2.8 NET_RAW 権限を持つコンテナの許可を最小限に抑える (自動)</a></li><li><a href="#529-追加の権限を持つコンテナの許可を最小限に抑える-自動" class="table-of-contents__link toc-highlight">5.2.9 追加の権限を持つコンテナの許可を最小限に抑える (自動)</a></li><li><a href="#5210-権限が割り当てられたコンテナの許可を最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.2.10 権限が割り当てられたコンテナの許可を最小限に抑える (手動)</a></li><li><a href="#5211-windows-hostprocess-コンテナの許可を最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.2.11 Windows HostProcess コンテナの許可を最小限に抑える (手動)</a></li><li><a href="#5212-hostpath-ボリュームの許可を最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.2.12 HostPath ボリュームの許可を最小限に抑える (手動)</a></li><li><a href="#5213-hostports-を使用するコンテナの許可を最小限に抑える-手動" class="table-of-contents__link toc-highlight">5.2.13 HostPorts を使用するコンテナの許可を最小限に抑える (手動)</a></li></ul></li><li><a href="#53-ネットワークポリシーと-cni" class="table-of-contents__link toc-highlight">5.3 ネットワークポリシーと CNI</a><ul><li><a href="#531-使用中の-cni-がネットワークポリシーをサポートしていることを確認する-手動" class="table-of-contents__link toc-highlight">5.3.1 使用中の CNI がネットワークポリシーをサポートしていることを確認する (手動)</a></li><li><a href="#532-すべてのネームスペースにネットワークポリシーが定義されていることを確認する-手動" class="table-of-contents__link toc-highlight">5.3.2 すべてのネームスペースにネットワークポリシーが定義されていることを確認する (手動)</a></li></ul></li><li><a href="#54-シークレット管理" class="table-of-contents__link toc-highlight">5.4 シークレット管理</a><ul><li><a href="#541-環境変数としてのシークレットよりもファイルとしてのシークレットを使用することを推奨する-手動" class="table-of-contents__link toc-highlight">5.4.1 環境変数としてのシークレットよりもファイルとしてのシークレットを使用することを推奨する (手動)</a></li><li><a href="#542-外部シークレットストレージを検討する-手動" class="table-of-contents__link toc-highlight">5.4.2 外部シークレットストレージを検討する (手動)</a></li></ul></li><li><a href="#55-拡張可能なアドミッションコントロール" class="table-of-contents__link toc-highlight">5.5 拡張可能なアドミッションコントロール</a><ul><li><a href="#551-imagepolicywebhook-アドミッションコントローラーを使用してイメージの出所を設定する-手動" class="table-of-contents__link toc-highlight">5.5.1 ImagePolicyWebhook アドミッションコントローラーを使用してイメージの出所を設定する (手動)</a></li></ul></li><li><a href="#57-一般的なポリシー" class="table-of-contents__link toc-highlight">5.7 一般的なポリシー</a><ul><li><a href="#571-ネームスペースを使用してリソース間に管理境界を作成する-手動" class="table-of-contents__link toc-highlight">5.7.1 ネームスペースを使用してリソース間に管理境界を作成する (手動)</a></li><li><a href="#572-pod-定義で-seccomp-プロファイルが-dockerdefault-に設定されていることを確認する-手動" class="table-of-contents__link toc-highlight">5.7.2 Pod 定義で seccomp プロファイルが docker/default に設定されていることを確認する (手動)</a></li><li><a href="#573-pod-およびコンテナに-securitycontext-を適用する-手動" class="table-of-contents__link toc-highlight">5.7.3 Pod およびコンテナに SecurityContext を適用する (手動)</a></li><li><a href="#574-デフォルトのネームスペースを使用しない-手動" class="table-of-contents__link toc-highlight">5.7.4 デフォルトのネームスペースを使用しない (手動)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 K3s Project Authors. All rights reserved. <br>The Linux Foundation has registered trademarks
      and uses trademarks. For a list of trademarks of The Linux Foundation, 
      please see our <a href="https://www.linuxfoundation.org/trademark-usage"> Trademark Usage</a> page.</div></div></div></footer></div>
</body>
</html>