<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cli/server" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">server | K3s</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.k3s.io/cli/server"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" property="og:locale:alternate" content="kr"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="server | K3s"><meta data-rh="true" name="description" content="In this section, you&#x27;ll learn how to configure the K3s server."><meta data-rh="true" property="og:description" content="In this section, you&#x27;ll learn how to configure the K3s server."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.k3s.io/cli/server"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/cli/server" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/zh/cli/server" hreflang="zh"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/kr/cli/server" hreflang="kr"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/ja/cli/server" hreflang="ja"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/cli/server" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="K3s RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="K3s Atom Feed"><link rel="stylesheet" href="/assets/css/styles.12a81b31.css">
<script src="/assets/js/runtime~main.3f72ef61.js" defer="defer"></script>
<script src="/assets/js/main.4bfe0e97.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/k3s-logo-light.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/k3s-logo-dark.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/cli/server" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh/cli/server" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li><li><a href="/kr/cli/server" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="kr">한국어</a></li><li><a href="/ja/cli/server" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li></ul></div><a class="navbar__item navbar__link navbar__icon navbar__blog" href="/blog">Blog</a><a href="https://github.com/k3s-io/k3s/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__icon navbar__github">GitHub</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">K3s - Lightweight Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quick-start">Quick-Start Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/installation">Installation</a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/datastore">Cluster Datastore</a><button aria-label="Expand sidebar category &#x27;Cluster Datastore&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/upgrades">Upgrades</a><button aria-label="Expand sidebar category &#x27;Upgrades&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/security">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/cli">CLI Tools</a><button aria-label="Collapse sidebar category &#x27;CLI Tools&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cli/server">server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/agent">agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/certificate">certificate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/etcd-snapshot">etcd-snapshot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/secrets-encrypt">secrets-encrypt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/token">token</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cluster-access">Cluster Access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/storage">Volumes and Storage</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/networking">Networking</a><button aria-label="Expand sidebar category &#x27;Networking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/helm">Helm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/advanced">Advanced Options / Configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/reference/env-variables">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/release-notes/v1.32.X">Release Notes</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/related-projects">Related Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/known-issues">Known Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/faq">FAQ</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cli"><span itemprop="name">CLI Tools</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">server</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>k3s server</h1></header>
<p>In this section, you&#x27;ll learn how to configure the K3s server.</p>
<p>Note that servers also run an agent, so all of the configuration options listed in the <a href="/cli/agent"><code>k3s agent</code> documentation</a> are also supported on servers.</p>
<p>Options are documented on this page as CLI flags, but can also be passed as configuration file options. See the <a href="/installation/configuration#configuration-file">Configuration File</a> documentation for more information on using YAML configuration files.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="critical-configuration-values">Critical Configuration Values<a href="#critical-configuration-values" class="hash-link" aria-label="Direct link to Critical Configuration Values" title="Direct link to Critical Configuration Values">​</a></h2>
<p>The following options must be set to the same value on all servers in the cluster. Failure to do so will cause new servers to fail to join the cluster when using embedded etcd, or incorrect operation of the cluster when using an external datastore.</p>
<ul>
<li><code>--agent-token</code></li>
<li><code>--cluster-cidr</code></li>
<li><code>--cluster-dns</code></li>
<li><code>--cluster-domain</code></li>
<li><code>--disable-cloud-controller</code></li>
<li><code>--disable-helm-controller</code></li>
<li><code>--disable-network-policy</code></li>
<li><code>--disable=servicelb</code> <em>note: other packaged components may be disabled on a per-server basis</em></li>
<li><code>--egress-selector-mode</code></li>
<li><code>--embedded-registry</code></li>
<li><code>--flannel-backend</code></li>
<li><code>--flannel-external-ip</code></li>
<li><code>--flannel-ipv6-masq</code></li>
<li><code>--secrets-encryption</code></li>
<li><code>--service-cidr</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="commonly-used-options">Commonly Used Options<a href="#commonly-used-options" class="hash-link" aria-label="Direct link to Commonly Used Options" title="Direct link to Commonly Used Options">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="database">Database<a href="#database" class="hash-link" aria-label="Direct link to Database" title="Direct link to Database">​</a></h3>
<table><thead><tr><th>Flag</th><th>Environment Variable</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>--datastore-endpoint</code> value</td><td><code>K3S_DATASTORE_ENDPOINT</code></td><td></td><td>Specify etcd, NATS, MySQL, Postgres, or SQLite data source name</td></tr><tr><td><code>--datastore-cafile</code> value</td><td><code>K3S_DATASTORE_CAFILE</code></td><td></td><td>TLS Certificate Authority file used to secure datastore backend communication</td></tr><tr><td><code>--datastore-certfile</code> value</td><td><code>K3S_DATASTORE_CERTFILE</code></td><td></td><td>TLS certification file used to secure datastore backend communication</td></tr><tr><td><code>--datastore-keyfile</code> value</td><td><code>K3S_DATASTORE_KEYFILE</code></td><td></td><td>TLS key file used to secure datastore backend communication</td></tr><tr><td><code>--etcd-expose-metrics</code></td><td></td><td>false</td><td>Expose etcd metrics to client interface</td></tr><tr><td><code>--etcd-disable-snapshots</code></td><td></td><td>false</td><td>Disable automatic etcd snapshots</td></tr><tr><td><code>--etcd-snapshot-name</code> value</td><td></td><td>&quot;etcd-snapshot-&lt;unix-timestamp&gt;&quot;</td><td>Set the base name of etcd snapshots.</td></tr><tr><td><code>--etcd-snapshot-schedule-cron</code> value</td><td></td><td>&quot;0 */12 * * *&quot;</td><td>Snapshot interval time in cron spec. eg. every 5 hours &#x27;0 */5 _ * _&#x27;</td></tr><tr><td><code>--etcd-snapshot-retention</code> value</td><td></td><td>5</td><td>Number of snapshots to retain</td></tr><tr><td><code>--etcd-snapshot-dir</code> value</td><td></td><td>${data-dir}/db/snapshots</td><td>Directory to save db snapshots</td></tr><tr><td><code>--etcd-s3</code></td><td></td><td></td><td>Enable backup to S3</td></tr><tr><td><code>--etcd-s3-endpoint</code> value</td><td></td><td>&quot;s3.amazonaws.com&quot;</td><td>S3 endpoint url</td></tr><tr><td><code>--etcd-s3-endpoint-ca</code> value</td><td></td><td></td><td>S3 custom CA cert to connect to S3 endpoint</td></tr><tr><td><code>--etcd-s3-skip-ssl-verify</code></td><td></td><td></td><td>Disables S3 SSL certificate validation</td></tr><tr><td><code>--etcd-s3-access-key</code> value</td><td><code>AWS_ACCESS_KEY_ID</code></td><td></td><td>S3 access key</td></tr><tr><td><code>--etcd-s3-secret-key</code> value</td><td><code>AWS_SECRET_ACCESS_KEY</code></td><td></td><td>S3 secret key</td></tr><tr><td><code>--etcd-s3-bucket</code> value</td><td></td><td></td><td>S3 bucket name</td></tr><tr><td><code>--etcd-s3-region</code> value</td><td></td><td>&quot;us-east-1&quot;</td><td>S3 region / bucket location (optional)</td></tr><tr><td><code>--etcd-s3-folder</code> value</td><td></td><td></td><td>S3 folder</td></tr><tr><td><code>--etcd-s3-proxy</code></td><td></td><td></td><td>Proxy server to use when connecting to S3, overriding any proxy-releated environment variables</td></tr><tr><td><code>--etcd-s3-config-secret</code></td><td></td><td></td><td>Name of secret in the kube-system namespace used to configure S3, if etcd-s3 is enabled and no other etcd-s3 options are set</td></tr><tr><td><code>--etcd-s3-insecure</code></td><td></td><td></td><td>Disables S3 over HTTPS</td></tr><tr><td><code>--etcd-s3-timeout</code> value</td><td></td><td>5m0s</td><td>S3 timeout (default: 5m0s)</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-options">Cluster Options<a href="#cluster-options" class="hash-link" aria-label="Direct link to Cluster Options" title="Direct link to Cluster Options">​</a></h3>
<table><thead><tr><th>Flag</th><th>Environment Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>--token</code> value, <code>-t</code> value</td><td><code>K3S_TOKEN</code></td><td>Shared secret used to join a server or agent to a cluster</td></tr><tr><td><code>--token-file</code> value</td><td><code>K3S_TOKEN_FILE</code></td><td>File containing the cluster-secret/token</td></tr><tr><td><code>--agent-token</code> value</td><td><code>K3S_AGENT_TOKEN</code></td><td>Shared secret used to join agents to the cluster, but not servers</td></tr><tr><td><code>--agent-token-file</code> value</td><td><code>K3S_AGENT_TOKEN_FILE</code></td><td>File containing the agent secret</td></tr><tr><td><code>--server</code> value</td><td><code>K3S_URL</code></td><td>Server to connect to, used to join a cluster</td></tr><tr><td><code>--cluster-init</code></td><td><code>K3S_CLUSTER_INIT</code></td><td>Initialize a new cluster using embedded Etcd</td></tr><tr><td><code>--cluster-reset</code></td><td><code>K3S_CLUSTER_RESET</code></td><td>Forget all peers and become sole member of a new cluster</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="admin-kubeconfig-options">Admin Kubeconfig Options<a href="#admin-kubeconfig-options" class="hash-link" aria-label="Direct link to Admin Kubeconfig Options" title="Direct link to Admin Kubeconfig Options">​</a></h3>
<table><thead><tr><th>Flag</th><th>Environment Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>--write-kubeconfig value, -o</code> value</td><td><code>K3S_KUBECONFIG_OUTPUT</code></td><td>Write kubeconfig for admin client to this file</td></tr><tr><td><code>--write-kubeconfig-mode</code> value</td><td><code>K3S_KUBECONFIG_MODE</code></td><td>Write kubeconfig with this <a href="https://en.wikipedia.org/wiki/Chmod" target="_blank" rel="noopener noreferrer">mode.</a> The kubeconfig file is owned by root, and written with a default mode of 600. Changing the mode to 644 will allow it to be read by other unprivileged users on the host.</td></tr><tr><td><code>--write-kubeconfig-group</code> value</td><td><code>K3S_KUBECONFIG_GROUP</code></td><td>Write kubeconfig group. Combining with <code>--write-kubeconfig-mode</code>, it will allow your k3s administrators accessing the kubeconfig file but keeping the file owned by root.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-options">Advanced Options<a href="#advanced-options" class="hash-link" aria-label="Direct link to Advanced Options" title="Direct link to Advanced Options">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Logging<a href="#logging" class="hash-link" aria-label="Direct link to Logging" title="Direct link to Logging">​</a></h3>
<table><thead><tr><th>Flag</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>--debug</code></td><td>N/A</td><td>Turn on debug logs</td></tr><tr><td><code>-v</code> value</td><td>0</td><td>Number for the log level verbosity</td></tr><tr><td><code>--vmodule</code> value</td><td>N/A</td><td>Comma-separated list of FILE_PATTERN=LOG_LEVEL settings for file-filtered logging</td></tr><tr><td><code>--log value, -l</code> value</td><td>N/A</td><td>Log to file</td></tr><tr><td><code>--alsologtostderr</code></td><td>N/A</td><td>Log to standard error as well as file (if set)</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="listeners">Listeners<a href="#listeners" class="hash-link" aria-label="Direct link to Listeners" title="Direct link to Listeners">​</a></h3>
<table><thead><tr><th>Flag</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>--bind-address</code> value</td><td>0.0.0.0</td><td>k3s bind address</td></tr><tr><td><code>--https-listen-port</code> value</td><td>6443</td><td>HTTPS listen port</td></tr><tr><td><code>--advertise-address</code> value</td><td>node-external-ip/node-ip</td><td>IPv4/IPv6 address that apiserver advertises for its service endpoint<br>Note that the primary <code>service-cidr</code> IP range must be of the same address family as the advertised address</td></tr><tr><td><code>--advertise-port</code> value</td><td>listen-port/0</td><td>Port that apiserver uses to advertise to members of the cluster</td></tr><tr><td><code>--tls-san</code> value</td><td>N/A</td><td>Add additional hostnames or IPv4/IPv6 addresses as Subject Alternative Names on the TLS cert</td></tr><tr><td><code>--tls-san-security</code></td><td>true</td><td>Protect the server TLS cert by refusing to add Subject Alternative Names not associated with the kubernetes apiserver service, server nodes, or values of the tls-san option</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data">Data<a href="#data" class="hash-link" aria-label="Direct link to Data" title="Direct link to Data">​</a></h3>
<table><thead><tr><th>Flag</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>--data-dir value, -d</code> value</td><td><code>/var/lib/rancher/k3s</code> or <code>${HOME}/.rancher/k3s</code> if not root</td><td>Folder to hold state</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secrets-encryption">Secrets Encryption<a href="#secrets-encryption" class="hash-link" aria-label="Direct link to Secrets Encryption" title="Direct link to Secrets Encryption">​</a></h3>
<table><thead><tr><th>Flag</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>--secrets-encryption</code></td><td>false</td><td>Enable Secret encryption at rest</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="networking">Networking<a href="#networking" class="hash-link" aria-label="Direct link to Networking" title="Direct link to Networking">​</a></h3>
<table><thead><tr><th>Flag</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>--cluster-cidr</code> value</td><td>&quot;10.42.0.0/16&quot;</td><td>IPv4/IPv6 network CIDRs to use for pod IPs</td></tr><tr><td><code>--service-cidr</code> value</td><td>&quot;10.43.0.0/16&quot;</td><td>IPv4/IPv6 network CIDRs to use for service</td></tr><tr><td><code>--service-node-port-range</code> value</td><td>&quot;30000-32767&quot;</td><td>Port range to reserve for services with NodePort visibility</td></tr><tr><td><code>--cluster-dns</code> value</td><td>&quot;10.43.0.10&quot;</td><td>IPv4 Cluster IP for coredns service. Should be in your service-cidr range</td></tr><tr><td><code>--cluster-domain</code> value</td><td>&quot;cluster.local&quot;</td><td>Cluster Domain</td></tr><tr><td><code>--flannel-backend</code> value</td><td>&quot;vxlan&quot;</td><td>One of &#x27;none&#x27;, &#x27;vxlan&#x27;, &#x27;ipsec&#x27;(deprecated), &#x27;host-gw&#x27;, &#x27;wireguard-native&#x27;, or &#x27;wireguard&#x27;(deprecated)</td></tr><tr><td><code>--flannel-ipv6-masq</code></td><td>&quot;N/A&quot;</td><td>Enable IPv6 masquerading for pod</td></tr><tr><td><code>--flannel-external-ip</code></td><td>&quot;N/A&quot;</td><td>Use node external IP addresses for Flannel traffic</td></tr><tr><td><code>--servicelb-namespace</code> value</td><td>&quot;kube-system&quot;</td><td>Namespace of the pods for the servicelb component</td></tr><tr><td><code>--egress-selector-mode</code> value</td><td>&quot;agent&quot;</td><td>Must be one of the following: <ul><li>disabled: The apiserver does not use agent tunnels to communicate with nodes. Requires that servers run agents, and have direct connectivity to the kubelet on agents, or the apiserver will not be able to function access service endpoints or perform kubectl exec and kubectl logs.</li><li>agent: The apiserver uses agent tunnels to communicate with nodes. Nodes allow the tunnel connection from loopback addresses. Requires that servers also run agents, or the apiserver will not be able to access service endpoints. The historical default for k3s.</li><li> pod: The apiserver uses agent tunnels to communicate with nodes and service endpoints, routing endpoint connections to the correct agent by watching Nodes. Nodes allow the tunnel connection from loopback addresses, or a CIDR assigned to their node.</li><li>  cluster: The apiserver uses agent tunnels to communicate with nodes and service endpoints, routing endpoint connections to the correct agent by watching Endpoints. Nodes allow the tunnel connection from loopback addresses, or the configured cluster CIDR range.</li></ul></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-class">Storage Class<a href="#storage-class" class="hash-link" aria-label="Direct link to Storage Class" title="Direct link to Storage Class">​</a></h3>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--default-local-storage-path</code> value</td><td>Default local storage path for local provisioner storage class</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-components">Kubernetes Components<a href="#kubernetes-components" class="hash-link" aria-label="Direct link to Kubernetes Components" title="Direct link to Kubernetes Components">​</a></h3>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--disable</code> value</td><td>See &quot;<a href="/installation/packaged-components#using-the---disable-flag">Using the <code>--disable</code> flag</a>&quot;</td></tr><tr><td><code>--disable-scheduler</code></td><td>Disable Kubernetes default scheduler</td></tr><tr><td><code>--disable-cloud-controller</code></td><td>Disable k3s default cloud controller manager</td></tr><tr><td><code>--disable-kube-proxy</code></td><td>Disable running kube-proxy</td></tr><tr><td><code>--disable-network-policy</code></td><td>Disable k3s default network policy controller</td></tr><tr><td><code>--disable-helm-controller</code></td><td>Disable Helm controller</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="customized-flags-for-kubernetes-processes">Customized Flags for Kubernetes Processes<a href="#customized-flags-for-kubernetes-processes" class="hash-link" aria-label="Direct link to Customized Flags for Kubernetes Processes" title="Direct link to Customized Flags for Kubernetes Processes">​</a></h3>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--etcd-arg</code> value</td><td>Customized flag for etcd process</td></tr><tr><td><code>--kube-apiserver-arg</code> value</td><td>Customized flag for kube-apiserver process</td></tr><tr><td><code>--kube-scheduler-arg</code> value</td><td>Customized flag for kube-scheduler process</td></tr><tr><td><code>--kube-controller-manager-arg</code> value</td><td>Customized flag for kube-controller-manager process</td></tr><tr><td><code>--kube-cloud-controller-manager-arg</code> value</td><td>Customized flag for kube-cloud-controller-manager process</td></tr><tr><td><code>--kubelet-arg</code> value</td><td>Customized flag for kubelet process</td></tr><tr><td><code>--kube-proxy-arg</code> value</td><td>Customized flag for kube-proxy process</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="experimental-options">Experimental Options<a href="#experimental-options" class="hash-link" aria-label="Direct link to Experimental Options" title="Direct link to Experimental Options">​</a></h3>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--rootless</code></td><td>Run rootless</td></tr><tr><td><code>--enable-pprof</code></td><td>Enable pprof endpoint on supervisor port</td></tr><tr><td><code>--docker</code></td><td>Use cri-dockerd instead of containerd</td></tr><tr><td><code>--prefer-bundled-bin</code></td><td>Prefer bundled userspace binaries over host binaries</td></tr><tr><td><code>--disable-agent</code></td><td>See &quot;<a href="/advanced#running-agentless-servers-experimental">Running Agentless Servers</a>&quot;</td></tr><tr><td><code>--embedded-registry</code></td><td>See &quot;<a href="/installation/registry-mirror">Embedded Registry Mirror</a>&quot;</td></tr><tr><td><code>--vpn-auth</code></td><td>See &quot;<a href="/networking/distributed-multicloud#integration-with-the-tailscale-vpn-provider-experimental">Integration with the Tailscale VPN provider</a>&quot;</td></tr><tr><td><code>--vpn-auth-file</code></td><td>See &quot;<a href="/networking/distributed-multicloud#integration-with-the-tailscale-vpn-provider-experimental">Integration with the Tailscale VPN provider</a>&quot;</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deprecated-options">Deprecated Options<a href="#deprecated-options" class="hash-link" aria-label="Direct link to Deprecated Options" title="Direct link to Deprecated Options">​</a></h3>
<table><thead><tr><th>Flag</th><th>Environment Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>--no-flannel</code></td><td>N/A</td><td>Use <code>--flannel-backend=none</code></td></tr><tr><td><code>--no-deploy</code> value</td><td>N/A</td><td>Use <code>--disable</code></td></tr><tr><td><code>--cluster-secret</code> value</td><td><code>K3S_CLUSTER_SECRET</code></td><td>Use <code>--token</code></td></tr><tr><td><code>--flannel-backend</code> wireguard</td><td>N/A</td><td>Use <code>--flannel-backend=wireguard-native</code></td></tr><tr><td><code>--flannel-backend</code> value=option1=value</td><td>N/A</td><td>Use <code>--flannel-conf</code> to specify the flannel config file with the backend config</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="k3s-server-cli-help">K3s Server CLI Help<a href="#k3s-server-cli-help" class="hash-link" aria-label="Direct link to K3s Server CLI Help" title="Direct link to K3s Server CLI Help">​</a></h2>
<blockquote>
<p>If an option appears in brackets below, for example <code>[$K3S_TOKEN]</code>, it means that the option can be passed in as an environment variable of that name.</p>
</blockquote>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   k3s server - Run management server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">USAGE:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   k3s server [OPTIONS]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">OPTIONS:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --config FILE, -c FILE                     (config) Load configuration from FILE (default: &quot;/etc/rancher/k3s/config.yaml&quot;) [$K3S_CONFIG_FILE]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --debug                                    (logging) Turn on debug logs [$K3S_DEBUG]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   -v value                                   (logging) Number for the log level verbosity (default: 0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --vmodule value                            (logging) Comma-separated list of FILE_PATTERN=LOG_LEVEL settings for file-filtered logging</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --log value, -l value                      (logging) Log to file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --alsologtostderr                          (logging) Log to standard error as well as file (if set)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --bind-address value                       (listener) k3s bind address (default: 0.0.0.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --https-listen-port value                  (listener) HTTPS listen port (default: 6443)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --advertise-address value                  (listener) IPv4/IPv6 address that apiserver uses to advertise to members of the cluster (default: node-external-ip/node-ip)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --advertise-port value                     (listener) Port that apiserver uses to advertise to members of the cluster (default: listen-port) (default: 0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --tls-san value                            (listener) Add additional hostnames or IPv4/IPv6 addresses as Subject Alternative Names on the server TLS cert</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --tls-san-security                         (listener) Protect the server TLS cert by refusing to add Subject Alternative Names not associated with the kubernetes apiserver service, server nodes, or values of the tls-san option (default: true)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --data-dir value, -d value                 (data) Folder to hold state default /var/lib/rancher/k3s or ${HOME}/.rancher/k3s if not root [$K3S_DATA_DIR]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --cluster-cidr value                       (networking) IPv4/IPv6 network CIDRs to use for pod IPs (default: 10.42.0.0/16)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --service-cidr value                       (networking) IPv4/IPv6 network CIDRs to use for service IPs (default: 10.43.0.0/16)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --service-node-port-range value            (networking) Port range to reserve for services with NodePort visibility (default: &quot;30000-32767&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --cluster-dns value                        (networking) IPv4 Cluster IP for coredns service. Should be in your service-cidr range (default: 10.43.0.10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --cluster-domain value                     (networking) Cluster Domain (default: &quot;cluster.local&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --flannel-backend value                    (networking) Backend (valid values: &#x27;none&#x27;, &#x27;vxlan&#x27;, &#x27;host-gw&#x27;, &#x27;wireguard-native&#x27; (default: &quot;vxlan&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --flannel-ipv6-masq                        (networking) Enable IPv6 masquerading for pod</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --flannel-external-ip                      (networking) Use node external IP addresses for Flannel traffic</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --egress-selector-mode value               (networking) One of &#x27;agent&#x27;, &#x27;cluster&#x27;, &#x27;pod&#x27;, &#x27;disabled&#x27; (default: &quot;agent&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --servicelb-namespace value                (networking) Namespace of the pods for the servicelb component (default: &quot;kube-system&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --write-kubeconfig value, -o value         (client) Write kubeconfig for admin client to this file [$K3S_KUBECONFIG_OUTPUT]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --write-kubeconfig-mode value              (client) Write kubeconfig with this mode [$K3S_KUBECONFIG_MODE]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --write-kubeconfig-group value             (client) Write kubeconfig with this group [$K3S_KUBECONFIG_GROUP]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --helm-job-image value                     (helm) Default image to use for helm jobs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --token value, -t value                    (cluster) Shared secret used to join a server or agent to a cluster [$K3S_TOKEN]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --token-file value                         (cluster) File containing the token [$K3S_TOKEN_FILE]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --agent-token value                        (cluster) Shared secret used to join agents to the cluster, but not servers [$K3S_AGENT_TOKEN]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --agent-token-file value                   (cluster) File containing the agent secret [$K3S_AGENT_TOKEN_FILE]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --server value, -s value                   (cluster) Server to connect to, used to join a cluster [$K3S_URL]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --cluster-init                             (cluster) Initialize a new cluster using embedded Etcd [$K3S_CLUSTER_INIT]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --cluster-reset                            (cluster) Forget all peers and become sole member of a new cluster [$K3S_CLUSTER_RESET]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --cluster-reset-restore-path value         (db) Path to snapshot file to be restored</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --kube-apiserver-arg value                 (flags) Customized flag for kube-apiserver process</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-arg value                           (flags) Customized flag for etcd process</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --kube-controller-manager-arg value        (flags) Customized flag for kube-controller-manager process</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --kube-scheduler-arg value                 (flags) Customized flag for kube-scheduler process</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --kube-cloud-controller-manager-arg value  (flags) Customized flag for kube-cloud-controller-manager process</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --datastore-endpoint value                 (db) Specify etcd, NATS, MySQL, Postgres, or SQLite (default) data source name [$K3S_DATASTORE_ENDPOINT]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --datastore-cafile value                   (db) TLS Certificate Authority file used to secure datastore backend communication [$K3S_DATASTORE_CAFILE]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --datastore-certfile value                 (db) TLS certification file used to secure datastore backend communication [$K3S_DATASTORE_CERTFILE]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --datastore-keyfile value                  (db) TLS key file used to secure datastore backend communication [$K3S_DATASTORE_KEYFILE]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-expose-metrics                      (db) Expose etcd metrics to client interface. (default: false)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-disable-snapshots                   (db) Disable automatic etcd snapshots</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-snapshot-name value                 (db) Set the base name of etcd snapshots (default: etcd-snapshot-&lt;unix-timestamp&gt;) (default: &quot;etcd-snapshot&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-snapshot-schedule-cron value        (db) Snapshot interval time in cron spec. eg. every 5 hours &#x27;0 */5 * * *&#x27; (default: &quot;0 */12 * * *&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-snapshot-retention value            (db) Number of snapshots to retain (default: 5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-snapshot-dir value                  (db) Directory to save db snapshots. (default: ${data-dir}/db/snapshots)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-snapshot-compress                   (db) Compress etcd snapshot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3                                  (db) Enable backup to S3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-endpoint value                   (db) S3 endpoint url (default: &quot;s3.amazonaws.com&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-endpoint-ca value                (db) S3 custom CA cert to connect to S3 endpoint</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-skip-ssl-verify                  (db) Disables S3 SSL certificate validation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-access-key value                 (db) S3 access key [$AWS_ACCESS_KEY_ID]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-secret-key value                 (db) S3 secret key [$AWS_SECRET_ACCESS_KEY]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-bucket value                     (db) S3 bucket name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-region value                     (db) S3 region / bucket location (optional) (default: &quot;us-east-1&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-folder value                     (db) S3 folder</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-proxy value                      (db) Proxy server to use when connecting to S3, overriding any proxy-releated environment variables</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-config-secret value              (db) Name of secret in the kube-system namespace used to configure S3, if etcd-s3 is enabled and no other etcd-s3 options are set</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-insecure                         (db) Disables S3 over HTTPS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --etcd-s3-timeout value                    (db) S3 timeout (default: 5m0s)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --default-local-storage-path value         (storage) Default local storage path for local provisioner storage class</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --disable value                            (components) Do not deploy packaged components and delete any deployed components (valid items: coredns, servicelb, traefik, local-storage, metrics-server, runtimes)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --disable-scheduler                        (components) Disable Kubernetes default scheduler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --disable-cloud-controller                 (components) Disable k3s default cloud controller manager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --disable-kube-proxy                       (components) Disable running kube-proxy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --disable-network-policy                   (components) Disable k3s default network policy controller</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --disable-helm-controller                  (components) Disable Helm controller</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --embedded-registry                        (experimental/components) Enable embedded distributed container registry; requires use of embedded containerd; when enabled agents will also listen on the supervisor port</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --supervisor-metrics                       (experimental/components) Enable serving k3s internal metrics on the supervisor port; when enabled agents will also listen on the supervisor port</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --node-name value                          (agent/node) Node name [$K3S_NODE_NAME]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --with-node-id                             (agent/node) Append id to node name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --node-label value                         (agent/node) Registering and starting kubelet with set of labels</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --node-taint value                         (agent/node) Registering kubelet with set of taints</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --image-credential-provider-bin-dir value  (agent/node) The path to the directory where credential provider plugin binaries are located (default: &quot;/var/lib/rancher/credentialprovider/bin&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --image-credential-provider-config value   (agent/node) The path to the credential provider plugin config file (default: &quot;/var/lib/rancher/credentialprovider/config.yaml&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --docker                                   (agent/runtime) (experimental) Use cri-dockerd instead of containerd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --container-runtime-endpoint value         (agent/runtime) Disable embedded containerd and use the CRI socket at the given path; when used with --docker this sets the docker socket path</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --default-runtime value                    (agent/runtime) Set the default runtime in containerd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --image-service-endpoint value             (agent/runtime) Disable embedded containerd image service and use remote image service socket at the given path. If not specified, defaults to --container-runtime-endpoint.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --disable-default-registry-endpoint        (agent/containerd) Disables containerd fallback default registry endpoint when a mirror is configured for that registry</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --nonroot-devices                          (agent/containerd) Allows non-root pods to access devices by setting device_ownership_from_security_context=true in the containerd CRI config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --pause-image value                        (agent/runtime) Customized pause image for containerd or docker sandbox (default: &quot;rancher/mirrored-pause:3.6&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --snapshotter value                        (agent/runtime) Override default containerd snapshotter (default: &quot;overlayfs&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --private-registry value                   (agent/runtime) Private registry configuration file (default: &quot;/etc/rancher/k3s/registries.yaml&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --system-default-registry value            (agent/runtime) Private registry to be used for all system images [$K3S_SYSTEM_DEFAULT_REGISTRY]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --node-ip value, -i value                  (agent/networking) IPv4/IPv6 addresses to advertise for node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --node-external-ip value                   (agent/networking) IPv4/IPv6 external IP addresses to advertise for node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --node-internal-dns value                  (agent/networking) internal DNS addresses to advertise for node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --node-external-dns value                  (agent/networking) external DNS addresses to advertise for node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --resolv-conf value                        (agent/networking) Kubelet resolv.conf file [$K3S_RESOLV_CONF]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --flannel-iface value                      (agent/networking) Override default flannel interface</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --flannel-conf value                       (agent/networking) Override default flannel config file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --flannel-cni-conf value                   (agent/networking) Override default flannel cni config file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --vpn-auth value                           (agent/networking) (experimental) Credentials for the VPN provider. It must include the provider name and join key in the format name=&lt;vpn-provider&gt;,joinKey=&lt;key&gt;[,controlServerURL=&lt;url&gt;][,extraArgs=&lt;args&gt;] [$K3S_VPN_AUTH]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --vpn-auth-file value                      (agent/networking) (experimental) File containing credentials for the VPN provider. It must include the provider name and join key in the format name=&lt;vpn-provider&gt;,joinKey=&lt;key&gt;[,controlServerURL=&lt;url&gt;][,extraArgs=&lt;args&gt;] [$K3S_VPN_AUTH_FILE]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --kubelet-arg value                        (agent/flags) Customized flag for kubelet process</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --kube-proxy-arg value                     (agent/flags) Customized flag for kube-proxy process</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --protect-kernel-defaults                  (agent/node) Kernel tuning behavior. If set, error if kernel tunables are different than kubelet defaults.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --secrets-encryption                       Enable secret encryption at rest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --enable-pprof                             (experimental) Enable pprof endpoint on supervisor port</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --rootless                                 (experimental) Run rootless</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --prefer-bundled-bin                       (experimental) Prefer bundled userspace binaries over host binaries</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --selinux                                  (agent/node) Enable SELinux in containerd [$K3S_SELINUX]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --lb-server-port value                     (agent/node) Local port for supervisor client load-balancer. If the supervisor and apiserver are not colocated an additional port 1 less than this port will also be used for the apiserver client load-balancer. (default: 6444) [$K3S_LB_SERVER_PORT]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/k3s-io/docs/edit/main/docs/cli/server.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-04-03T14:24:04.000Z" itemprop="dateModified">Apr 3, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cli"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">CLI Tools</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cli/agent"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">agent</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#critical-configuration-values" class="table-of-contents__link toc-highlight">Critical Configuration Values</a></li><li><a href="#commonly-used-options" class="table-of-contents__link toc-highlight">Commonly Used Options</a><ul><li><a href="#database" class="table-of-contents__link toc-highlight">Database</a></li><li><a href="#cluster-options" class="table-of-contents__link toc-highlight">Cluster Options</a></li><li><a href="#admin-kubeconfig-options" class="table-of-contents__link toc-highlight">Admin Kubeconfig Options</a></li></ul></li><li><a href="#advanced-options" class="table-of-contents__link toc-highlight">Advanced Options</a><ul><li><a href="#logging" class="table-of-contents__link toc-highlight">Logging</a></li><li><a href="#listeners" class="table-of-contents__link toc-highlight">Listeners</a></li><li><a href="#data" class="table-of-contents__link toc-highlight">Data</a></li><li><a href="#secrets-encryption" class="table-of-contents__link toc-highlight">Secrets Encryption</a></li><li><a href="#networking" class="table-of-contents__link toc-highlight">Networking</a></li><li><a href="#storage-class" class="table-of-contents__link toc-highlight">Storage Class</a></li><li><a href="#kubernetes-components" class="table-of-contents__link toc-highlight">Kubernetes Components</a></li><li><a href="#customized-flags-for-kubernetes-processes" class="table-of-contents__link toc-highlight">Customized Flags for Kubernetes Processes</a></li><li><a href="#experimental-options" class="table-of-contents__link toc-highlight">Experimental Options</a></li><li><a href="#deprecated-options" class="table-of-contents__link toc-highlight">Deprecated Options</a></li></ul></li><li><a href="#k3s-server-cli-help" class="table-of-contents__link toc-highlight">K3s Server CLI Help</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 K3s Project Authors. All rights reserved. <br>The Linux Foundation has registered trademarks
      and uses trademarks. For a list of trademarks of The Linux Foundation, 
      please see our <a href="https://www.linuxfoundation.org/trademark-usage"> Trademark Usage</a> page.</div></div></div></footer></div>
</body>
</html>