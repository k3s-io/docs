<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cli/token" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">token | K3s</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.k3s.io/cli/token"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" property="og:locale:alternate" content="kr"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="token | K3s"><meta data-rh="true" name="description" content="K3s uses tokens to secure the node join process and to encrypt confidential information that is persisted to the datastore. Tokens authenticate the cluster to the joining node, and the node to the cluster."><meta data-rh="true" property="og:description" content="K3s uses tokens to secure the node join process and to encrypt confidential information that is persisted to the datastore. Tokens authenticate the cluster to the joining node, and the node to the cluster."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.k3s.io/cli/token"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/cli/token" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/zh/cli/token" hreflang="zh"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/kr/cli/token" hreflang="kr"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/ja/cli/token" hreflang="ja"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/cli/token" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.4c3c3332.css">
<script src="/assets/js/runtime~main.694cceaa.js" defer="defer"></script>
<script src="/assets/js/main.1dd1ef64.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/k3s-logo-light.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/k3s-logo-dark.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/cli/token" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh/cli/token" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li><li><a href="/kr/cli/token" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="kr">한국어</a></li><li><a href="/ja/cli/token" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li></ul></div><a href="https://github.com/k3s-io/k3s/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn">GitHub</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">K3s - Lightweight Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quick-start">Quick-Start Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/installation">Installation</a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/datastore">Cluster Datastore</a><button aria-label="Expand sidebar category &#x27;Cluster Datastore&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/upgrades">Upgrades</a><button aria-label="Expand sidebar category &#x27;Upgrades&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/security">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/cli">CLI Tools</a><button aria-label="Collapse sidebar category &#x27;CLI Tools&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/server">server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/agent">agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/certificate">certificate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/etcd-snapshot">etcd-snapshot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/secrets-encrypt">secrets-encrypt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cli/token">token</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cluster-access">Cluster Access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/storage">Volumes and Storage</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/networking">Networking</a><button aria-label="Expand sidebar category &#x27;Networking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/helm">Helm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/advanced">Advanced Options / Configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/reference/env-variables">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/release-notes/v1.31.X">Release Notes</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/related-projects">Related Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/known-issues">Known Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/faq">FAQ</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cli"><span itemprop="name">CLI Tools</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">token</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>k3s token</h1></header>
<p>K3s uses tokens to secure the node join process and to encrypt confidential information that is persisted to the datastore. Tokens authenticate the cluster to the joining node, and the node to the cluster.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="token-format">Token Format<a href="#token-format" class="hash-link" aria-label="Direct link to Token Format" title="Direct link to Token Format">​</a></h2>
<p>K3s tokens can be specified in either secure or short format. The secure format is preferred, as it enables the client to authenticate the identity of the cluster it is joining, before sending credentials.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secure">Secure<a href="#secure" class="hash-link" aria-label="Direct link to Secure" title="Direct link to Secure">​</a></h3>
<p>The secure token format (occasionally referred to as a &quot;full&quot; token) contains the following parts:</p>
<p><code>&lt;prefix&gt;&lt;cluster CA hash&gt;::&lt;credentials&gt;</code></p>
<ul>
<li><code>prefix</code>: a fixed <code>K10</code> prefix that identifies the token format</li>
<li><code>cluster CA hash</code>: The hash of the cluster&#x27;s server CA certificate, used to authenticate the server to the joining node.<!-- -->
<ul>
<li>For self-signed CA certificates, this is the SHA256 sum of the PEM-formatted certificate, as stored on disk.</li>
<li>For custom CA certificates, this is the SHA256 sum of the DER encoding of the root certificate; commonly known as the certificate fingerprint.</li>
</ul>
</li>
<li><code>credentials</code>: The username and password, or bearer token, used to authenticate the joining node to the cluster.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tls-bootstrapping">TLS Bootstrapping<a href="#tls-bootstrapping" class="hash-link" aria-label="Direct link to TLS Bootstrapping" title="Direct link to TLS Bootstrapping">​</a></h4>
<p>When a secure token is specified, the joining node performs the following steps to validate the identity of the server it has connected to, before transmitting credentials:</p>
<ol>
<li>With TLS verification disabled, download the CA bundle from <code>/cacerts</code> on the server it is joining.</li>
<li>Calculate the SHA256 hash of the CA certificate, as described above.</li>
<li>Compare the calculated SHA256 hash to the hash from the token.</li>
<li>If the hash matches, validate that the certificate presented by the server can be validated by the server&#x27;s CA bundle.</li>
<li>If the server certificate is valid, present credentials to join the cluster using either basic or bearer token authentication, depending on the token type.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="short">Short<a href="#short" class="hash-link" aria-label="Direct link to Short" title="Direct link to Short">​</a></h3>
<p>The short token format includes only the password or bearer token used to authenticate the joining node to the cluster.</p>
<p>If a short token is used, the joining node implicitly trusts the CA bundle presented by the server; steps 2-4 in the TLS Bootstrapping process are skipped. The initial connection may be vulnerable to <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" target="_blank" rel="noopener noreferrer">man-in-the-middle</a> attack.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="token-types">Token Types<a href="#token-types" class="hash-link" aria-label="Direct link to Token Types" title="Direct link to Token Types">​</a></h2>
<p>K3s supports three types of tokens. Only the server token is available by default; additional token types must be configured or created by the administrator.</p>
<table><thead><tr><th>Type</th><th>CLI Option</th><th>Environment Variable</th></tr></thead><tbody><tr><td>Server</td><td><code>--token</code></td><td><code>K3S_TOKEN</code></td></tr><tr><td>Agent</td><td><code>--agent-token</code></td><td><code>K3S_AGENT_TOKEN</code></td></tr><tr><td>Bootstrap</td><td><code>n/a</code></td><td><code>n/a</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="server">Server<a href="#server" class="hash-link" aria-label="Direct link to Server" title="Direct link to Server">​</a></h3>
<p>If no token is provided when starting the first server in the cluster, one is created with a random password. The server token is always written to <code>/var/lib/rancher/k3s/server/token</code>, in secure format.</p>
<p>The server token can be used to join both server and agent nodes to the cluster. Anyone with access to the server token essentially has full administrator access to the cluster. This token should be guarded carefully.</p>
<p>The server token is also used as the <a href="https://en.wikipedia.org/wiki/PBKDF2" target="_blank" rel="noopener noreferrer">PBKDF2</a> passphrase to encrypt confidential information that is persisted to the datastore known as bootstrap data. Bootstrap data is essential to set up new server nodes or restore from a snapshot. For this reason, the token must be backed up alongside the cluster datastore itself.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Unless custom CA certificates are in use, only the short (password-only) token format can be used when starting the first server in the cluster. This is because the cluster CA hash cannot be known until after the server has generated the self-signed cluster CA certificates.</p></div></div>
<p>For more information on using custom CA certificates, see the <a href="/cli/certificate"><code>k3s certificate</code> documentation</a>.<br>
<!-- -->For more information on backing up your cluster, see the <a href="/datastore/backup-restore">Backup and Restore</a> documentation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="agent">Agent<a href="#agent" class="hash-link" aria-label="Direct link to Agent" title="Direct link to Agent">​</a></h3>
<p>By default, the agent token is the same as the server token. The agent token can be set before or after the cluster has been started, by changing the CLI option or environment variable on all servers in the cluster. The agent token is similar to the server token in that is it statically configured, and does not expire.</p>
<p>The agent token is written to <code>/var/lib/rancher/k3s/server/agent-token</code>, in secure format. If no agent token is specified, this file is a link to the server token.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bootstrap">Bootstrap<a href="#bootstrap" class="hash-link" aria-label="Direct link to Bootstrap" title="Direct link to Bootstrap">​</a></h3>
<p>K3s supports dynamically generated, automatically expiring agent <a href="https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/" target="_blank" rel="noopener noreferrer">bootstrap tokens</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="k3s-token-1">k3s token<a href="#k3s-token-1" class="hash-link" aria-label="Direct link to k3s token" title="Direct link to k3s token">​</a></h2>
<p>K3s bootstrap tokens use the same generation and validation code as <code>kubeadm token</code> bootstrap tokens, and the <code>k3s token</code> CLI is similar.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   k3s token - Manage bootstrap tokens</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">USAGE:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   k3s token command [command options] [arguments...]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">COMMANDS:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   create    Create bootstrap tokens on the server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   delete    Delete bootstrap tokens on the server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   generate  Generate and print a bootstrap token, but do not create it on the server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   list      List bootstrap tokens on the server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   rotate    Rotate original server token with a new bootstrap token</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">OPTIONS:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   --help, -h  show help</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="k3s-token-create-token"><code>k3s token create [token]</code><a href="#k3s-token-create-token" class="hash-link" aria-label="Direct link to k3s-token-create-token" title="Direct link to k3s-token-create-token">​</a></h4>
<p>Create a new token. The <code>[token]</code> is the actual token to write, as generated by <code>k3s token generate</code>. If no token is given, a random one will be generated.</p>
<p>A token in secure format, including the cluster CA hash, will be written to stdout. The output of this command should be saved, as the secret portion of the token cannot be shown again.</p>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--data-dir</code> value</td><td>Folder to hold state (default: /var/lib/rancher/k3s or ${HOME}/.rancher/k3s if not root)</td></tr><tr><td><code>--kubeconfig</code> value</td><td>Server to connect to [$KUBECONFIG]</td></tr><tr><td><code>--description</code> value</td><td>A human friendly description of how this token is used</td></tr><tr><td><code>--groups</code> value</td><td>Extra groups that this token will authenticate as when used for authentication. (default: Default: &quot;system:bootstrappers:k3s<!-- -->:default-node-token<!-- -->&quot;)</td></tr><tr><td><code>--ttl</code> value</td><td>The duration before the token is automatically deleted (e.g. 1s, 2m, 3h). If set to &#x27;0&#x27;, the token will never expire (default: 24h0m0s)</td></tr><tr><td><code>--usages</code> value</td><td>Describes the ways in which this token can be used. (default: &quot;signing,authentication&quot;)</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="k3s-token-delete"><code>k3s token delete</code><a href="#k3s-token-delete" class="hash-link" aria-label="Direct link to k3s-token-delete" title="Direct link to k3s-token-delete">​</a></h4>
<p>Delete one or more tokens. The full token can be provided, or just the token ID.</p>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--data-dir</code> value</td><td>Folder to hold state (default: /var/lib/rancher/k3s or ${HOME}/.rancher/k3s if not root)</td></tr><tr><td><code>--kubeconfig</code> value</td><td>Server to connect to [$KUBECONFIG]</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="k3s-token-generate"><code>k3s token generate</code><a href="#k3s-token-generate" class="hash-link" aria-label="Direct link to k3s-token-generate" title="Direct link to k3s-token-generate">​</a></h4>
<p>Generate a randomly-generated bootstrap token.</p>
<p>You don&#x27;t have to use this command in order to generate a token. You can do so yourself as long as it is in the format <code>[a-z0-9]{6}.[a-z0-9]{16}</code>, where the first portion is the token ID, and the second portion is the secret.</p>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--data-dir</code> value</td><td>Folder to hold state (default: /var/lib/rancher/k3s or ${HOME}/.rancher/k3s if not root)</td></tr><tr><td><code>--kubeconfig</code> value</td><td>Server to connect to [$KUBECONFIG]</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="k3s-token-list"><code>k3s token list</code><a href="#k3s-token-list" class="hash-link" aria-label="Direct link to k3s-token-list" title="Direct link to k3s-token-list">​</a></h4>
<p>List bootstrap tokens, showing their ID, description, and remaining time-to-live.</p>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--data-dir</code> value</td><td>Folder to hold state (default: /var/lib/rancher/k3s or ${HOME}/.rancher/k3s if not root)</td></tr><tr><td><code>--kubeconfig</code> value</td><td>Server to connect to [$KUBECONFIG]</td></tr><tr><td><code>--output</code> value</td><td>Output format. Valid options: text, json (default: &quot;text&quot;)</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="k3s-token-rotate"><code>k3s token rotate</code><a href="#k3s-token-rotate" class="hash-link" aria-label="Direct link to k3s-token-rotate" title="Direct link to k3s-token-rotate">​</a></h4>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Version Gate</div><div class="admonitionContent_BuS1"><p>Available as of the October 2023 releases (v1.28.2+k3s1, v1.27.7+k3s1, v1.26.10+k3s1, v1.25.15+k3s1).</p></div></div>
<p>Rotate original server token with a new server token. After running this command, all servers and any agents that originally joined with the old token must be restarted with the new token.</p>
<p>If you do not specify a new token, one will be generated for you.</p>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--data-dir</code> value</td><td>Folder to hold state (default: /var/lib/rancher/k3s or ${HOME}/.rancher/k3s if not root)</td></tr><tr><td><code>--kubeconfig</code> value</td><td>Server to connect to [$KUBECONFIG]</td></tr><tr><td><code>--server</code> value</td><td>Server to connect to (default: &quot;<a href="https://127.0.0.1:6443" target="_blank" rel="noopener noreferrer">https://127.0.0.1:6443</a>&quot;) [$K3S_URL]</td></tr><tr><td><code>--token</code> value</td><td>Existing token used to join a server or agent to a cluster [$K3S_TOKEN]</td></tr><tr><td><code>--new-token</code> value</td><td>New token that replaces existing token</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Snapshots taken before the rotation will require the old server token when restoring the cluster</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/k3s-io/docs/edit/main/docs/cli/token.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-11-27T17:54:56.000Z" itemprop="dateModified">Nov 27, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cli/secrets-encrypt"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">secrets-encrypt</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/architecture"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Architecture</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#token-format" class="table-of-contents__link toc-highlight">Token Format</a><ul><li><a href="#secure" class="table-of-contents__link toc-highlight">Secure</a></li><li><a href="#short" class="table-of-contents__link toc-highlight">Short</a></li></ul></li><li><a href="#token-types" class="table-of-contents__link toc-highlight">Token Types</a><ul><li><a href="#server" class="table-of-contents__link toc-highlight">Server</a></li><li><a href="#agent" class="table-of-contents__link toc-highlight">Agent</a></li><li><a href="#bootstrap" class="table-of-contents__link toc-highlight">Bootstrap</a></li></ul></li><li><a href="#k3s-token-1" class="table-of-contents__link toc-highlight">k3s token</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 K3s Project Authors. All rights reserved. <br>The Linux Foundation has registered trademarks
      and uses trademarks. For a list of trademarks of The Linux Foundation, 
      please see our <a href="https://www.linuxfoundation.org/trademark-usage"> Trademark Usage</a> page.</div></div></div></footer></div>
</body>
</html>