<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cli/certificate" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">certificate | K3s</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.k3s.io/cli/certificate"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="certificate | K3s"><meta data-rh="true" name="description" content="Client and Server Certificates"><meta data-rh="true" property="og:description" content="Client and Server Certificates"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.k3s.io/cli/certificate"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/cli/certificate" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/zh/cli/certificate" hreflang="zh"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/ja/cli/certificate" hreflang="ja"><link data-rh="true" rel="alternate" href="https://docs.k3s.io/cli/certificate" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"CLI Tools","item":"https://docs.k3s.io/cli/"},{"@type":"ListItem","position":2,"name":"certificate","item":"https://docs.k3s.io/cli/certificate"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="K3s RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="K3s Atom Feed"><link rel="stylesheet" href="/assets/css/styles.5429bf62.css">
<script src="/assets/js/runtime~main.5645844c.js" defer="defer"></script>
<script src="/assets/js/main.57c92607.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/k3s-logo-light.svg"><link rel="preload" as="image" href="/img/k3s-logo-dark.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/k3s-logo-light.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/k3s-logo-dark.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/cli/certificate" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh/cli/certificate" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li><li><a href="/ja/cli/certificate" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li></ul></div><a class="navbar__item navbar__link navbar__icon navbar__blog" href="/blog">Blog</a><a href="https://github.com/k3s-io/k3s/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__icon navbar__github">GitHub</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/"><span title="K3s - Lightweight Kubernetes" class="linkLabel_WmDU">K3s - Lightweight Kubernetes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quick-start"><span title="Quick-Start Guide" class="linkLabel_WmDU">Quick-Start Guide</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/installation"><span title="Installation" class="categoryLinkLabel_W154">Installation</span></a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/datastore"><span title="Cluster Datastore" class="categoryLinkLabel_W154">Cluster Datastore</span></a><button aria-label="Expand sidebar category &#x27;Cluster Datastore&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/upgrades"><span title="Upgrades" class="categoryLinkLabel_W154">Upgrades</span></a><button aria-label="Expand sidebar category &#x27;Upgrades&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/security"><span title="Security" class="categoryLinkLabel_W154">Security</span></a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/cli"><span title="CLI Tools" class="categoryLinkLabel_W154">CLI Tools</span></a><button aria-label="Collapse sidebar category &#x27;CLI Tools&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/server"><span title="server" class="linkLabel_WmDU">server</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/agent"><span title="agent" class="linkLabel_WmDU">agent</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cli/certificate"><span title="certificate" class="linkLabel_WmDU">certificate</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/etcd-snapshot"><span title="etcd-snapshot" class="linkLabel_WmDU">etcd-snapshot</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/secrets-encrypt"><span title="secrets-encrypt" class="linkLabel_WmDU">secrets-encrypt</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli/token"><span title="token" class="linkLabel_WmDU">token</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/architecture"><span title="Architecture" class="linkLabel_WmDU">Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cluster-access"><span title="Cluster Access" class="linkLabel_WmDU">Cluster Access</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/storage"><span title="Volumes and Storage" class="linkLabel_WmDU">Volumes and Storage</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/import-images"><span title="Import Images" class="linkLabel_WmDU">Import Images</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/networking"><span title="Networking" class="categoryLinkLabel_W154">Networking</span></a><button aria-label="Expand sidebar category &#x27;Networking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/helm"><span title="Helm" class="linkLabel_WmDU">Helm</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/advanced"><span title="Advanced Options / Configuration" class="linkLabel_WmDU">Advanced Options / Configuration</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/reference/env-variables"><span title="Reference" class="categoryLinkLabel_W154">Reference</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/release-notes/v1.34.X"><span title="Release Notes" class="categoryLinkLabel_W154">Release Notes</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/related-projects"><span title="Related Projects" class="linkLabel_WmDU">Related Projects</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/known-issues"><span title="Known Issues" class="linkLabel_WmDU">Known Issues</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/faq"><span title="FAQ" class="linkLabel_WmDU">FAQ</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cli"><span>CLI Tools</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">certificate</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>k3s certificate</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="client-and-server-certificates">Client and Server Certificates<a href="#client-and-server-certificates" class="hash-link" aria-label="Direct link to Client and Server Certificates" title="Direct link to Client and Server Certificates" translate="no">​</a></h2>
<p>K3s client and server certificates are valid for 365 days from their date of issuance.
Any certificates that are expired or within 120 days of expiring are automatically renewed every time K3s starts.
This renewal reuses the existing keys, and extends the lifetime of the existing certificates.
If you want to generate new certificates and keys, instead of extending the validity of the existing certificates, use the <a href="#rotating-client-and-server-certificates"><code>rotate</code></a> subcommand documented below.</p>
<p>When a certificate is within 120 days of expiring a Kubernetes Warning Event with <code>reason: CertificateExpirationWarning</code> is created, with a relation to the Node using the certificate.</p>
<p>Prior to the May 2025 releases (v1.33.1+k3s1, v1.32.5+k3s1, v1.31.9+k3s1, v1.30.13+k3s1), alerts and rotation were triggered at 90 days, instead of 120 days.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="checking-expiration-dates">Checking expiration dates<a href="#checking-expiration-dates" class="hash-link" aria-label="Direct link to Checking expiration dates" title="Direct link to Checking expiration dates" translate="no">​</a></h3>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Version Gate</div><div class="admonitionContent_BuS1"><p>Output format is configurable as of the January 2025 releases: v1.32.0+k3s1, v1.31.5+k3s1, v1.30.9+k3s1, v1.30.13+k3s1<br>
A new format with more information is available as of the May 2025 releases: v1.33.1+k3s1, v1.32.5+k3s1, v1.31.9+k3s1, v1.29.13+k3s1</p></div></div>
<p>To check the node certificates and their expiration date use the <code>k3s certificate check --output table</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">FILENAME                    SUBJECT                     USAGES       EXPIRES                  RESIDUAL TIME   STATUS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--------                    -------                     ------       -------                  -------------   ------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">client-kube-proxy.crt       system:kube-proxy           ClientAuth   Jun 09, </span><span class="token number" style="color:rgb(247, 140, 108)">2026</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:17 UTC   </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> year          OK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">client-kube-proxy.crt       k3s-client-ca@1749464211    CertSign     Jun 07, </span><span class="token number" style="color:rgb(247, 140, 108)">2035</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:16 UTC   </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"> years        OK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">client-kubelet.crt          system:node:ip-10-11-0-14   ClientAuth   Jun 09, </span><span class="token number" style="color:rgb(247, 140, 108)">2026</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:17 UTC   </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> year          OK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">client-kubelet.crt          k3s-client-ca@1749464211    CertSign     Jun 07, </span><span class="token number" style="color:rgb(247, 140, 108)">2035</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:16 UTC   </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"> years        OK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">serving-kubelet.crt         ip-10-11-0-14               ServerAuth   Jun 09, </span><span class="token number" style="color:rgb(247, 140, 108)">2026</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:17 UTC   </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> year          OK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">serving-kubelet.crt         k3s-server-ca@1749464211    CertSign     Jun 07, </span><span class="token number" style="color:rgb(247, 140, 108)">2035</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:16 UTC   </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"> years        OK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">client-k3s-controller.crt   system:k3s-controller       ClientAuth   Jun 09, </span><span class="token number" style="color:rgb(247, 140, 108)">2026</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:17 UTC   </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> year          OK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">client-k3s-controller.crt   k3s-client-ca@1749464211    CertSign     Jun 07, </span><span class="token number" style="color:rgb(247, 140, 108)">2035</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:16 UTC   </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"> years        OK</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>SAME CERTIFICATE TWICE</div><div class="admonitionContent_BuS1"><p>Each certificate file (FILENAME column) contains at least two certificates - the leaf (or end entity) client/server certificate, any intermediate Certificate Authority certificates, and the root Certificate Authority certificate.</p></div></div>
<p>In case of unexpected output, please ensure that you are specifying the correct data directory with the <code>--data-dir</code> flag (if using a custom data directory), or use the <code>--debug</code> flag to get additional output from the check process.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rotating-client-and-server-certificates">Rotating Client and Server Certificates<a href="#rotating-client-and-server-certificates" class="hash-link" aria-label="Direct link to Rotating Client and Server Certificates" title="Direct link to Rotating Client and Server Certificates" translate="no">​</a></h3>
<p>To rotate client and server certificates manually, use the <code>k3s certificate rotate</code> subcommand:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Stop K3s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl stop k3s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Rotate certificates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k3s certificate rotate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Start K3s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl start k3s</span><br></span></code></pre></div></div>
<p>Individual or lists of certificates can be rotated by specifying the certificate name:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">k3s certificate rotate </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--service</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">SERVICE</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">,</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">SERVICE</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><br></span></code></pre></div></div>
<p>The following certificates can be rotated: <code>admin</code>, <code>api-server</code>, <code>controller-manager</code>, <code>scheduler</code>, <code>k3s-controller</code>, <code>k3s-server</code>, <code>cloud-controller</code>, <code>etcd</code>, <code>auth-proxy</code>, <code>kubelet</code>, <code>kube-proxy</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="certificate-authority-ca-certificates">Certificate Authority (CA) Certificates<a href="#certificate-authority-ca-certificates" class="hash-link" aria-label="Direct link to Certificate Authority (CA) Certificates" title="Direct link to Certificate Authority (CA) Certificates" translate="no">​</a></h2>
<p>Kubernetes requires a number of CA certificates for proper operation. For more information on how Kubernetes uses CA certificates, see the Kubernetes <a href="https://kubernetes.io/docs/setup/best-practices/certificates/#all-certificates" target="_blank" rel="noopener noreferrer">PKI Certificates and Requirements</a> documentation.</p>
<p>By default, K3s generates self-signed CA certificates during startup of the first server node. These CA certificates are valid for 10 years from date of issuance, and are not automatically renewed.</p>
<p>The authoritative CA certificates and keys are stored within the datastore&#x27;s bootstrap key, encrypted using the <a href="/cli/token#server">server token</a> as the PBKDF2 passphrase with AES256-GCM and HMAC-SHA1.
Copies of the CA certificates and keys are extracted to disk during K3s server startup.
Any server may generate leaf certificates for nodes as they join the cluster, and the Kubernetes <a href="https://kubernetes.io/docs/reference/access-authn-authz/certificate-signing-requests/" target="_blank" rel="noopener noreferrer">Certificates API</a> controllers may issue additional certificates at runtime.</p>
<p>To rotate CA certificates and keys, use the <code>k3s certificate rotate-ca</code> command.
The command performs integrity checks to confirm that the updated certificates and keys are usable.
If the updated data is acceptable, the datastore&#x27;s encrypted bootstrap key is updated, and the new certificates and keys will be used the next time K3s starts.
If problems are encountered while validating the certificates and keys, an error is reported to the system log and the operation is cancelled without changes.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Version Gate</div><div class="admonitionContent_BuS1"><p>Support for the <code>k3s certificate rotate-ca</code> command and the ability to use CA certificates signed by an external CA is available starting with the 2023-02 releases (v1.26.2+k3s1, v1.25.7+k3s1, v1.24.11+k3s1, v1.23.17+k3s1).</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-custom-ca-certificates">Using Custom CA Certificates<a href="#using-custom-ca-certificates" class="hash-link" aria-label="Direct link to Using Custom CA Certificates" title="Direct link to Using Custom CA Certificates" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cautions-against-ca-reuse">Cautions Against CA Reuse<a href="#cautions-against-ca-reuse" class="hash-link" aria-label="Direct link to Cautions Against CA Reuse" title="Direct link to Cautions Against CA Reuse" translate="no">​</a></h4>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>It is not recommended to share Root or Intermediate CAs across multiple clusters, or to use an existing private CA as your cluster CA.</p></div></div>
<p>When multiple clusters share a common root of trust, any client or server certificates issued by one cluster will also be trusted by all other clusters, as all certificates chain up to the same trust anchor - the common Root Certificate Authority.
This means that any user with a valid client certificate (or kubeconfig) for one cluster will also be able to authenticate to other clusters, and any RBAC that matches a client&#x27;s user or group will also be applied in those other clusters.
Similarly, server certificates issued by one cluster will also be trusted in all other clusters, and by all other infrastructure or clients that trust that root CA.</p>
<p>Kubernetes does not support use of Certificate Revocation Lists.
If you ever need to revoke a certificate for any reason (for example, due to a compromised admin kubeconfig), you must perform a full replacement of the cluster Certificate Authority in order to invalidate the certificate&#x27;s trust.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-custom-ca-certificates-1">Using Custom CA Certificates<a href="#using-custom-ca-certificates-1" class="hash-link" aria-label="Direct link to Using Custom CA Certificates" title="Direct link to Using Custom CA Certificates" translate="no">​</a></h4>
<p>If CA certificates and keys are found the correct location during initial startup of the first server in the cluster, automatic generation of CA certificates will be bypassed.</p>
<p>An example script to pre-create the appropriate certificates and keys is available <a href="https://github.com/k3s-io/k3s/blob/main/contrib/util/generate-custom-ca-certs.sh" target="_blank" rel="noopener noreferrer">in the K3s repo at <code>contrib/util/generate-custom-ca-certs.sh</code></a>.
This script should be run prior to starting K3s for the first time, and will create a full set of leaf CA certificates signed by common Root and Intermediate CA certificates.
If you have an existing Root or Intermediate CA, this script can be used (or used as a starting point) to create the correct CA certificates to provision a K3s cluster with PKI rooted in an existing authority.</p>
<p>Custom Certificate Authority files must be placed in <code>/var/lib/rancher/k3s/server/tls</code>. The following files are required:</p>
<ul>
<li><code>server-ca.crt</code></li>
<li><code>server-ca.key</code></li>
<li><code>client-ca.crt</code></li>
<li><code>client-ca.key</code></li>
<li><code>request-header-ca.crt</code></li>
<li><code>request-header-ca.key</code><br>
<em>// note: etcd files are required even if embedded etcd is not in use.</em></li>
<li><code>etcd/peer-ca.crt</code></li>
<li><code>etcd/peer-ca.key</code></li>
<li><code>etcd/server-ca.crt</code></li>
<li><code>etcd/server-ca.key</code><br>
<em>// note: This is the private key used to sign service-account tokens. It does not have a corresponding certificate.</em></li>
<li><code>service.key</code></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="custom-ca-topology">Custom CA Topology<a href="#custom-ca-topology" class="hash-link" aria-label="Direct link to Custom CA Topology" title="Direct link to Custom CA Topology" translate="no">​</a></h4>
<p>Custom CA Certificates generated by the example script will have the following topology:</p>
<!-- -->
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-example-script">Using the Example Script<a href="#using-the-example-script" class="hash-link" aria-label="Direct link to Using the Example Script" title="Direct link to Using the Example Script" translate="no">​</a></h4>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Important</div><div class="admonitionContent_BuS1"><p>If you want to sign the cluster CA certificates with an existing root CA using the example script, you must place the root and intermediate files in the target directory prior to running the script.
If the files do not exist, the script will create new root and intermediate CA certificates.</p></div></div>
<p>If you want to use only an existing root CA certificate, provide the following files:</p>
<ul>
<li><code>root-ca.pem</code></li>
<li><code>root-ca.key</code></li>
</ul>
<p>If you want to use existing root and intermediate CA certificates, provide the following files:</p>
<ul>
<li><code>root-ca.pem</code></li>
<li><code>intermediate-ca.pem</code></li>
<li><code>intermediate-ca.key</code></li>
</ul>
<p>The example script uses the provided CAs as the root for all cluster CA bundles - Server, Client, API Aggregation, and etcd Peer/Server.
For advanced use cases, such as using the provided CAs for only select bundles, or using different CAs for different bundles, the example script should be modified to meet the specific needs of your organization.</p>
<p>To use the example script to generate custom certs and keys before starting K3s, run the following commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Create the target directory for cert generation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">-p</span><span class="token plain"> /var/lib/rancher/k3s/server/tls</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Copy your root CA cert and intermediate CA cert+key into the correct location for the script.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># For the purposes of this example, we assume you have existing root and intermediate CA files in /etc/ssl.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># If you do not have an existing root and/or intermediate CA, the script will generate them for you.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> /etc/ssl/certs/root-ca.pem /etc/ssl/certs/intermediate-ca.pem /etc/ssl/private/intermediate-ca.key /var/lib/rancher/k3s/server/tls</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate custom CA certs and keys.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">-sL</span><span class="token plain"> https://github.com/k3s-io/k3s/raw/main/contrib/util/generate-custom-ca-certs.sh </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> -</span><br></span></code></pre></div></div>
<p>If the command completes successfully, you may install and/or start K3s for the first time.
If the script generated root and/or intermediate CA files, you should back up these files so that they can be reused if it is necessary to rotate the CA certificates at a later date.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rotating-custom-ca-certificates">Rotating Custom CA Certificates<a href="#rotating-custom-ca-certificates" class="hash-link" aria-label="Direct link to Rotating Custom CA Certificates" title="Direct link to Rotating Custom CA Certificates" translate="no">​</a></h3>
<p>To rotate custom CA certificates, use the <code>k3s certificate rotate-ca</code> subcommand.
Updated files must be staged into a temporary directory, loaded into the datastore, and k3s must be restarted on all nodes to use the updated certificates.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>You must not overwrite the currently in-use data in <code>/var/lib/rancher/k3s/server/tls</code>.<br>
<!-- -->Stage the updated certificates and keys into a separate directory.</p></div></div>
<p>A cluster that has been started with custom CA certificates can renew or rotate the CA certificates and keys non-disruptively, as long as the same root CA is used.</p>
<p>If a new root CA is required, the rotation will be disruptive. The <code>k3s certificate rotate-ca --force</code> option must be used, all nodes that were joined with a <a href="/cli/token#secure">secure token</a> (including servers) will need to be reconfigured to use the new token value, and pods will need to be restarted to trust the new root CA.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-example-script-1">Using the Example Script<a href="#using-the-example-script-1" class="hash-link" aria-label="Direct link to Using the Example Script" title="Direct link to Using the Example Script" translate="no">​</a></h4>
<p>The example <code>generate-custom-ca-certs.sh</code> script linked above can also be used to generate updated certs in a new temporary directory, by copying files into the correct location and setting the <code>DATA_DIR</code> environment variable.
To use the example script to generate updated certs and keys, run the following commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Create a temporary directory for cert generation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">-p</span><span class="token plain"> /opt/k3s/server/tls</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Copy your root CA cert and intermediate CA cert+key into the correct location for the script.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Non-disruptive rotation requires the same root CA that was used to generate the original certificates.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># If the original files are still in the data directory, you can just run:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> /var/lib/rancher/k3s/server/tls/root-ca.* /var/lib/rancher/k3s/server/tls/intermediate-ca.* /opt/k3s/server/tls</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Copy the current service-account signing key, so that existing service-account tokens are not invalidated.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> /var/lib/rancher/k3s/server/tls/service.key /opt/k3s/server/tls</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate updated custom CA certs and keys.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">-sL</span><span class="token plain"> https://github.com/k3s-io/k3s/raw/main/contrib/util/generate-custom-ca-certs.sh </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">DATA_DIR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/opt/k3s </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> -</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Load the updated CA certs and keys into the datastore.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k3s certificate rotate-ca </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/opt/k3s/server</span><br></span></code></pre></div></div>
<p>If the <code>rotate-ca</code> command returns an error, check the service log for errors.
If the command completes successfully, restart K3s on all nodes in the cluster - servers first, then agents.</p>
<p>If you used the <code>--force</code> option or changed the root CA, ensure that any nodes that were joined with a <a href="/cli/token#secure">secure token</a> are reconfigured to use the new token value, prior to being restarted.
The token may be stored in a <code>.env</code> file, systemd unit, or config.yaml, depending on how the node was configured during initial installation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rotating-self-signed-ca-certificates">Rotating Self-Signed CA Certificates<a href="#rotating-self-signed-ca-certificates" class="hash-link" aria-label="Direct link to Rotating Self-Signed CA Certificates" title="Direct link to Rotating Self-Signed CA Certificates" translate="no">​</a></h3>
<p>To rotate the K3s-generated self-signed CA certificates, use the <code>k3s certificate rotate-ca</code> subcommand.
Updated files must be staged into a temporary directory, loaded into the datastore, and k3s must be restarted on all nodes to use the updated certificates.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>You must not overwrite the currently in-use data in <code>/var/lib/rancher/k3s/server/tls</code>.<br>
<!-- -->Stage the updated certificates and keys into a separate directory.</p></div></div>
<p>If the cluster has been started with default self-signed CA certificates, rotation will be disruptive. All nodes that were joined with a <a href="/cli/token#secure">secure token</a> will need to be reconfigured to trust the new CA hash.
If the new CA certificates are not cross-signed by the old CA certificates, you will need to use the <code>--force</code> option to bypass integrity checks, and pods will need to be restarted to trust the new root CA.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="default-ca-topology">Default CA Topology<a href="#default-ca-topology" class="hash-link" aria-label="Direct link to Default CA Topology" title="Direct link to Default CA Topology" translate="no">​</a></h4>
<p>The default self-signed CA certificates have the following topology:</p>
<!-- -->
<p>When rotating the default self-signed CAs, a modified certificate topology with intermediate CAs and a new root CA cross-signed by the old CA can be used so that there is a continuous chain of trust between the old and new CAs:</p>
<!-- -->
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-example-script-2">Using The Example Script<a href="#using-the-example-script-2" class="hash-link" aria-label="Direct link to Using The Example Script" title="Direct link to Using The Example Script" translate="no">​</a></h4>
<p>An example script to create updated CA certificates and keys cross-signed by the existing CAs is available <a href="https://github.com/k3s-io/k3s/blob/main/contrib/util/rotate-default-ca-certs.sh" target="_blank" rel="noopener noreferrer">in the K3s repo at <code>contrib/util/rotate-default-ca-certs.sh</code></a>.</p>
<p>To use the example script to generate updated self-signed certificates that are cross-signed by the existing CAs, run the following commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Create updated CA certs and keys, cross-signed by the current CAs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This script will create a new temporary directory containing the updated certs, and output the new token values.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">-sL</span><span class="token plain"> https://github.com/k3s-io/k3s/raw/main/contrib/util/rotate-default-ca-certs.sh </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> -</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Load the updated certs into the datastore; see the script output for the updated token values.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k3s certificate rotate-ca </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/var/lib/rancher/k3s/server/rotate-ca</span><br></span></code></pre></div></div>
<p>If the <code>rotate-ca</code> command returns an error, check the service log for errors.
If the command completes successfully, restart K3s on all nodes in the cluster - servers first, then agents.</p>
<p>Ensure that any nodes that were joined with a <a href="/cli/token#secure">secure token</a>, including other server nodes, are reconfigured to use the new token value prior to being restarted.
The token may be stored in a <code>.env</code> file, systemd unit, or config.yaml, depending on how the node was configured during initial installation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-account-issuer-key-rotation">Service-Account Issuer Key Rotation<a href="#service-account-issuer-key-rotation" class="hash-link" aria-label="Direct link to Service-Account Issuer Key Rotation" title="Direct link to Service-Account Issuer Key Rotation" translate="no">​</a></h2>
<p>The service-account issuer key is an RSA private key used to sign service-account tokens.
When rotating the service-account issuer key, at least one old key should be retained in the file so that existing service-account tokens are not invalidated.
It can be rotated independent of the cluster CAs by using the <code>k3s certificate rotate-ca</code> to install only an updated <code>service.key</code> file that includes both the new and old keys.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>You must not overwrite the currently in-use data in <code>/var/lib/rancher/k3s/server/tls</code>.<br>
<!-- -->Stage the updated key into a separate directory.</p></div></div>
<p>For example, to rotate only the service-account issuer key, run the following commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Create a temporary directory for cert generation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">-p</span><span class="token plain"> /opt/k3s/server/tls</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Check OpenSSL version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">openssl version </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">-qF</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;OpenSSL 3&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">OPENSSL_GENRSA_FLAGS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">-traditional</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate a new key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">openssl genrsa </span><span class="token variable" style="color:rgb(191, 199, 213)">${OPENSSL_GENRSA_FLAGS</span><span class="token variable operator" style="color:rgb(137, 221, 255)">:-</span><span class="token variable" style="color:rgb(191, 199, 213)">}</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">-out</span><span class="token plain"> /opt/k3s/server/tls/service.key </span><span class="token number" style="color:rgb(247, 140, 108)">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Append the existing key to avoid invalidating current tokens</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> /var/lib/rancher/k3s/server/tls/service.key </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /opt/k3s/server/tls/service.key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Load the updated key into the datastore</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k3s certificate rotate-ca </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/opt/k3s/server</span><br></span></code></pre></div></div>
<p>It is normal to see warnings for files that are not being updated. If the <code>rotate-ca</code> command returns an error, check the service log for errors.
If the command completes successfully, restart K3s on all servers in the cluster. It is not necessary to restart agents or restart any pods.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/k3s-io/docs/edit/main/docs/cli/certificate.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-10-09T17:07:31.000Z" itemprop="dateModified">Oct 9, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cli/agent"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">agent</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cli/etcd-snapshot"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">etcd-snapshot</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#client-and-server-certificates" class="table-of-contents__link toc-highlight">Client and Server Certificates</a><ul><li><a href="#checking-expiration-dates" class="table-of-contents__link toc-highlight">Checking expiration dates</a></li><li><a href="#rotating-client-and-server-certificates" class="table-of-contents__link toc-highlight">Rotating Client and Server Certificates</a></li></ul></li><li><a href="#certificate-authority-ca-certificates" class="table-of-contents__link toc-highlight">Certificate Authority (CA) Certificates</a><ul><li><a href="#using-custom-ca-certificates" class="table-of-contents__link toc-highlight">Using Custom CA Certificates</a></li><li><a href="#rotating-custom-ca-certificates" class="table-of-contents__link toc-highlight">Rotating Custom CA Certificates</a></li><li><a href="#rotating-self-signed-ca-certificates" class="table-of-contents__link toc-highlight">Rotating Self-Signed CA Certificates</a></li></ul></li><li><a href="#service-account-issuer-key-rotation" class="table-of-contents__link toc-highlight">Service-Account Issuer Key Rotation</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 K3s Project Authors. All rights reserved. <br>The Linux Foundation has registered trademarks
      and uses trademarks. For a list of trademarks of The Linux Foundation, 
      please see our <a href="https://www.linuxfoundation.org/trademark-usage"> Trademark Usage</a> page.</div></div></div></footer></div>
</body>
</html>